<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: deprecated/system/styleopt/StyleOptionRegistry.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: deprecated/system/styleopt/StyleOptionRegistry.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>class StyleOption
{
  constructor(elementSource, propName, inputType, groupName, callback)
  {
    //the html element that this css variable reflects
    this.element = elementSource;
    //the name of the css variable
    this.prop = propName;
    //the css variable type
    this.type = inputType;
    //the group that the variable belongs to ("default" if not specified)
    this.group = groupName;

    this._callback = callback;
    this._value = null;
    this._defaultValue = null;
  }

  /**
   * Update the current value to reflect the computed style's value.
   */
  updateStyle(computedStyle=null, shouldPropagateChange=true)
  {
    if (!computedStyle)
    {
      computedStyle = window.getComputedStyle(this.element);
    }
    const newValue = computedStyle.getPropertyValue(this.prop);
    if (!newValue)
    {
      throw new Error("Cannot find style option with prop name \'" + this.prop + "\' for element");
    }

    this._value = newValue.trim();
    this._defaultValue = this._value;
    if (shouldPropagateChange &amp;&amp; this._callback) this._callback(this, newValue);
  }

  /**
   * Reset the current value to reflect the computed style's value.
   */
  resetStyle()
  {
    this.setStyle(this._defaultValue);
  }

  /**
   * Changes the variable's value for prop name.
   * These changes are reflected to the css source.
   */
  setStyle(val, shouldPropagateChange=true)
  {
    this._value = val;
    this.element.style.setProperty(this.prop, val);

    if (shouldPropagateChange &amp;&amp; this._callback) this._callback.call(null, this, val);
  }

  /** Returns the variable's current value. Null if not yet initialized. */
  getStyle()
  {
    return this._value;
  }

  isDefaultStyle()
  {
    return this._value == this._defaultValue;
  }
}

class StyleOptionRegistry
{
  constructor()
  {
    this._options = new Map();
    this._groups = new Map();

    this._init = false;
  }

  registerStyleOption(elementSource, propName, inputType="text", groupName="default", changeCallback=null)
  {
    if (this._options.has(propName))
    {
      throw new Error("Style option with prop name \'" + propName + "\' already registered");
    }

    const result = new StyleOption(elementSource, propName, inputType, groupName, changeCallback);
    this._options.set(propName, result);

    let group;
    if (!this._groups.has(groupName))
    {
      group = [];
      this._groups.set(groupName, group);
    }
    else
    {
      group = this._groups.get(groupName);

      if (group.indexOf(propName) != -1)
      {
        //Ignore it, it's already in here
        return;
      }
    }
    group.push(propName);
  }

  unregisterStyleOption(propName)
  {
    if (this._options.has(propName))
    {
      const option = this._options.get(propName);
      this._options.delete(propName);
      const groupName = option.group;
      if (this._groups.has(groupName))
      {
        const group = this._groups.get(groupName);
        const index = group.indexOf(propName);
        if (index >= 0)
        {
          group.splice(index, 1);
        }
      }
    }
  }

  initialize()
  {
    if (this._init)
    {
      throw new Error("Already initialized");
    }

    //Compute the styles
    const computedStyles = {};
    let computedStyle;
    for(let option of this._options.values())
    {
      const element = option.element;
      computedStyle = computedStyles[element];
      if (!computedStyle)
      {
        computedStyle = window.getComputedStyle(element);
        computedStyles[element] = computedStyle;
      }
      option.updateStyle(computedStyle, false);
    }

    this._init = true;
  }

  terminate()
  {
    if (!this._init)
    {
      throw new Error("Not yet initialized");
    }

    this._options.clear();
    this._groups.clear();

    this._init = false;
  }

  getOptionByProp(propName)
  {
    return this._options.get(propName);
  }

  getPropsByGroup(groupName)
  {
    return this._groups.get(groupName) || [];
  }

  getOptions()
  {
    return this._options.values();
  }

  isEmpty()
  {
    return this._options.size &lt;= 0;
  }
}

export default StyleOptionRegistry;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="GraphEdge.html">GraphEdge</a></li><li><a href="GraphEditorView.html">GraphEditorView</a></li><li><a href="GraphElement.html">GraphElement</a></li><li><a href="GraphNode.html">GraphNode</a></li><li><a href="JFLAPGraphParser.html">JFLAPGraphParser</a></li><li><a href="NodeGraph.html">NodeGraph</a></li><li><a href="QuadraticEdge.html">QuadraticEdge</a></li><li><a href="SemanticVersion.html">SemanticVersion</a></li><li><a href="StateNotificationLayout.html">StateNotificationLayout</a></li></ul><h3>Global</h3><ul><li><a href="global.html#doesSupportLocalStorage">doesSupportLocalStorage</a></li><li><a href="global.html#getCurrentURL">getCurrentURL</a></li><li><a href="global.html#getDirectionalVector">getDirectionalVector</a></li><li><a href="global.html#getFileExtFromName">getFileExtFromName</a></li><li><a href="global.html#getMidPoint">getMidPoint</a></li><li><a href="global.html#getURLParameters">getURLParameters</a></li><li><a href="global.html#guid">guid</a></li><li><a href="global.html#lerp">lerp</a></li><li><a href="global.html#loadMachineFromData">loadMachineFromData</a></li><li><a href="global.html#stringHash">stringHash</a></li><li><a href="global.html#uuid">uuid</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.1</a> on Wed May 15 2019 21:55:29 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
