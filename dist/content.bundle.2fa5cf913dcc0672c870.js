(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{86:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),i=n(14);n(22);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=[],u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"initialize",value:function(e){}},{key:"destroy",value:function(e){}},{key:"getModulePanels",value:function(){return l}},{key:"getModuleName",value:function(){throw new Error("Missing module name")}}])&&a(t.prototype,n),r&&a(t,r),e}(),s=(n(16),n(25),n(0));function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var v=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=p(t).call(this,e))||"object"!==c(o)&&"function"!=typeof o?y(r):o).element=null,n.ignoreSaveOnExit=!1;var i=e.defaultValue||"";return n.state={value:i,prevValue:i},n.onChange=n.onChange.bind(y(y(n))),n.onBlur=n.onBlur.bind(y(y(n))),n.onKeyUp=n.onKeyUp.bind(y(y(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentWillReceiveProps",value:function(e){this.hasFocus()||(!this.state.value||this.state.value.length<=0||this.state.value===this.props.defaultValue)&&this.setState({value:e.defaultValue})}},{key:"focus",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.element.select():this.element.focus()}},{key:"blur",value:function(){this.element.blur()}},{key:"hasFocus",value:function(){return this.element===document.activeElement}},{key:"onChange",value:function(e){if(this.props.filter){var t=e.target.value.replace(this.props.filter,"");this.setState({value:t})}else this.setState({value:e.target.value})}},{key:"onBlur",value:function(e){var t=this;if(this.ignoreSaveOnExit||"none"==this.props.captureOnExit){var n=this.formatValue(e.target.value);return this.setState({value:n}),void(this.ignoreSaveOnExit=!1)}if("save"==this.props.captureOnExit){var r=this.state.prevValue,o=e.target.value||this.props.defaultValue||"";this.resetValue(o,function(){t.props.onSubmit&&t.props.onSubmit(o,r)})}else"reset"==this.props.captureOnExit&&this.resetValue(null)}},{key:"onKeyUp",value:function(e){var t=this;if("Enter"==e.key){var n=this.state.prevValue,r=e.target.value||this.props.defaultValue||"";return this.resetValue(r,function(){t.ignoreSaveOnExit=!0,t.props.onSubmit&&t.props.onSubmit(r,n),t.element.blur()}),!1}if("Escape"==e.key){var o=this.state.prevValue;return this.resetValue(o,function(){t.ignoreSaveOnExit=!0,t.props.onSubmit&&t.props.onSubmit(o||"",o),t.element.blur()}),!1}}},{key:"resetValue",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;if(null!=t){var r=this.formatValue(t);this.setState({value:r,prevValue:r},n)}else this.setState(function(t,n){return{value:e.formatValue(t.prevValue)}},n)}},{key:"setValue",value:function(e,t){e=e&&0!=e.length?this.formatValue(e):this.props.defaultValue||"",this.setState({value:e},t)}},{key:"appendValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",",n=this.state.value;n=0==this.element.selectionStart&&this.element.selectionEnd==e.length?e:n&&0!=n.length?n+t+e:e,this.props.filter&&(n=n.replace(this.props.filter,"")),this.setState({value:this.formatValue(n)})}},{key:"formatValue",value:function(e){return(0,this.props.formatter)(e)||""}},{key:"render",value:function(){var e=this;return o.a.createElement("input",{id:this.props.id,className:this.props.className,style:this.props.style,ref:function(t){return e.element=t},type:"text",value:this.state.value,onChange:this.onChange,onBlur:this.onBlur,onKeyUp:this.onKeyUp})}},{key:"value",get:function(){return this.state.value}}])&&f(n.prototype,r),i&&f(n,i),t}();n(27),n(29),n(31);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var E=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=b(t).call(this,e))||"object"!==d(o)&&"function"!=typeof o?w(r):o).state={open:n.props.defaultValue||!1},n.onClick=n.onClick.bind(w(w(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,o.a.Component),n=t,(r=[{key:"onClick",value:function(e){this.setState(function(e,t){return{open:!e.open}}),this.props.onClick&&this.props.onClick(e)}},{key:"render",value:function(){return o.a.createElement("button",{className:"icon-button icon-toggle "+(this.state.open?" open ":"")+this.props.className,id:this.props.id,title:this.props.title,style:this.props.style,disabled:this.props.disabled,onClick:this.onClick},this.props.children)}}])&&m(n.prototype,r),i&&m(n,i),t}();function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var x=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),O(this,k(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"dropdown-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M7 10l5 5 5-5z"}),o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}}])&&_(n.prototype,r),i&&_(n,i),t}();function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return!t||"object"!==N(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=j(this,T(t).call(this,e))).dropdown=o.a.createRef(),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(t,o.a.Component),n=t,(r=[{key:"isOpen",value:function(){return!!this.dropdown.state&&this.dropdown.state.open}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"infoblock-container "+this.props.className},o.a.createElement("div",{className:"infoblock-header",onClick:function(t){return e.dropdown.onClick(t)}},o.a.createElement("label",null,this.props.title),o.a.createElement(E,{id:"collapse",ref:function(t){return e.dropdown=t},defaultValue:this.props.defaultValue,style:{pointerEvents:"none"}},o.a.createElement(x,null))),o.a.createElement("div",{className:"infoblock-content",style:{display:this.isOpen()?"block":"none"}},this.props.children))}}])&&P(n.prototype,r),i&&P(n,i),t}();n(33);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var F=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),A(this,R(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("button",{className:"icon-button "+this.props.className,id:this.props.id,title:this.props.title,style:this.props.style,disabled:this.props.disabled,onClick:this.props.onClick},this.props.children)}}])&&L(n.prototype,r),i&&L(n,i),t}();function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var X=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),z(this,V(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"boxadd-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"}),o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}}])&&U(n.prototype,r),i&&U(n,i),t}();function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var q=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),K(this,W(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"triangle-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M12 7.77L18.39 18H5.61L12 7.77M12 4L2 20h20L12 4z"}),o.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}))}}])&&Q(n.prototype,r),i&&Q(n,i),t}();n(35);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var re=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=ee(t).call(this,e))||"object"!==Z(o)&&"function"!=typeof o?ne(r):o).state={value:null,error:!1},n.onValueChange=n.onValueChange.bind(ne(ne(n))),n.onFocus=n.onFocus.bind(ne(ne(n))),n.onBlur=n.onBlur.bind(ne(ne(n))),n.onKeyDown=n.onKeyDown.bind(ne(ne(n))),n.onKeyUp=n.onKeyUp.bind(ne(ne(n))),n.onDragStart=n.onDragStart.bind(ne(ne(n))),n.onDrop=n.onDrop.bind(ne(ne(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,o.a.Component),n=t,(r=[{key:"onDragStart",value:function(e){e.target.select()}},{key:"onDrop",value:function(e){var t=this.props.graphController,n=t.getGraph(),r=n.getNodeIndex(this.props.src),o=n.getNodeIndexByLabel(e.dataTransfer.getData("text"));t.swapNodeByIndex(r,o),e.preventDefault()}},{key:"onFocus",value:function(e){var t=e.target;this.setState({value:this.props.label,error:!1},function(){t.select()}),this.props.onFocus&&this.props.onFocus(e)}},{key:"onBlur",value:function(e){var t=this.props.graphController,n=this.state.value;if(null!=n){var r=this.props.src,o=t.getGraph();if(n.length>0)o.getNodeByLabel(n)||t.renameNode(r,n);else t.deleteTargetNode(this.props.src);this.setState({value:null,error:!1}),this.props.onBlur&&this.props.onBlur(e)}}},{key:"onKeyDown",value:function(e){e.keyCode!==s.a.SUBMIT_KEY&&e.keyCode!==s.a.CLEAR_KEY||e.preventDefault()}},{key:"onKeyUp",value:function(e){if(e.keyCode===s.a.SUBMIT_KEY)e.target.blur();else if(e.keyCode===s.a.CLEAR_KEY){var t=e.target;this.setState({value:null,error:!1},function(){t.blur()})}}},{key:"onValueChange",value:function(e){var t=this.props.graphController.getGraph(),n=e.target.value.trim(),r=!1;if(n.length>0){var o=t.getNodeByLabel(n);null!=o&&o!=this.props.src&&(r=!0)}this.setState({value:n,error:r})}},{key:"render",value:function(){var e=this.props.src.hasCustomLabel(),t=null!=this.state.value?this.state.value:this.props.label;return o.a.createElement("div",{className:"statetag-container"+(e?" customtag":"")+(0==t.length?" emptytag":"")+(this.state.value&&this.state.error?" errortag":"")},o.a.createElement("input",{type:"text",className:this.props.accept?" accept":"",spellCheck:"false",draggable:"true",style:{width:t.length+"ch"},value:t,onChange:this.onValueChange,onFocus:this.onFocus,onBlur:this.onBlur,onKeyUp:this.onKeyUp,onKeyDown:this.onKeyDown,onDragStart:this.onDragStart,onDrop:this.onDrop}))}}])&&$(n.prototype,r),i&&$(n,i),t}();function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var se=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=ae(t).call(this,e))||"object"!==oe(o)&&"function"!=typeof o?ue(r):o).onStateCreate=n.onStateCreate.bind(ue(ue(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(t,o.a.Component),n=t,(r=[{key:"onStateCreate",value:function(e){var t=100*Math.random()*2-100,n=100*Math.random()*2-100;this.props.graphController.createNode(t,n)}},{key:"render",value:function(){var e=this.props.graphController,t=e.getGraph();return o.a.createElement(D,{title:I18N.toString("component.stateslist.title"),defaultValue:"true"},o.a.createElement("div",{className:"statelist-container"},o.a.createElement("div",{className:"statelist"},o.a.createElement(q,null),t.nodes.map(function(t,n){return o.a.createElement(re,{key:t.getGraphElementID(),src:t,label:t.getNodeLabel(),accept:t.accept,graphController:e,onFocus:function(n){return e.focusOnNode(t)}})})),o.a.createElement(F,{onClick:this.onStateCreate},o.a.createElement(X,null))))}}])&&ie(n.prototype,r),i&&ie(n,i),t}();n(37),n(39);function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e,t){return(he=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ve=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=pe(t).call(this,e))||"object"!==ce(o)&&"function"!=typeof o?ye(r):o).ref=null,n.state={symbol:null,error:!1},n.onValueChange=n.onValueChange.bind(ye(ye(n))),n.onFocus=n.onFocus.bind(ye(ye(n))),n.onBlur=n.onBlur.bind(ye(ye(n))),n.onKeyDown=n.onKeyDown.bind(ye(ye(n))),n.onKeyUp=n.onKeyUp.bind(ye(ye(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}(t,o.a.Component),n=t,(r=[{key:"onFocus",value:function(e){var t=e.target;this.setState({symbol:this.props.src,error:!1},function(){return t.select()}),this.props.onFocus&&this.props.onFocus(e)}},{key:"onBlur",value:function(e){var t=this.props.machineController,n=this.state.symbol;if(null!=n){var r=this.props.src;if(n.length>0)t.getAlphabet().includes(n)||(r?t.renameSymbol(r,n):t.createSymbol(n));else r&&t.deleteSymbol(r)}this.setState({symbol:null,error:!1}),this.props.onBlur&&this.props.onBlur(e)}},{key:"onKeyDown",value:function(e){e.keyCode!==s.a.SUBMIT_KEY&&e.keyCode!==s.a.CLEAR_KEY||e.preventDefault()}},{key:"onKeyUp",value:function(e){if(e.keyCode===s.a.SUBMIT_KEY)e.target.blur();else if(e.keyCode===s.a.CLEAR_KEY){var t=e.target;this.setState({symbol:null,error:!1},function(){t.blur()})}}},{key:"onValueChange",value:function(e){var t=this.props.machineController,n=e.target.value.trim(),r=!1;n.length>0&&(t.getAlphabet().includes(n)&&n!=this.props.src&&(r=!0));this.setState({symbol:n,error:r})}},{key:"render",value:function(){var e=this,t=null!=this.state.symbol?this.state.symbol:this.props.src;return o.a.createElement("div",{className:"alphatag-container"+(!this.props.src||t&&0!=t.length?"":" emptytag")+(this.state.symbol&&this.state.error?" errortag":"")},o.a.createElement("input",{type:"text",ref:function(t){return e.ref=t},className:"alphatag-input",spellCheck:"false",maxLength:"1",value:t,onChange:this.onValueChange,onFocus:this.onFocus,onBlur:this.onBlur,onKeyUp:this.onKeyUp,onKeyDown:this.onKeyDown}))}}])&&fe(n.prototype,r),i&&fe(n,i),t}();function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ge(e,t){return(ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function we(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ee=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=be(t).call(this,e))||"object"!==de(o)&&"function"!=typeof o?we(r):o).editingTag=null,n.state={editing:!1},n.onSymbolCreate=n.onSymbolCreate.bind(we(we(n))),n.onStopEditing=n.onStopEditing.bind(we(we(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ge(e,t)}(t,o.a.Component),n=t,(r=[{key:"onSymbolCreate",value:function(e){var t=this;this.setState({editing:!0},function(){t.editingTag.ref.focus()})}},{key:"onStopEditing",value:function(e){this.setState({editing:!1})}},{key:"render",value:function(){var e=this,t=this.props.machineController,n=t.getAlphabet();return o.a.createElement(D,{title:I18N.toString("component.alphabetlist.title")},o.a.createElement("div",{className:"alphalist-container"},o.a.createElement("div",{className:"alphalist"},n.map(function(e,n){return o.a.createElement(ve,{key:e+"."+n,src:e,machineController:t})}),this.state.editing&&o.a.createElement(ve,{ref:function(t){return e.editingTag=t},src:"",machineController:t,onBlur:this.onStopEditing})),o.a.createElement(F,{onClick:this.onSymbolCreate},o.a.createElement(X,null))))}}])&&me(n.prototype,r),i&&me(n,i),t}();n(41);function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _e=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._states=[],this._transitions=[],this._finalStates=[],this._customAlphabet=[]}var t,n,r;return t=e,(n=[{key:"clear",value:function(){this._states.length=0,this._transitions.length=0,this._finalStates.length=0,this._customAlphabet.length=0}},{key:"copy",value:function(e){this._states.length=0;var t=!0,n=!1,r=void 0;try{for(var o,i=e._states[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;this._states.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}this._transitions.length=0;var l=!0,u=!1,s=void 0;try{for(var c,f=e._transitions[Symbol.iterator]();!(l=(c=f.next()).done);l=!0){var p=c.value;this._transitions.push(p.slice())}}catch(e){u=!0,s=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw s}}this._finalStates.length=0;var h=!0,y=!1,v=void 0;try{for(var d,m=e._finalStates[Symbol.iterator]();!(h=(d=m.next()).done);h=!0){var b=d.value;this._finalStates.push(b)}}catch(e){y=!0,v=e}finally{try{h||null==m.return||m.return()}finally{if(y)throw v}}this._customAlphabet.length=0;var g=!0,w=!1,E=void 0;try{for(var S,_=e._customAlphabet[Symbol.iterator]();!(g=(S=_.next()).done);g=!0){var O=S.value;this._customAlphabet.push(O)}}catch(e){w=!0,E=e}finally{try{g||null==_.return||_.return()}finally{if(w)throw E}}}},{key:"newState",value:function(e){if(this._states.includes(e))throw new Error("State '"+e+"' already added to states.");return this._states.push(e),e}},{key:"deleteState",value:function(e){if(!this._states.includes(e))throw new Error("State '"+e+"' does not exist.");this._states.splice(this._states.indexOf(e),1)}},{key:"renameState",value:function(e,t){if(!this._states.includes(e))throw new Error("State '"+e+"' does not exist.");if(this._states.includes(t))throw new Error("State '"+t+"' already exists.");var n=!0,r=!1,o=void 0;try{for(var i,a=this._transitions[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value;l[0]==e&&(l[0]=t),l[2]==e&&(l[2]=t)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}var u=this._states.indexOf(e);this._states[u]=t}},{key:"newTransition",value:function(e,t,n){if(!this._states.includes(e))throw new Error("State '"+e+"' does not exist.");if(!this._states.includes(t))throw new Error("State '"+t+"' does not exist.");var r=!0,o=!1,i=void 0;try{for(var a,l=this._transitions[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;if(u[0]==e&&u[1]==n&&u[2]==t)return}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}this._transitions.push([e,n,t])}},{key:"deleteTransition",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this._transitions.length-1;r>=0;--r){var o=this._transitions[r];o[0]==e&&o[2]==t&&(null!=n&&o[1]!=n||this._transitions.splice(r,1))}}},{key:"newSymbol",value:function(e){if(this._customAlphabet.includes(e))throw new Error("Symbol '"+e+"' already added to alphabet.");this._customAlphabet.push(e)}},{key:"deleteSymbol",value:function(e){if(!this._customAlphabet.includes(e))throw new Error("Unable to remove symbol '"+e+"'.");this._customAlphabet.splice(this._customAlphabet.indexOf(e),1)}},{key:"setStartState",value:function(e){if(this._states.length<=0)throw new Error("Not enough states.");if(!this._states.includes(e))throw new Error("State '"+e+"' does not exist.");this.getStartState()!=e&&(this._states.splice(this._states.indexOf(e),1),this._states.unshift(e))}},{key:"setFinalState",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this._states.includes(e))throw new Error("State '"+e+"' does not exist.");if(t){if(this._finalStates.includes(e))return;this._finalStates.push(e)}else{if(!this._finalStates.includes(e))return;this._finalStates.splice(this._finalStates.indexOf(e),1)}}},{key:"doTransition",value:function(e,t){var n=!0,r=!1,o=void 0;try{for(var i,a=this._transitions[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value;if(l[0]==e&&l[1]==t)return l[2]}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return null}},{key:"isFinalState",value:function(e){return this._finalStates.includes(e)}},{key:"hasState",value:function(e){return this._states.includes(e)}},{key:"getStates",value:function(){return this._states}},{key:"isUsedAlphabet",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this._transitions[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){if(o.value[1]==e)return!0}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return!1}},{key:"isAlphabet",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this._customAlphabet[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){if(o.value==e)return!0}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return this.isUsedAlphabet(e)}},{key:"getUsedAlphabet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!0,n=!1,r=void 0;try{for(var o,i=this._transitions[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value[1];a.length>0&&!e.includes(a)&&e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"getAlphabet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!0,n=!1,r=void 0;try{for(var o,i=this._customAlphabet[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return this.getUsedAlphabet(e)}},{key:"getOutgoingTransitions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!0,r=!1,o=void 0;try{for(var i,a=this._transitions[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value;l[0]==e&&t.push(l)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}},{key:"getTransitions",value:function(){return this._transitions}},{key:"getStartState",value:function(){return this._states.length<=0?null:this._states[0]}},{key:"getFinalStates",value:function(){return this._finalStates}},{key:"isValidDFA",value:function(){var e=this.getAlphabet(),t=new Array(e.length);t.fill(!1);var n=!0,r=!1,o=void 0;try{for(var i,a=this._states[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value,u=this.getOutgoingTransitions(l),s=!0,c=!1,f=void 0;try{for(var p,h=u[Symbol.iterator]();!(s=(p=h.next()).done);s=!0){var y=p.value,v=e.indexOf(y[1]);if(0!=t[v])return!1;t[v]=!0}}catch(e){c=!0,f=e}finally{try{s||null==h.return||h.return()}finally{if(c)throw f}}for(var d=t.length,m=0;m<d;++m){if(0==t[m])return!1;t[m]=!1}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return!0}},{key:"toJSON",value:function(){var e={};return this instanceof DFA?e.type="DFA":this instanceof NFA?e.type="NFA":e.type="FSA",e.states=this._states.slice(),e.alphabet=this._customAlphabet.slice(),e.usedAlphabet=this.getUsedAlphabet(),e.transitions=this._transitions.slice(),e.startState=this.getStartState(),e.finalStates=this._finalStates.slice(),e}}])&&Se(t.prototype,n),r&&Se(t,r),e}(),Oe="→";function ke(e){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e,t){return!t||"object"!==ke(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ne(e){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pe(e,t){return(Pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var je=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),xe(this,Ne(t).call(this))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pe(e,t)}(t,_e),n=t,(r=[{key:"getUsedAlphabet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!0,n=!1,r=void 0;try{for(var o,i=this._transitions[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value[1];e.includes(a)||"ε"==a||e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"doTransition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=!0,o=!1,i=void 0;try{for(var a,l=this._transitions[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;u[0]==e&&u[1]==t&&n.push(u[2])}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}},{key:"doClosureTransition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.push(e);for(var n=0;n<t.length;++n){var r=this.getOutgoingTransitions(t[n]),o=!0,i=!1,a=void 0;try{for(var l,u=r[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var s=l.value;if("ε"==s[1]){var c=s[2];t.includes(c)||t.push(c)}}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}}return t}},{key:"doTerminalTransition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=!0,o=!1,i=void 0;try{for(var a,l=this._transitions[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;if(u[0]==e&&u[1]==t){var s=this.doClosureTransition(u[2]),c=!0,f=!1,p=void 0;try{for(var h,y=s[Symbol.iterator]();!(c=(h=y.next()).done);c=!0){var v=h.value;n.includes(v)||n.push(v)}}catch(e){f=!0,p=e}finally{try{c||null==y.return||y.return()}finally{if(f)throw p}}}}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}},{key:"getPowerSet",value:function(){for(var e=[[]],t=this.getStates(),n=0;n<t.length;n++)for(var r=0,o=e.length;r<o;r++)e.push(e[r].concat(t[n]));return e}}])&&Ce(n.prototype,r),o&&Ce(n,o),t}();function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function De(e,t){return!t||"object"!==Te(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ae=0,Re=1,Be=2,Fe="symbols";function Ge(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=e.doTransition(t,n);return Array.isArray(o)?r||1!=o.length?o.length>0?"{"+o.join(", ")+"}":"-":o[0]:o||"-"}var Ue=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=De(this,Ie(t).call(this,e))).state={rowAxis:Fe},n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props.machineBuilder,n=t.getMachine(),r=n.getStates(),i=n.getAlphabet(),a=(n.getTransitions(),this.state.rowAxis),l="NFA"==t.getMachineType(),u=a===Fe&&l;return o.a.createElement(D,{title:I18N.toString("component.transitiontable.title")},o.a.createElement("div",{className:"transitiontable-container"},o.a.createElement("table",{className:"transitiontable"},o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("th",{className:"emptycell"},o.a.createElement("button",{className:"panel-button",onClick:function(){return e.setState(function(e,t){return{rowAxis:e.rowAxis==Fe?"states":Fe}})}},this.state.rowAxis==Fe?"Q/Σ":"Q/Q")),a===Fe?i.map(function(e,t){return o.a.createElement("th",{key:e,scope:"col",className:"col"},e)}):"states"===a?r.map(function(e,t){return o.a.createElement("th",{key:e,scope:"col",className:"col"},e)}):null,u&&o.a.createElement("th",{scope:"col"},"ε")),r.map(function(e,t){return o.a.createElement("tr",{key:e},o.a.createElement("th",{scope:"row",className:"row"},e),a===Fe?i.map(function(t,r){var i="",a=Ge(n,e,t,l);return l||!a.startsWith("{")&&"-"!=a||(i+=" error"),o.a.createElement("td",{key:e+","+t,className:i},a)}):"states"===a?r.map(function(t,r){var i=function(e,t,n){var r=[],o=e.getTransitions(),i=!0,a=!1,l=void 0;try{for(var u,s=o[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;c[Ae]==t&&c[Be]==n&&r.push(c[Re])}}catch(e){a=!0,l=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw l}}return 1===r.length?r[0]:r.length>0?"{"+r.join(", ")+"}":"-"}(n,e,t);return o.a.createElement("td",{key:e+","+t},i)}):null,u&&o.a.createElement("td",null,Ge(n,e,"ε")))})))))}}])&&Me(n.prototype,r),i&&Me(n,i),t}();n(43);function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function He(e,t){return!t||"object"!==ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xe(e){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qe=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),He(this,Xe(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.machineBuilder,t=e.getMachine(),n=t.getStates(),r=t.getAlphabet().sort(),i="NFA"==e.getMachineType();return o.a.createElement(D,{title:"Transition Chart"},o.a.createElement("div",{className:"transitionfunction-container"},o.a.createElement("table",{className:"transitionfunction-table"},o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Q","×","Σ"),o.a.createElement("th",null,i?"℘(Q)":"Q")),n.map(function(e,n){var a=t.doTransition(e,"ε"),l="",u=r.map(function(n,r){var a="",l=t.doTransition(e,n);if(!i||l.length)return i||l.length||(a="error",l="-"),!i&&l.length>1&&(a="error",l="{"+l+"}"),l=i?"{"+l+"}":""+l,o.a.createElement("tr",{key:""+e+n},o.a.createElement("td",{className:"transitionfunction-key"},"("+e+","+n+")"),o.a.createElement("td",{className:"transitionfunction-value "+a},l))});a.length>0&&(i||(l="error"),a=i||a.length>1?"{"+a+"}":""+a,u.unshift(o.a.createElement("tr",{key:e+"ε"},o.a.createElement("td",{className:"transitionfunction-key "+l},"("+e+",ε)"),o.a.createElement("td",{className:"transitionfunction-value"},a))));return u})))))}}])&&Ve(n.prototype,r),i&&Ve(n,i),t}();n(45);function Ke(e){return(Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Je(e,t){return!t||"object"!==Ke(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ze(e,t){return(Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $e=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Je(this,qe(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ze(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.machineBuilder,t=e.getMachine(),n=t.getStates(),r=t.getFinalStates(),i=t.getAlphabet().sort(),a="NFA"==e.getMachineType();return o.a.createElement("div",{className:"formaldef-container"},o.a.createElement("h2",null,"M = (Q, Σ, δ, q0, F)"),o.a.createElement("div",null,o.a.createElement("h3",null,"Q ="),o.a.createElement("span",{className:"formaldef-values"},n.length>0?"{ "+n.join(", ")+" }":"∅")),o.a.createElement("div",null,o.a.createElement("h3",null,"Σ ="),o.a.createElement("span",{className:"formaldef-values"},i.length>0?"{ "+i.join(", ")+" }":"∅")),o.a.createElement("div",null,o.a.createElement("h3",null,"δ"),o.a.createElement("div",{className:"formaldef-values"},n.map(function(e,n){var r=t.doTransition(e,"ε"),l="",u=i.map(function(n,r){var i="",l=t.doTransition(e,n);if(!a||l.length)return a||l.length||(i="error",l="-"),!a&&l.length>1&&(i="error",l="{ "+l+" }"),l=a?"{ "+l+" }":""+l,o.a.createElement("div",{key:""+e+n,className:i},"δ( ( "+e+", "+n+" ) ) = "+l)});r.length>0&&(a||(l="error"),r=a||r.length>1?"{ "+r+" }":""+r,u.unshift(o.a.createElement("div",{key:e+"ε",className:l},"δ( ( "+e+", ε ) ) = "+r)));return u}),a&&o.a.createElement("div",{id:"formaldef-otherinputs"},o.a.createElement("div",null,"For all other inputs (q, x),"),o.a.createElement("div",null,"δ( (q, x) ) = ∅")))),o.a.createElement("div",null,o.a.createElement("h3",null,"q0 ="),o.a.createElement("span",{className:"formaldef-values"},n[0])),o.a.createElement("div",null,o.a.createElement("h3",null,"F ="),o.a.createElement("span",{className:"formaldef-values"},r.length>0?"{ "+r.join(",")+" }":"∅")))}}])&&We(n.prototype,r),i&&We(n,i),t}();function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nt(e){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rt(e,t){return(rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ot(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var it=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=nt(t).call(this,e))||"object"!==et(o)&&"function"!=typeof o?ot(r):o).container=null,n.state={viewFormal:!1},n.onChangeMachineType=n.onChangeMachineType.bind(ot(ot(n))),n.onAutoLayout=n.onAutoLayout.bind(ot(ot(n))),n.onChangeAutoRename=n.onChangeAutoRename.bind(ot(ot(n))),n.onSubmitAutoStatePrefix=n.onSubmitAutoStatePrefix.bind(ot(ot(n))),n.onAutoStateFormat=n.onAutoStateFormat.bind(ot(ot(n))),n.switchDefinition=n.switchDefinition.bind(ot(ot(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rt(e,t)}(t,o.a.Component),n=t,(r=[{key:"onAutoLayout",value:function(e){this.props.graphController.applyAutoLayout()}},{key:"onChangeMachineType",value:function(e){var t=e.target.value;this.props.machineController.changeMachineTo(t)}},{key:"onChangeAutoRename",value:function(e){this.props.machineController.getMachineBuilder().setAutoRenameNodes(e.target.checked)}},{key:"onSubmitAutoStatePrefix",value:function(e,t){var n=this.props.machineController.getMachineBuilder().getLabeler();n.prefix!=e&&(n.prefix=e,n.sortDefaultNodeLabels())}},{key:"onAutoStateFormat",value:function(e){return e&&e.length>0?e:s.a.STR_STATE_LABEL}},{key:"switchDefinition",value:function(){this.setState(function(e,t){return{viewFormal:!e.viewFormal}})}},{key:"render",value:function(){var e=this,t=this.props.graphController,n=this.props.machineController,r=t.getGraph(),i=n.getMachineBuilder();return o.a.createElement("div",{className:"panel-container",id:"overview",ref:function(t){return e.container=t},style:this.props.style},o.a.createElement("div",{className:"panel-title"},o.a.createElement("h1",null,I18N.toString("component.overview.title"))),o.a.createElement("div",{className:"panel-content"},o.a.createElement("select",{className:"machine-type panel-select",value:i.getMachineType(),onChange:this.onChangeMachineType},o.a.createElement("option",{value:"DFA"},"DFA"),o.a.createElement("option",{value:"NFA"},"NFA")),this.state.viewFormal&&o.a.createElement($e,{machineBuilder:i}),!this.state.viewFormal&&o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement("div",{className:"graphinfo-important"},o.a.createElement(se,{graphController:t}),o.a.createElement(Ee,{machineController:n})),o.a.createElement("div",{className:"graphinfo"},o.a.createElement(Qe,{machineBuilder:i}),o.a.createElement(Ue,{machineBuilder:i}))),o.a.createElement("hr",null),o.a.createElement("div",{style:{paddingBottom:"0.5em"}},o.a.createElement("h3",{style:{marginBottom:"0"}},"State Labels"),o.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},o.a.createElement("div",{className:"statetag-container"},o.a.createElement(v,{defaultValue:i.getLabeler().prefix,style:{width:"4em"},formatter:this.onAutoStateFormat,captureOnExit:"save",onSubmit:this.onSubmitAutoStatePrefix})),o.a.createElement("select",{style:{background:"none",outline:"none",border:"none",padding:"0",margin:"0",appearance:"none",color:"white"},disabled:!0},o.a.createElement("option",null,"0-9"),o.a.createElement("option",null,"a-z"),o.a.createElement("option",null,"A-Z"))),o.a.createElement("div",{className:"panel-checkbox"},o.a.createElement("input",{type:"checkbox",id:"auto-statename",onChange:this.onChangeAutoRename,checked:i.shouldAutoRenameNodes()}),o.a.createElement("label",{htmlFor:"auto-statename"},I18N.toString("options.autolabel")))),o.a.createElement("hr",null),o.a.createElement("button",{className:"panel-button",onClick:this.onAutoLayout,disabled:r.isEmpty()},I18N.toString("action.overview.autolayout"))),o.a.createElement("button",{className:"panel-button",onClick:this.switchDefinition},this.state.viewFormal?"Back":"View Definition")),o.a.createElement("div",{className:"panel-bottom"}))}}])&&tt(n.prototype,r),i&&tt(n,i),t}();it.UNLOCALIZED_NAME="component.overview.title";var at=it;n(47),n(49),n(51);function lt(e){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function st(e){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ct(e,t){return(ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ft(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var pt=["0","1"],ht=["ε"],yt=s.a.EDGE_SYMBOL_SEPARATOR;var vt=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=st(t).call(this,e))||"object"!==lt(o)&&"function"!=typeof o?ft(r):o).parentElement=null,n.inputElement=null,n._timer=null,n._prevValue="",n.state={target:null,callback:null},n.onContextMenu=n.onContextMenu.bind(ft(ft(n))),n.onFormat=n.onFormat.bind(ft(ft(n))),n.onSubmit=n.onSubmit.bind(ft(ft(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ct(e,t)}(t,o.a.Component),n=t,(r=[{key:"openEditor",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!this.inputElement||!this.parentElement)throw new Error("Trying to open editor that has not yet mounted");this.setState(function(t,n){return{target:e,callback:o}}),this.inputElement.resetValue(e.getEdgeLabel(),function(){n&&t.inputElement.setValue(n),t._prevValue=e.getEdgeLabel(),t.parentElement.focus(),t.inputElement.focus(r)})}},{key:"closeEditor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.inputElement||!this.parentElement)throw new Error("Trying to open editor that has not yet mounted");if(null!==this.state.target){if(e){var t=this.inputElement.value;t||(t="ε"),this.state.target.setEdgeLabel(t)}else this.state.target.getEdgeLabel()||(this.state.target.setEdgeLabel("ε"),this.props.graphController.getGraph().deleteEdge(this.state.target));this.setState({target:null}),this.state.callback&&this.state.callback()}this.inputElement.blur()}},{key:"hasFocus",value:function(){return this.inputElement.hasFocus()}},{key:"isEditorOpen",value:function(){return null!==this.state.target}},{key:"onContextMenu",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"appendSymbol",value:function(e){this.inputElement.appendValue(e,yt),this.inputElement.focus(!1)}},{key:"onSubmit",value:function(e,t){}},{key:"onFormat",value:function(e){return this.props.machineController.getLabelFormatter().call(null,e,!0)}},{key:"render",value:function(){var e=this,t=this.props.inputController.getViewport(),n=(this.props.graphController,this.props.machineController),r=this.props.screen,i={visibility:"hidden"},a=this.state.target;if(a){i.visibility="visible";var l=a.getCenterPoint(),u=function(e,t,n){var r=e.getScreenCTM();return{x:t*r.a+r.e,y:n*r.d+r.f}}(r,l.x+t.getOffsetX(),l.y+t.getOffsetY()),s=u.x,c=u.y+-64+-36,f=-this.parentElement.offsetWidth/2,p=-this.parentElement.offsetHeight/2;i.top=c+p+"px",i.left=s+f+"px"}var h=n.getMachineBuilder().getMachine().getAlphabet();return o.a.createElement("div",{className:"bubble",id:"label-editor",ref:function(t){return e.parentElement=t},tabIndex:"0",style:i,onContextMenu:this.onContextMenu,onFocus:function(t){clearTimeout(e._timer)},onBlur:function(t){e._timer=setTimeout(function(){return e.closeEditor(!0)},10)}},o.a.createElement(v,{className:"label-editor-input",ref:function(t){return e.inputElement=t},formatter:this.onFormat,onSubmit:this.onSubmit,captureOnExit:"none"}),o.a.createElement("div",{className:"label-editor-tray"},h&&o.a.createElement("span",{className:"label-editor-tray-used"},h.map(function(t,n){return t.length<1?null:o.a.createElement("button",{key:n,onClick:function(n){return e.appendSymbol(t)}},t)})),o.a.createElement("span",{className:"label-editor-tray-default"},h&&h.length<=1&&pt.map(function(t,n){return o.a.createElement("button",{key:n,onClick:function(n){return e.appendSymbol(t)}},t)}),ht.map(function(t,n){return o.a.createElement("button",{key:n,onClick:function(n){return e.appendSymbol(t)}},t)}))))}}])&&ut(n.prototype,r),i&&ut(n,i),t}();n(53);function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bt(e,t){return!t||"object"!==dt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gt(e){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wt(e,t){return(wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Et=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=bt(this,gt(t).call(this,e))).state={staticTrash:!1},n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wt(e,t)}(t,o.a.Component),n=t,(r=[{key:"onTrashEnter",value:function(e){this.state.staticTrash||(this.props.inputController.setTrashMode(!0),this.props.viewport.setState(function(e,t){return{mode:Pn.DANGEROUS}}))}},{key:"onTrashLeave",value:function(e){this.state.staticTrash||(this.props.inputController.setTrashMode(!1),this.props.viewport.setState(function(e,t){return{mode:Pn.NORMAL}}))}},{key:"onTrashClick",value:function(e){var t=this;e.stopPropagation(),e.preventDefault(),this.setState(function(e,n){var r=!e.staticTrash;return t.props.inputController.setTrashMode(r),t.props.viewport.setState(function(e,t){return{mode:r?Pn.DANGEROUS:Pn.NORMAL}}),{staticTrash:r}})}},{key:"render",value:function(){var e=this.props.inputController,t=e.getAdapter();return o.a.createElement("svg",{id:"trash-btn",className:(e.isTrashMode()?"danger ":"")+(t.isUsingTouch()&&t.isDragging()?"hidden":""),width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",onMouseEnter:this.onTrashEnter.bind(this),onMouseLeave:this.onTrashLeave.bind(this),onClick:this.onTrashClick.bind(this)},o.a.createElement("path",{d:"M3 6v18h18v-18h-18zm5 14c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm5 0c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm5 0c0 .552-.448 1-1 1s-1-.448-1-1v-10c0-.552.448-1 1-1s1 .448 1 1v10zm4-18v2h-20v-2h5.711c.9 0 1.631-1.099 1.631-2h5.315c0 .901.73 2 1.631 2h5.712z"}))}}])&&mt(n.prototype,r),i&&mt(n,i),t}();n(55);function St(e){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ot(e,t){return!t||"object"!==St(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kt(e){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ct(e,t){return(Ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xt=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ot(this,kt(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ct(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"play-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M8 5v14l11-7z"}),o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}}])&&_t(n.prototype,r),i&&_t(n,i),t}();function Nt(e){return(Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jt(e,t){return!t||"object"!==Nt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tt(e){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mt(e,t){return(Mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Dt=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),jt(this,Tt(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mt(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"pause-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"}),o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}}])&&Pt(n.prototype,r),i&&Pt(n,i),t}();function It(e){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function At(e,t){return!t||"object"!==It(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rt(e){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bt(e,t){return(Bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ft=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),At(this,Rt(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bt(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"stop-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M6 6h12v12H6z"}))}}])&&Lt(n.prototype,r),i&&Lt(n,i),t}();function Gt(e){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zt(e,t){return!t||"object"!==Gt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vt(e){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ht(e,t){return(Ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xt=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),zt(this,Vt(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ht(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"undo-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"}))}}])&&Ut(n.prototype,r),i&&Ut(n,i),t}();function Yt(e){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kt(e,t){return!t||"object"!==Yt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wt(e){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jt(e,t){return(Jt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qt=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Kt(this,Wt(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jt(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"redo-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"}))}}])&&Qt(n.prototype,r),i&&Qt(n,i),t}();function Zt(e){return(Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function en(e,t){return!t||"object"!==Zt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tn(e){return(tn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nn(e,t){return(nn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rn=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),en(this,tn(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nn(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){this.props.graphController;var e=this.props.tester,t=this.props.tester.inputList,n=this.props.tester.testMode,r=t.getCurrentInput(),i=n.getCurrentTestStringIndex();return o.a.createElement("div",{className:"test-tray-container"},o.a.createElement("div",{className:"test-tray-input-string-container"},r&&i>=0&&r.value.split("").map(function(e,t){var n=i-t;if(!(n>5))return n>2?o.a.createElement("span",{key:e+"."+t,className:"test-tray-input-placeholder"},"."):o.a.createElement("span",{key:e+"."+t,className:"test-tray-input-char"+(i==t?" active":"")},e)})),o.a.createElement("div",{className:"test-tray-control"},o.a.createElement(F,{onClick:function(e){n.onResume()},disabled:n.isRunning()},o.a.createElement(xt,null)),o.a.createElement(F,{onClick:function(e){n.onPause()},disabled:!n.isRunning()},o.a.createElement(Dt,null)),o.a.createElement(F,{onClick:function(e){n.onPreviousStep()},disabled:!n.hasPrevStep()||n.isSkipping()},o.a.createElement(Xt,null)),o.a.createElement(F,{onClick:function(e){n.onNextStep()},disabled:!e.testMode.hasNextStep()||n.isSkipping()},o.a.createElement(qt,null)),o.a.createElement(F,{onClick:function(t){e.setStepByStepMode(!1)}},o.a.createElement(Ft,null)),o.a.createElement("div",{className:"trash-placeholder"})))}}])&&$t(n.prototype,r),i&&$t(n,i),t}();n(57);function on(e){return(on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ln(e,t){return!t||"object"!==on(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function un(e){return(un=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sn(e,t){return(sn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cn=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ln(this,un(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sn(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"create-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}}])&&an(n.prototype,r),i&&an(n,i),t}();function fn(e){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hn(e,t){return!t||"object"!==fn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yn(e){return(yn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vn(e,t){return(vn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dn=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),hn(this,yn(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vn(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"move-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z"}))}}])&&pn(n.prototype,r),i&&pn(n,i),t}();function mn(e){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gn(e,t){return!t||"object"!==mn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wn(e){return(wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function En(e,t){return(En=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sn=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),gn(this,wn(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&En(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.inputController,t=this.props.graphController,n=e.isActionMode(t);return o.a.createElement("div",{id:"cursor-btn"},o.a.createElement(F,{id:"action-mode",className:n?"active":"",onClick:function(){return e.setInputScheme(!0)},title:I18N.toString("cursor.actionmode")},o.a.createElement(cn,null)),o.a.createElement(F,{id:"move-mode",className:n?"":"active",onClick:function(){return e.setInputScheme(!1)},title:I18N.toString("cursor.movemode")},o.a.createElement(dn,null)))}}])&&bn(n.prototype,r),i&&bn(n,i),t}();function _n(e){return(_n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function On(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kn(e,t){return!t||"object"!==_n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cn(e){return(Cn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xn(e,t){return(xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nn=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=kn(this,Cn(t).call(this,e))).ref=null,n.labelEditor=null,n.state={prevMode:t.NORMAL,mode:t.NORMAL},n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xn(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this,t=this.props.inputController,n=this.props.graphController,r=this.props.machineController,i=this.props.tester,a=this.props.screen;return o.a.createElement("div",{className:"viewport-container viewport-"+this.state.mode,ref:function(t){return e.ref=t}},o.a.createElement(vt,{ref:function(t){return e.labelEditor=t},inputController:t,graphController:n,machineController:r,screen:a}),i.getStepByStepMode()?o.a.createElement("div",{className:"anchor-bottom-left",style:{width:"100%"}},o.a.createElement(rn,{tester:i,graphController:n})):o.a.createElement("span",null,o.a.createElement("div",{className:"anchor-bottom-left",style:{width:"100%"}},o.a.createElement(Sn,{inputController:t,graphController:n})),o.a.createElement("div",{className:"anchor-bottom-right"},o.a.createElement(Et,{inputController:t,viewport:this}))))}}])&&On(n.prototype,r),i&&On(n,i),t}();Nn.NORMAL="normal",Nn.WAITING="waiting",Nn.TESTING="testing",Nn.DANGEROUS="dangerous";var Pn=Nn;function jn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Tn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"downloadText",value:function(t,n){e.downloadURL(t,e.getTextDataURI(n))}},{key:"downloadSVG",value:function(t,n,r,o,i){var a=(new XMLSerializer).serializeToString(r),l=new Blob([a],{type:"image/svg+xml"}),u=URL.createObjectURL(l),s=document.createElement("canvas"),c=s.getContext("2d"),f=window.devicePixelRatio||1;s.width=o*f,s.height=i*f,s.style.width=o+"px",s.style.height=i+"px",c.setTransform(f,0,0,f,0,0);var p=new Image;p.onload=function(){c.drawImage(p,0,0),URL.revokeObjectURL(u);var r=s.toDataURL("image/"+n).replace("image/"+n,"image/octet-stream");e.downloadURL(t+"."+n,r)},p.src=u}},{key:"downloadURL",value:function(e,t){var n=document.createElement("a"),r=t.indexOf(";");t=t.substring(0,r+1)+"headers=Content-Disposition%3A%20attachment%3B%20filename="+e+";"+t.substring(r+1),n.setAttribute("href",t),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"getTextDataURI",value:function(e){return"data:text/plain; charset=utf-8,"+encodeURIComponent(e)}}],(n=null)&&jn(t.prototype,n),r&&jn(t,r),e}();function Mn(e,t,n,r,o){var i=null,a=[],l=0;null!=t&&r.push(t);var u=!0,s=!1,c=void 0;try{for(var f,p=n[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var h=f.value;if(i=h.state,null!=(t=h.index<r.length?r[h.index]:null)){l=h.index+1;var y=!0,v=!1,d=void 0;try{for(var m,b=e.doTerminalTransition(i,t)[Symbol.iterator]();!(y=(m=b.next()).done);y=!0){var g=m.value;a.push({state:g,index:l})}}catch(e){v=!0,d=e}finally{try{y||null==b.return||b.return()}finally{if(v)throw d}}}else{if(e.isFinalState(i))return!0;o.push(i)}l=h.index}}catch(e){s=!0,c=e}finally{try{u||null==p.return||p.return()}finally{if(s)throw c}}return n.length=0,n.push.apply(n,a),!1}function Dn(e){return(Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function In(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ln(e,t){return!t||"object"!==Dn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function An(e){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rn(e,t){return(Rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Bn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ln(this,An(t).call(this))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rn(e,t)}(t,_e),n=t,(r=[{key:"validate",value:function(){return console.error("This is deprecated, please use FSA.isValidDFA()"),this.isValidDFA()}},{key:"newTransition",value:function(e,t,n){if(!this._states.includes(e))throw new Error("State '"+e+"' does not exist.");if(!this._states.includes(t))throw new Error("State '"+t+"' does not exist.");var r=!0,o=!1,i=void 0;try{for(var a,l=this._transitions[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;if(u[0]==e&&u[1]==n&&u[2]==t)return;if(u[0]==e&&u[1]==n)throw new Error("Unable to create illegal nondeterministic transition for DFA.")}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}this._transitions.push([e,n,t])}}])&&In(n.prototype,r),o&&In(n,o),t}();function Fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Gn=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.graphController=null,this.machineController=null,this.testingManager=t,this.targets=[],this.history=[],this.indexofString=-1,this.result=!1,this.cachedStates=[],this.cachedSymbols=[],this.checkedStates=[],this.running=!1,this.started=!1,this.skipToEnd=!1,this.timer=null,this.onNodeDestroy=this.onNodeDestroy.bind(this)}var t,n,r;return t=e,(n=[{key:"initialize",value:function(e){this.graphController=e.graphController,this.machineController=e.machineController}},{key:"destroy",value:function(){}},{key:"onNodeDestroy",value:function(e){}},{key:"onStart",value:function(){this.prepareForNewTest(),this.started=!0,this.skipToEnd=!1}},{key:"onResume",value:function(){var e=this;this.hasNextStep()||this.testingManager.inputList.resetTests(!1),this.running=!0;this.timer=setTimeout(function t(){e.running&&(e.hasNextStep()?(e.onNextStep(),e.timer=setTimeout(t,500)):e.onPause())},500)}},{key:"onPause",value:function(){this.running=!1}},{key:"onStop",value:function(){this.targets.length=0,this.running=!1,this.started=!1,this.skipToEnd=!1}},{key:"isRunning",value:function(){return this.running}},{key:"isStarted",value:function(){return this.started}},{key:"isSkipping",value:function(){return this.skipToEnd}},{key:"hasPrevStep",value:function(){return this.history.length>0||this.testingManager.inputList.hasPrevInput()}},{key:"onPreviousStep",value:function(){if(this.history.length>0){var e=this.history.pop();this.targets.length=0,this.cachedStates.length=0,this.cachedSymbols.length=0,this.checkedStates.length=0;var t=!0,n=!1,r=void 0;try{for(var o,i=e.targets[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(!a)throw new Error("Found null target");this.targets.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}var l=!0,u=!1,s=void 0;try{for(var c,f=e.cachedStates[Symbol.iterator]();!(l=(c=f.next()).done);l=!0){var p=c.value;this.cachedStates.push(p)}}catch(e){u=!0,s=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw s}}var h=!0,y=!1,v=void 0;try{for(var d,m=e.cachedSymbols[Symbol.iterator]();!(h=(d=m.next()).done);h=!0){var b=d.value;this.cachedSymbols.push(b)}}catch(e){y=!0,v=e}finally{try{h||null==m.return||m.return()}finally{if(y)throw v}}var g=!0,w=!1,E=void 0;try{for(var S,_=e.checkedStates[Symbol.iterator]();!(g=(S=_.next()).done);g=!0){var O=S.value;this.checkedStates.push(O)}}catch(e){w=!0,E=e}finally{try{g||null==_.return||_.return()}finally{if(w)throw E}}this.indexofString--}else this.indexofString=-1,this.testingManager.inputList.prevInput()}},{key:"hasNextStep",value:function(){return this.indexofString<this.testingManager.inputList.getCurrentInput().value.length||this.testingManager.inputList.hasNextInput()}},{key:"onNextStep",value:function(){var e=this,t=this.testingManager.inputList.getCurrentInput(),n=this.machineController.getMachineBuilder().getMachine();if(this.indexofString+=1,this.indexofString>=t.value.length){if(this.result=Mn(n,null,this.cachedStates,this.cachedSymbols,this.checkedStates),t.setResult(this.result),this.testingManager.inputList.hasNextInput()){this.testingManager.inputList.nextInput();return this.prepareForNewTest(),!0}return this.onPause(),!1}var r=this.getCurrentCache();this.history.push(r);var o=t.value[this.indexofString];this.result=Mn(n,o,this.cachedStates,this.cachedSymbols,this.checkedStates),this.targets.length=0;var i=!0,a=!1,l=void 0;try{for(var u,s=this.cachedStates[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,f=this.graphController.getGraph().getNodeByLabel(c.state);if(!f)throw new Error("Found null target");this.targets.includes(f)||this.targets.push(f)}}catch(e){a=!0,l=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw l}}if(this.targets.length<=0&&!this.running){this.skipToEnd=!0;setTimeout(function n(){e.skipToEnd&&(e.indexofString+=1,e.indexofString>=t.value.length?e.skipToEnd=!1:setTimeout(n,50))},50)}return!0}},{key:"getCurrentCache",value:function(){return{targets:this.targets.slice(),cachedStates:this.cachedStates.slice(),cachedSymbols:this.cachedSymbols.slice(),checkedStates:this.checkedStates.slice()}}},{key:"getCurrentTestStringIndex",value:function(){return this.indexofString+1}},{key:"prepareForNewTest",value:function(){this.cachedStates.length=0;var e=this.graphController.getGraph();if(!e.isEmpty()){var t=this.machineController.getMachineBuilder().getMachine();this.targets.length=0;var n=t.getStartState(),r=!0,o=!1,i=void 0;try{for(var a,l=t.doClosureTransition(n)[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;this.cachedStates.push({state:u,index:0});var s=e.getNodeByLabel(u);if(!s)throw new Error("Found null target");this.targets.push(s)}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}this.cachedSymbols.length=0,this.checkedStates.length=0,this.indexofString=-1,this.history.length=0,this.skipToEnd=!1}}}])&&Fn(t.prototype,n),r&&Fn(t,r),e}();function Un(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function zn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Vn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.inputList=[],this.addInput(""),this.inputIndex=0}var t,n,r;return t=e,(n=[{key:"isEmpty",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.inputList[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){if(r.value.value.length>0)return!1}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}return!0}},{key:"testByIndex",value:function(e,t){if(e<0||e>=this.inputList.length)throw new Error("Cannot find test input for index");var n=this.inputList[e];n.setResult(null);var r=function(e,t){"string"==typeof t&&(t=t[Symbol.iterator]());var n=[],r=[];n.push({state:e.getStartState(),index:0});var o=!0,i=!1,a=void 0;try{for(var l,u=e.doClosureTransition(e.getStartState())[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var s=l.value;n.push({state:s,index:0})}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}for(var c=[],f=0;n.length>0;){if(Mn(e,t.next().value,n,r,c))return!0;if(++f>1e3)return!1}return!1}(t,n.value);return n.setResult(r),r}},{key:"importTests",value:function(e){var t=this,n=new FileReader;n.onload=function(e){try{t.inputList.length=0,t.inputIndex=0;var r=e.target.result.split("\n"),o=!0,i=!1,a=void 0;try{for(var l,u=r[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var s=l.value;(s=s.trim()).length>0&&t.addInput(s)}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}t.inputList.length<0&&t.addInput("")}catch(e){n.abort()}},n.readAsText(e)}},{key:"getTestsAsStrings",value:function(){return this.inputList.map(function(e,t){return e.value})}},{key:"clearTests",value:function(){var e=this.inputList[0];e.value="",e.result=null,e.dirty=!0,this.inputList.length=1,this.inputIndex=0}},{key:"resetTests",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.inputIndex=0,e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.inputList[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.dirty=!0}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}}},{key:"getTests",value:function(){return this.inputList}},{key:"addInput",value:function(e){var t={value:e,result:null,dirty:!0,id:Un(),setResult:function(e){this.dirty=!1,this.result=e}};return this.inputList.push(t),t}},{key:"getInputByIndex",value:function(e){if(e<0||e>=this.inputList.length)throw new Error("Cannot find test input for index");return this.inputList[e]}},{key:"removeInputByIndex",value:function(e){if(e<0||e>=this.inputList.length)throw new Error("Cannot find test input for index");if(0===e)throw new Error("Cannot delete the first test input");e<=this.inputIndex&&--this.inputIndex,this.inputList.splice(e,1)}},{key:"nextInput",value:function(){return++this.inputIndex,this.inputIndex>=this.inputList.length&&(this.inputIndex=0),this.inputList[this.inputIndex]}},{key:"prevInput",value:function(){return--this.inputIndex,this.inputIndex<0&&(this.inputIndex=this.inputList.length-1),this.inputList[this.inputIndex]}},{key:"resetInput",value:function(){this.inputIndex=0}},{key:"hasNextInput",value:function(){return this.inputIndex<this.inputList.length}},{key:"hasPrevInput",value:function(){return this.inputIndex>0}},{key:"getCurrentInput",value:function(){return this.inputList[this.inputIndex]}},{key:"getCurrentInputIndex",value:function(){return this.inputIndex}}])&&zn(t.prototype,n),r&&zn(t,r),e}();function Hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.machineController=null,this.viewport=null,this.inputList=new Vn,this.shouldCheckError=!1,this.isImmediateErrorCheck=!1,this.errorCheckMode=e.NO_ERROR_CHECK,this.stepByStepMode=!1,this.testMode=new Gn(this)}var t,n,r;return t=e,(n=[{key:"initialize",value:function(e){this.machineController=e.machineController,this.viewport=e.viewport,this.testMode.initialize(e)}},{key:"destroy",value:function(){}},{key:"setErrorCheckMode",value:function(t){var n=this.machineController.getMachineBuilder();if(n.setMachineType(n.getMachineType()),t==e.NO_ERROR_CHECK)this.shouldCheckError=!1,this.errorCheckMode=t;else if(t==e.DELAYED_ERROR_CHECK)this.shouldCheckError=!0,this.isImmediateErrorCheck=!1,this.errorCheckMode=t;else{if(t!=e.IMMEDIATE_ERROR_CHECK)throw new Error("Unknown error check mode '"+t+"'");this.shouldCheckError=!0,this.isImmediateErrorCheck=!0,this.errorCheckMode=t}}},{key:"getErrorCheckMode",value:function(){return this.errorCheckMode}},{key:"setStepByStepMode",value:function(e){this.stepByStepMode=!!e,e?(this.testMode.isStarted()&&this.testMode.onStop(),this.testMode.onStart(),this.viewport.setState(function(e,t){if(e.mode!=Pn.TESTING)return{prevMode:e.mode,mode:Pn.TESTING}})):(this.testMode.isStarted()&&this.testMode.onStop(),this.viewport.setState(function(e,t){return{mode:e.prevMode}}))}},{key:"getStepByStepMode",value:function(){return this.stepByStepMode}}])&&Hn(t.prototype,n),r&&Hn(t,r),e}();Xn.NO_ERROR_CHECK="none",Xn.DELAYED_ERROR_CHECK="delayed",Xn.IMMEDIATE_ERROR_CHECK="immediate";var Yn=Xn;n(59);function Qn(e){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wn(e,t){return!t||"object"!==Qn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jn(e){return(Jn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qn(e,t){return(qn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zn=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Wn(this,Jn(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qn(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"add-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"}))}}])&&Kn(n.prototype,r),i&&Kn(n,i),t}();function $n(e){return($n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tr(e,t){return!t||"object"!==$n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nr(e){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rr(e,t){return(rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var or=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),tr(this,nr(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rr(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"remove-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11H7v-2h10v2z"}))}}])&&er(n.prototype,r),i&&er(n,i),t}();n(61);function ir(e){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lr(e,t){return!t||"object"!==ir(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ur(e){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sr(e,t){return(sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cr=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),lr(this,ur(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sr(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"success-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0zm0 0h24v24H0V0z"}),o.a.createElement("path",{d:"M16.59 7.58L10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}))}}])&&ar(n.prototype,r),i&&ar(n,i),t}();function fr(e){return(fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hr(e,t){return!t||"object"!==fr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yr(e){return(yr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vr(e,t){return(vr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dr=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),hr(this,yr(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vr(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"failure-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M14.59 8L12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}))}}])&&pr(n.prototype,r),i&&pr(n,i),t}();function mr(e){return(mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function br(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gr(e,t){return!t||"object"!==mr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wr(e){return(wr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Er(e,t){return(Er=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sr=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),gr(this,wr(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Er(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.a.createElement("path",{d:"M13.49 5.48c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm-3.6 13.9l1-4.4 2.1 2v6h2v-7.5l-2.1-2 .6-3c1.3 1.5 3.3 2.5 5.5 2.5v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1l-5.2 2.2v4.7h2v-3.4l1.8-.7-1.6 8.1-4.9-1-.4 2 7 1.4z"}))}}])&&br(n.prototype,r),i&&br(n,i),t}();function _r(e){return(_r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Or(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kr(e,t){return!t||"object"!==_r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cr(e){return(Cr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xr(e,t){return(xr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nr=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),kr(this,Cr(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xr(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.active;return!0===this.props.mode?o.a.createElement(F,{className:"status-icon success"+(e?" active":""),onClick:this.props.onClick},o.a.createElement(cr,null)):!1===this.props.mode?o.a.createElement(F,{className:"status-icon failure"+(e?" active":""),onClick:this.props.onClick},o.a.createElement(dr,null)):o.a.createElement(F,{className:"status-icon"+(e?" active":""),onClick:this.props.onClick},o.a.createElement(Sr,null))}}])&&Or(n.prototype,r),i&&Or(n,i),t}();function Pr(e){return(Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tr(e){return(Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mr(e,t){return(Mr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ir=function(e){function t(e){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(i=Tr(t).call(this,e))||"object"!==Pr(i)&&"function"!=typeof i?Dr(r):i).ref=o.a.createRef(),n.onStatusClick=n.onStatusClick.bind(Dr(Dr(n))),n.onSubmitClick=n.onSubmitClick.bind(Dr(Dr(n))),n.onValueChange=n.onValueChange.bind(Dr(Dr(n))),n.onKeyDown=n.onKeyDown.bind(Dr(Dr(n))),n.onKeyUp=n.onKeyUp.bind(Dr(Dr(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mr(e,t)}(t,o.a.Component),n=t,(r=[{key:"getInput",value:function(){return this.props.testList.getInputByIndex(this.props.index)}},{key:"isInputFirst",value:function(){return 0===this.props.index}},{key:"onStatusClick",value:function(e){this.props.testList.testByIndex(this.props.index,this.props.machineBuilder.getMachine())}},{key:"onSubmitClick",value:function(e){if(this.isInputFirst()){var t=this.getInput(),n=this.props.testList.addInput(t.value);n.result=t.result,n.dirty=t.dirty,t.value="",t.result=null,t.dirty=!0,this.ref.focus()}else this.props.testList.removeInputByIndex(this.props.index)}},{key:"onValueChange",value:function(e){var t=e.target.value.trim(),n=this.getInput();n.value=t,n.dirty=!0}},{key:"onKeyDown",value:function(e){if(e.keyCode===s.a.SUBMIT_KEY)e.preventDefault();else if(e.keyCode===s.a.DELETE_KEY){var t=this.getInput();if(t.value.length<=0){var n=this.props.index+1;if(this.props.testList.getTests().length>n){var r=this.props.testList.getInputByIndex(n);t.value=r.value,t.result=r.result,t.dirty=r.dirty,this.props.testList.removeInputByIndex(n)}}}}},{key:"onKeyUp",value:function(e){if(e.keyCode===s.a.SUBMIT_KEY){var t=e.shiftKey;if(this.isInputFirst()&&!t){var n=this.getInput(),r=this.props.testList.addInput(n.value);r.result=n.result,r.dirty=n.dirty,n.value="",n.result=null,n.dirty=!0,this.ref.focus()}else this.props.testList.testByIndex(this.props.index,this.props.machineBuilder.getMachine()),this.ref.select()}else e.keyCode===s.a.CLEAR_KEY&&e.target.blur()}},{key:"render",value:function(){var e=this,t=this.getInput(),n=this.isInputFirst();return o.a.createElement("div",{className:"testinginput-container "+(this.props.testList.getCurrentInputIndex()===this.props.index?" active":"")},o.a.createElement(Nr,{active:!t.dirty,mode:t.result,onClick:this.onStatusClick}),o.a.createElement("input",{ref:function(t){return e.ref=t},className:"testinginput-field",value:t.value,placeholder:"ε",onChange:this.onValueChange,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onFocus:function(e){return e.target.select()}}),o.a.createElement(F,{className:"testinginput-submit",onClick:this.onSubmitClick},n?o.a.createElement(Zn,null):o.a.createElement(or,null)))}}])&&jr(n.prototype,r),i&&jr(n,i),t}();function Lr(e){return(Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rr(e,t){return!t||"object"!==Lr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Br(e){return(Br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fr(e,t){return(Fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Gr=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Rr(this,Br(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fr(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this;return o.a.createElement("button",{className:"icon-button "+this.props.className,id:this.props.id,title:this.props.title,style:this.props.style,disabled:this.props.disabled,onClick:this.props.onClick},o.a.createElement("input",{ref:function(t){return e.uploadInput=t},id:"test-upload-input",type:"file",name:"import",style:{display:"none"},onChange:this.props.onChange,accept:".txt"}),o.a.createElement("label",{htmlFor:"test-upload-input"},this.props.children))}}])&&Ar(n.prototype,r),i&&Ar(n,i),t}();function Ur(e){return(Ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vr(e,t){return!t||"object"!==Ur(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hr(e){return(Hr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xr(e,t){return(Xr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yr=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Vr(this,Hr(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xr(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"upload-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"}))}}])&&zr(n.prototype,r),i&&zr(n,i),t}();function Qr(e){return(Qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wr(e,t){return!t||"object"!==Qr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jr(e){return(Jr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qr(e,t){return(qr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zr=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Wr(this,Jr(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qr(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"pagenewcontent-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"}))}}])&&Kr(n.prototype,r),i&&Kr(n,i),t}();function $r(e){return($r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function to(e,t){return!t||"object"!==$r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function no(e){return(no=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ro(e,t){return(ro=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oo=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),to(this,no(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ro(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"save-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"}),o.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}))}}])&&eo(n.prototype,r),i&&eo(n,i),t}();function io(e){return(io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ao(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lo(e,t){return!t||"object"!==io(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uo(e){return(uo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function so(e,t){return(so=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var co=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),lo(this,uo(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&so(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"close-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}}])&&ao(n.prototype,r),i&&ao(n,i),t}();function fo(e){return(fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function po(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ho(e){return(ho=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yo(e,t){return(yo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var mo=function(e){function t(e){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(i=ho(t).call(this,e))||"object"!==fo(i)&&"function"!=typeof i?vo(r):i).container=o.a.createRef(),n.uploadInput=o.a.createRef(),n.state={errorCheckMode:n.props.app.testingManager.getErrorCheckMode(),noTestMode:!0},n.stepByStepModeChecked=!1,n.onChangeErrorCheckMode=n.onChangeErrorCheckMode.bind(vo(vo(n))),n.onUploadFileChange=n.onUploadFileChange.bind(vo(vo(n))),n.onGraphChange=n.onGraphChange.bind(vo(vo(n))),n.onTestsRunAll=n.onTestsRunAll.bind(vo(vo(n))),n.onTestsClear=n.onTestsClear.bind(vo(vo(n))),n.onTestsSave=n.onTestsSave.bind(vo(vo(n))),n.onTestsNew=n.onTestsNew.bind(vo(vo(n))),n.onTestsUpload=n.onTestsUpload.bind(vo(vo(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yo(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentWillMount",value:function(){this.props.graphController.getGraph().on("markDirty",this.onGraphChange)}},{key:"componentWillUnmount",value:function(){this.props.graphController.getGraph().removeEventListener("markDirty",this.onGraphChange)}},{key:"onGraphChange",value:function(e){this.props.app.testingManager.inputList.resetTests()}},{key:"onUploadFileChange",value:function(e){var t=e.target.files;t.length>0&&(this.props.app.testingManager.inputList.importTests(t[0]),document.getElementById("test-name").innerHTML=t[0].name,e.target.value="")}},{key:"onChangeErrorCheckMode",value:function(e){var t=e.target.value,n=this.props.graphController,r=this.props.machineController,o=this.props.app.testingManager,i=n.getGraph(),a=r.getMachineBuilder();o.setErrorCheckMode(t),o.shouldCheckError?a.onGraphChange(i):a.machineErrorChecker.clear(),this.setState({errorCheckMode:t})}},{key:"onTestsRunAll",value:function(e){var t=this.props.machineController.getMachineBuilder().getMachine(),n=this.props.app.testingManager;if(n.testMode.isStarted())n.setStepByStepMode(!1);else{var r=n.inputList,o=r.getTests().length;n.setStepByStepMode(this.stepByStepModeChecked);for(var i=0;i<o;++i)r.testByIndex(i,t)}}},{key:"onTestsClear",value:function(e){this.props.app.testingManager.inputList.clearTests(),this.clearTestName(),this.hideTestInputList(),this.setState({noTestMode:!0})}},{key:"onTestsSave",value:function(e){var t=this.props.app.testingManager;Tn.downloadText("test.txt",t.inputList.getTestsAsStrings().join("\n"))}},{key:"onTestsNew",value:function(e){this.onTestsClear(),this.showTestInputList(),this.clearTestName(),this.setState({noTestMode:!1})}},{key:"onTestsUpload",value:function(e){this.onTestsNew(),this.showTestInputList()}},{key:"showTestInputList",value:function(){document.getElementById("test-inputlist-container").style.display="block"}},{key:"hideTestInputList",value:function(){document.getElementById("test-inputlist-container").style.display="none"}},{key:"clearTestName",value:function(){document.getElementById("test-name").innerHTML=""}},{key:"render",value:function(){var e=this,t=this.props.app,n=(t.viewport,t.testingManager),r=n.inputList,i=this.props.machineController.getMachineBuilder(),a=!i.isValidMachine();return o.a.createElement("div",{className:"panel-container",id:"testing",ref:function(t){return e.container=t},style:this.props.style},o.a.createElement("div",{className:"panel-title"},o.a.createElement("h1",null,I18N.toString("component.testing.title"))),o.a.createElement("div",{className:"test-icon-row"},o.a.createElement(F,{className:"testicon",id:"testing-new",title:I18N.toString("action.testing.new"),onClick:this.onTestsNew},o.a.createElement(Zr,null)),o.a.createElement(Gr,{className:"testicon",id:"testing-upload",title:I18N.toString("action.testing.import"),onClick:this.onTestsUpload,onChange:this.onUploadFileChange},o.a.createElement(Yr,null)),o.a.createElement(F,{className:"testicon",id:"testing-save",title:I18N.toString("action.testing.save"),onClick:this.onTestsSave,disabled:n.inputList.isEmpty()},o.a.createElement(oo,null)),o.a.createElement(F,{className:"testicon",id:"testing-clear",title:I18N.toString("action.testing.clear"),onClick:this.onTestsClear,disabled:this.state.noTestMode},o.a.createElement(co,null))),o.a.createElement("div",{className:"panel-content"},o.a.createElement("div",{className:"test-inputlist-container",id:"test-inputlist-container",style:{display:"none"}},o.a.createElement("div",{className:"scrollbar-container"},o.a.createElement("h3",{id:"test-name"},"Test Name"),o.a.createElement("div",{className:"test-inputlist-content"},a&&o.a.createElement("label",{className:"test-inputlist-content-warning"},"Not a valid machine!"),r.getTests().map(function(e,t){return o.a.createElement(Ir,{key:e.id,index:t,testList:r,machineBuilder:i})}))),o.a.createElement("button",{className:"panel-button",onClick:this.onTestsRunAll},n.testMode.isStarted()?I18N.toString("action.testing.stoprun"):I18N.toString("action.testing.runall")),o.a.createElement("div",{className:"panel-checkbox"},o.a.createElement("input",{id:"test-step",type:"checkbox",checked:this.stepByStepModeChecked,onChange:function(t){e.stepByStepModeChecked=t.target.checked,e.stepByStepModeChecked||n.setStepByStepMode(!1)},disabled:n.testMode.isStarted()}),o.a.createElement("label",{htmlFor:"test-step"},I18N.toString("options.testing.stepmode")))),o.a.createElement("hr",null),o.a.createElement("div",{id:"test-errorcheck"},o.a.createElement("label",null,I18N.toString("options.checkerrors")),o.a.createElement("select",{className:"panel-select",value:this.state.errorCheckMode,onChange:this.onChangeErrorCheckMode},o.a.createElement("option",{value:Yn.NO_ERROR_CHECK},I18N.toString("options.checkerrors.mode.none")),o.a.createElement("option",{value:Yn.DELAYED_ERROR_CHECK},I18N.toString("options.checkerrors.mode.delayed")),o.a.createElement("option",{value:Yn.IMMEDIATE_ERROR_CHECK},I18N.toString("options.checkerrors.mode.immediate"))))),o.a.createElement("div",{className:"panel-bottom"}))}}])&&po(n.prototype,r),i&&po(n,i),t}();mo.UNLOCALIZED_NAME="component.testing.title";var bo=mo;function go(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Eo(e,t,n){return t&&wo(e.prototype,t),n&&wo(e,n),e}var So=function(){function e(t,n,r,o,i,a){go(this,e),this._handler=t,this._id=Un(),this._type=r,this.value=n,this.tags=o,this.componentClass=i,this.componentProps=a}return Eo(e,[{key:"close",value:function(){var e=this._handler.getMessages(),t=e.indexOf(this);if(t<0)throw new Error("Trying to close an unopened notification message");e.splice(t,1)}},{key:"getType",value:function(){return this._type}},{key:"getID",value:function(){return this._id}},{key:"getComponentClass",value:function(){return this.componentClass}},{key:"getComponentProps",value:function(){return this.componentProps}},{key:"hasTag",value:function(e){return this.tags.indexOf(e)>=0}}]),e}(),_o=new(function(){function e(){go(this,e),this._messageQueue=[]}return Eo(e,[{key:"addMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];n&&i&&this.clearMessages(n);var a=new So(this,e,t||"default",n||[],r,o);this._messageQueue.unshift(a)}},{key:"addDefaultMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.addMessage(e,"default",t,n,r,o)}},{key:"addErrorMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.addMessage(e,"error",t,n,r,o)}},{key:"addWarningMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.addMessage(e,"warning",t,n,r,o)}},{key:"clearMessages",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e){var t;Array.isArray(e)||(e=[e]);for(var n=this._messageQueue.length-1;n>=0;--n){t=this._messageQueue[n];var r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;if(t.hasTag(u)){this._messageQueue.splice(n,1);break}}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}}}else this._messageQueue.length=0}},{key:"hasMessages",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e){Array.isArray(e)||(e=[e]);for(var t=this._messageQueue.length-1;t>=0;--t){message=this._messageQueue[t];var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value;if(message.hasTag(l))return!0}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}return!1}return this._messageQueue.length>=0}},{key:"getMessages",value:function(){return this._messageQueue}}]),e}());function Oo(e){return(Oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ko(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Co(e){return(Co=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xo(e,t){return(xo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function No(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Po=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=Co(t).call(this,e))||"object"!==Oo(o)&&"function"!=typeof o?No(r):o).onClick=n.onClick.bind(No(No(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xo(e,t)}(t,o.a.Component),n=t,(r=[{key:"onClick",value:function(e){var t=this.props.message;switch(e.target.value){case"convert":this.props.machineController.convertMachineTo("DFA"),t.close();break;default:throw new Error("Unknown button value for message")}}},{key:"render",value:function(){var e=this.props.machineController.getMachineBuilder().getMachine().getStates().length;return o.a.createElement("div",null,o.a.createElement("p",null,I18N.toString("message.warning.convertNFAToDFA")),o.a.createElement("p",null,"".concat(e," states -> ").concat(Math.pow(2,e)," states")),o.a.createElement("button",{value:"convert",onClick:this.onClick},I18N.toString("message.action.convert")))}}])&&ko(n.prototype,r),i&&ko(n,i),t}();function jo(e){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function To(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mo(e){return(Mo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Do(e,t){return(Do=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Io(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Lo=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=Mo(t).call(this,e))||"object"!==jo(o)&&"function"!=typeof o?Io(r):o).container=null,n.optimizeUnreachOption=null,n.optimizeRedundOption=null,n.onConvertToDFA=n.onConvertToDFA.bind(Io(Io(n))),n.onConvertToNFA=n.onConvertToNFA.bind(Io(Io(n))),n.onOptimizeMachine=n.onOptimizeMachine.bind(Io(Io(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Do(e,t)}(t,o.a.Component),n=t,(r=[{key:"onDeleteAllUnreachable",value:function(e){var t=this.props.machineController,n=t.getMachineBuilder().machineErrorChecker.getUnreachableNodes(),r=!0,o=!1,i=void 0;try{for(var a,l=n[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;u!=t.graphController.getGraph().getStartNode()&&t.graphController.getGraph().deleteNode(u)}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}}},{key:"onConvertToDFA",value:function(e){var t=this.props.machineController,n={graphController:this.props.graphController,machineController:t},r=s.a.MACHINE_CONVERSION_MESSAGE_TAG;_o.addMessage(I18N.toString("message.warning.convertNFAToDFA"),"warning",r,Po,n)}},{key:"onConvertToNFA",value:function(e){this.props.machineController.convertMachineTo("NFA")}},{key:"onOptimizeMachine",value:function(e){this.optimizeUnreachOption.checked&&this.onDeleteAllUnreachable(e)}},{key:"canOptimize",value:function(){return this.optimizeRedundOption&&this.optimizeRedundOption.checked||this.optimizeUnreachOption&&this.optimizeUnreachOption.checked}},{key:"render",value:function(){var e=this,t=this.props.graphController,n=this.props.machineController,r=(t.getGraph(),n.getMachineBuilder());return o.a.createElement("div",{className:"panel-container",id:"analysis",ref:function(t){return e.container=t},style:this.props.style},o.a.createElement("div",{className:"panel-title"},o.a.createElement("h1",null,I18N.toString("component.analysis.title"))),o.a.createElement("div",{className:"panel-content"},o.a.createElement("div",{style:{paddingBottom:"0.5em"}},o.a.createElement("h3",{style:{marginBottom:"0"}},"Optimizations"),o.a.createElement("div",{style:{paddingBottom:"0.5em"}},o.a.createElement("div",null,o.a.createElement("input",{ref:function(t){return e.optimizeUnreachOption=t},id:"opt-unreach",type:"checkbox"}),o.a.createElement("label",{htmlFor:"opt-unreach"},"Unreachables")),o.a.createElement("div",null,o.a.createElement("input",{ref:function(t){return e.optimizeRedundOption=t},id:"opt-redund",type:"checkbox",disabled:!0}),o.a.createElement("label",{htmlFor:"opt-redund"},"Redundant States"))),o.a.createElement("button",{className:"panel-button",onClick:this.onOptimizeMachine,disabled:!this.canOptimize()},"Optimize")),o.a.createElement("hr",null),"DFA"==r.getMachineType()?o.a.createElement("button",{className:"panel-button",onClick:this.onConvertToNFA},I18N.toString("action.overview.convertnfa")):"NFA"==r.getMachineType()?o.a.createElement("button",{className:"panel-button",onClick:this.onConvertToDFA},I18N.toString("action.overview.convertdfa")):null),o.a.createElement("div",{className:"panel-bottom"}))}}])&&To(n.prototype,r),i&&To(n,i),t}();Lo.UNLOCALIZED_NAME="component.analysis.title";var Ao=Lo;function Ro(e){return(Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fo(e,t){return!t||"object"!==Ro(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Go(e){return(Go=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uo(e,t){return(Uo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zo=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Fo(this,Go(t).call(this,e))).container=null,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uo(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"panel-container",id:"about",ref:function(t){return e.container=t},style:this.props.style},o.a.createElement("div",{className:"panel-title"},o.a.createElement("h1",null,"Finite State Automata")),o.a.createElement("div",{className:"panel-content"},o.a.createElement("p",null,"Brought to you with ❤ by the Flap.js team."),o.a.createElement("p",null,"<- Tap on a tab to begin!")),o.a.createElement("div",{className:"panel-bottom"}))}}])&&Bo(n.prototype,r),i&&Bo(n,i),t}(),Vo={__eventListeners:null,mixin:function(e){var t=e.prototype;Object.assign(t,Vo),delete t.mixin},registerEvent:function(e){if(this.__eventListeners||(this.__eventListeners=new Map),this.__eventListeners.has(e))throw new Error("Already registered event '"+e+"'");this.__eventListeners.set(e,[])},unregisterEvent:function(e){if(this.__eventListeners){if(!this.__eventListeners.has(e))throw new Error("Unable to find event '"+e+"'");this.__eventListeners.delete(e)}},addEventListener:function(e,t){if(this.__eventListeners||(this.__eventListeners=new Map),!this.__eventListeners.has(e))throw new Error("Unable to find event '"+e+"'");this.__eventListeners.get(e).push(t)},removeEventListener:function(e,t){if(this.__eventListeners){if(!this.__eventListeners.has(e))throw new Error("Unknown event '"+e+"'");for(var n=this.__eventListeners.get(e),r=!1,o=n.length;o--;)n[o]===t&&(n.splice(o,1),r=!0);if(!r)throw new Error("Unable to find listener for event '"+e+"'")}},clearEventListeners:function(e){if(this.__eventListeners){if(!this.__eventListeners.has(e))throw new Error("Unable to find event '"+e+"'");this.__eventListeners.get(e).length=0}},countEventListeners:function(e){return this.__eventListeners&&this.__eventListeners.has(e)?this.__eventListeners.get(e).length:0},getEventListeners:function(e){return this.__eventListeners?this.__eventListeners.get(e):null},on:function(e,t){this.addEventListener(e,t)},once:function(e,t){var n=this;this.addEventListener(e,function r(){try{for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];t.apply(null,i)}finally{n.removeEventListener(e,r)}})},emit:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];try{if(!this.__eventListeners)return;var o;if(!this.__eventListeners.has(e))throw new Error("Unable to find event '"+e+"'");o=this.__eventListeners.get(e);for(var i=null,a=o.length;a--;){try{i=o[a].apply(null,n)}catch(e){console.error(e)}if(!0===i)break}}finally{this.onEventProcessed.apply(this,[e].concat(n))}},onEventProcessed:function(e){}},Ho=Vo;function Xo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Yo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"applyLayout",value:function(e){if("circle"!=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"circle"))throw new Error("Invalid layout type");var t=e.getReachableState();var n=e.nodes.filter(function(e){return!t.includes(e)}),r=t.length,o=n.length,i=e.nodes.length,a=Math.max(r,o);if(0!=i){var l;l=r<10&&o<10?a/4*50+10:a/5*40+10;var u=2*Math.PI/r,s=2*Math.PI/o,c=0,f=!0,p=!1,h=void 0;try{for(var y,v=t[Symbol.iterator]();!(f=(y=v.next()).done);f=!0){var d=y.value;d.y=Math.sin(u*c+Math.PI)*l,d.x=Math.cos(u*c+Math.PI)*l,c+=1}}catch(e){p=!0,h=e}finally{try{f||null==v.return||v.return()}finally{if(p)throw h}}c=0;var m=!0,b=!1,g=void 0;try{for(var w,E=n[Symbol.iterator]();!(m=(w=E.next()).done);m=!0){var S=w.value;S.y=Math.sin(s*c+Math.PI)*(l+100),S.x=Math.cos(s*c+Math.PI)*(l+100),c+=1}}catch(e){b=!0,g=e}finally{try{m||null==E.return||E.return()}finally{if(b)throw g}}}}}],(n=null)&&Xo(t.prototype,n),r&&Xo(t,r),e}();function Qo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ko=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=t}var t,n,r;return t=e,(n=[{key:"setGraphElementID",value:function(e){return this._id=e,this}},{key:"getGraphElementID",value:function(){return this._id}}])&&Qo(t.prototype,n),r&&Qo(t,r),e}();function Wo(e){return(Wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qo(e,t){return!t||"object"!==Wo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zo(e){return(Zo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $o(e,t){return($o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ei=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=qo(this,Zo(t).call(this,e))).x=n,o.y=r,o._label="",o}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$o(e,t)}(t,Ko),n=t,(r=[{key:"setNodeLabel",value:function(e){return this._label=e,this}},{key:"getNodeLabel",value:function(){return this._label}},{key:"getNodeSize",value:function(){return 10}}])&&Jo(n.prototype,r),o&&Jo(n,o),t}();function ti(e){return(ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ni(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ri(e,t){return!t||"object"!==ti(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oi(e,t,n){return(oi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ii(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ii(e){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ai(e,t){return(ai=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var li=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"q";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ri(this,ii(t).call(this,Un(),r,o))).graph=e,n.customLabel=!1,n._label=i,n._accept=!1,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ai(e,t)}(t,ei),n=t,(r=[{key:"getNodeSize",value:function(){return s.a.NODE_RADIUS}},{key:"setNodeLabel",value:function(e){var n=this._label;oi(ii(t.prototype),"setNodeLabel",this).call(this,e),this.customLabel=!1,n!=e&&(this.graph.emit("nodeLabel",this,this._label,n),this.graph.markDirty())}},{key:"setCustomLabel",value:function(e){var t=this._label;this._label=e,this.customLabel=!0,t!=e&&(this.graph.emit("nodeCustomLabel",this,this._label,t),this.graph.markDirty())}},{key:"hasCustomLabel",value:function(){return this.customLabel}},{key:"accept",get:function(){return this._accept},set:function(e){var t=this._accept;this._accept=e,t!=e&&(this.graph.emit("toggleAccept",this,this._accept,t),this.graph.markDirty())}}])&&ni(n.prototype,r),o&&ni(n,o),t}();function ui(e){return(ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function si(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ci(e,t){return!t||"object"!==ui(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fi(e){return(fi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pi(e,t){return(pi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hi=function(e){function t(e,n,r){var o;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=ci(this,fi(t).call(this,e)),!n)throw new Error("Source of edge cannot be null.");return o._from=n,o._to=r,o._label="",o}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pi(e,t)}(t,Ko),n=t,(r=[{key:"setSourceNode",value:function(e){if(!e)throw new Error("Source of edge cannot be null.");return this._from=e,this}},{key:"getSourceNode",value:function(){return this._from}},{key:"setDestinationNode",value:function(e){return this._to=e,this}},{key:"changeDestinationNode",value:function(e){this._to=e}},{key:"getDestinationNode",value:function(){return this._to}},{key:"setEdgeLabel",value:function(e){this._label=e}},{key:"getEdgeLabel",value:function(){return this._label}},{key:"getEdgeDirection",value:function(){var e=this._from,t=this._to,n=Math.PI/2,r=0;if(this.isPlaceholder())r=Math.PI/4;else{var o=t.y-e.y,i=t.x-e.x;r=Math.atan2(o,i)}return(r>n||r<-n)&&(r+=Math.PI),r}},{key:"getStartPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},t=this._from;return e.x=t.x,e.y=t.y,e}},{key:"getCenterPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},t=this._from,n=this._to;if(this.isPlaceholder()){var r=this.getPlaceholderLength()/2;e.x=t.x+r,e.y=t.y+r}else e.x=t.x+(n.x-t.x)/2,e.y=t.y+(n.y-t.y)/2;return e}},{key:"getEndPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};if(this.isPlaceholder()){var t=this._from,n=getPlaceholderLength();e.x=t.x+n,e.y=t.y+n}else{var r=this._to;e.x=r.x,e.y=r.y}return e}},{key:"getPlaceholderLength",value:function(){return this._from.getNodeSize()}},{key:"isPlaceholder",value:function(){return!this._to}},{key:"isSelfLoop",value:function(){return this._from===this._to}}])&&si(n.prototype,r),o&&si(n,o),t}();function yi(e){return(yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function di(e,t){return!t||"object"!==yi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mi(e,t,n){return(mi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bi(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function bi(e){return(bi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gi(e,t){return(gi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wi(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{x:0,y:0},l=n-e,u=r-t,s=Math.atan2(u,l)+i;return a.x=Math.cos(s)*o,a.y=Math.sin(s)*o,a}function Ei(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:0,y:0};return o.x=e+(n-e)/2,o.y=t+(r-t)/2,o}var Si=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=di(this,bi(t).call(this,e,n,null)))._quad={radians:0,length:0,_coords:{x:0,y:0}},o.changeDestinationNode(r),o}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gi(e,t)}(t,hi),n=t,(r=[{key:"setQuadratic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return this._quad.radians=e,"number"==typeof t&&(this._quad.length=t),this}},{key:"getQuadratic",value:function(){return this._quad}},{key:"isQuadratic",value:function(){return!this.isPlaceholder()&&0!=this._quad.length}},{key:"setQuadraticByCoords",value:function(e,t){var n=this._from,r=this._to,o=n.x,i=n.y,a=r.x-o,l=r.y-i,u=o+a/2,s=i+l/2,c=Math.atan2(-l,a);a=e-u,l=t-s;var f=Math.PI,p=f/2,h=Math.atan2(l,a)+c,y=Math.sqrt(a*a+l*l);y<0&&(y=0);var v=h- -p,d=h-p,m=f/20;Math.abs(y)<8?(h=0,y=0):v<m&&v>-m?h=-p:-d<m&&-d>-m&&(h=p),this._quad.radians=h,this._quad.length=y}},{key:"getQuadraticAsCoords",value:function(){var e=this._from,t=this._to,n=this._quad._coords;return null==e||null==t?(n.x=0,n.y=0):wi(e.x,e.y,t.x,t.y,this._quad.length,this._quad.radians,n),n}},{key:"getSelfLoopHeight",value:function(){return this._from.getNodeSize()}},{key:"formatAsSelfLoop",value:function(){this.setQuadratic(-Math.PI/2,this._from.getNodeSize()+this.getSelfLoopHeight())}},{key:"formatAsPlaceholder",value:function(e){if(e){var t=this._from.x-e.x,n=this._from.y-e.y,r=-Math.atan2(t,n)-Math.PI/2;this._quad.radians=r}else this._quad.radians=0}},{key:"changeDestinationNode",value:function(e){var n=this._to;n!==e&&(mi(bi(t.prototype),"changeDestinationNode",this).call(this,e),this.isPlaceholder()?this.formatAsPlaceholder(n):this.isSelfLoop()&&this.formatAsSelfLoop())}},{key:"getEdgeDirection",value:function(){var e=0;if(this.isQuadratic()){var n=this.getQuadraticAsCoords();e=Math.atan2(n.y,n.x)+Math.PI/2}else e=mi(bi(t.prototype),"getEdgeDirection",this).call(this);return e}},{key:"getStartPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},t=this._from,n=this._to;if(!t)throw new Error("Source of edge cannot be null.");if(!n){var r=Math.cos(this._quad.radians),o=Math.sin(this._quad.radians),i=t.getNodeSize();return e.x=t.x+r*i,e.y=t.y+o*i,e}if(n.getNodeSize&&this.isQuadratic()){Ei(t.x,t.y,n.x,n.y,e);var a=this.getQuadraticAsCoords(),l=e.x+a.x,u=e.y+a.y;return wi(t.x,t.y,l,u,t.getNodeSize(),this.isSelfLoop()?Math.PI/4:0,e),e.x+=t.x,e.y+=t.y,e}return wi(t.x,t.y,n.x,n.y,t.getNodeSize(),0,e),e.x+=t.x,e.y+=t.y,e}},{key:"getEndPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},t=this._from,n=this._to;if(!t)throw new Error("Source of edge cannot be null.");if(!n){var r=Math.cos(this._quad.radians),o=Math.sin(this._quad.radians),i=t.getNodeSize()+this.getPlaceholderLength();return e.x=t.x+r*i,e.y=t.y+o*i,e}if(n.getNodeSize){if(this.isQuadratic()){Ei(t.x,t.y,n.x,n.y,e);var a=this.getQuadraticAsCoords(),l=e.x+a.x,u=e.y+a.y;return wi(n.x,n.y,l,u,n.getNodeSize(),this.isSelfLoop()?-Math.PI/4:0,e),e.x+=n.x,e.y+=n.y,e}return wi(n.x,n.y,t.x,t.y,n.getNodeSize(),0,e),e.x+=n.x,e.y+=n.y,e}return n}},{key:"getCenterPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},t=this._from,n=this._to;if(!t)throw new Error("Source of edge cannot be null.");if(!n){var r=Math.cos(this._quad.radians),o=Math.sin(this._quad.radians),i=t.getNodeSize()+this.getPlaceholderLength()/2;return e.x=t.x+r*i,e.y=t.y+o*i,e}if(Ei(t.x,t.y,n.x,n.y,e),this.isQuadratic()){var a=this.getQuadraticAsCoords();e.x+=a.x,e.y+=a.y}return e}}])&&vi(n.prototype,r),o&&vi(n,o),t}();function _i(e){return(_i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ki(e,t){return!t||"object"!==_i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ci(e,t,n){return(Ci="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xi(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xi(e){return(xi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ni(e,t){return(Ni=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pi=function(e){function t(e,n,r,o){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ki(this,xi(t).call(this,Un(),n,r))).graph=e,i._label=o,i}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ni(e,t)}(t,Si),n=t,(r=[{key:"setEdgeLabel",value:function(e){var n=this._label;Ci(xi(t.prototype),"setEdgeLabel",this).call(this,e),n!=e&&(this.graph.emit("edgeLabel",this,e,n),this.graph.markDirty())}}])&&Oi(n.prototype,r),o&&Oi(n,o),t}();function ji(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ti=s.a.EDGE_SYMBOL_SEPARATOR,Mi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodes=t,this.edges=n,this.registerEvent("nodeCreate"),this.registerEvent("nodeDestroy"),this.registerEvent("nodeLabel"),this.registerEvent("nodeCustomLabel"),this.registerEvent("edgeCreate"),this.registerEvent("edgeDestroy"),this.registerEvent("edgeLabel"),this.registerEvent("edgeDestination"),this.registerEvent("toggleAccept"),this.registerEvent("newInitial"),this.registerEvent("markDirty")}var t,n,r;return t=e,(n=[{key:"getNodeByLabel",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.nodes[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(a.getNodeLabel()==e)return a}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return null}},{key:"getNodeIndexByID",value:function(e){for(var t=this.nodes.length,n=0;n<t;++n){if(this.nodes[n].getGraphElementID()==e)return n}return-1}},{key:"getNodeIndex",value:function(e){for(var t=this.nodes.length-1;t>=0;--t){if(e===this.nodes[t])return t}return-1}},{key:"getNodeIndexByLabel",value:function(e){for(var t=this.nodes.length-1;t>=0;--t){if(this.nodes[t].getNodeLabel()==e)return t}return-1}},{key:"getReachableState",value:function(){var e=[],t=this.getStartNode();e.push(t);for(var n=0;n<e.length;n++){var r=!0,o=!1,i=void 0;try{for(var a,l=this.edges[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;u.from==e[n]&&(e.includes(u.to)||e.push(u.to))}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}}return e}},{key:"newNode",value:function(e,t,n){var r=new li(this,e,t,n);return 0==this.nodes.length&&this.emit("newInitial",r,null),this.nodes.push(r),this.emit("nodeCreate",r),this.markDirty(),r}},{key:"deleteNode",value:function(e){for(var t=null,n=this.edges.length-1;n>=0;--n)(t=this.edges[n]).getSourceNode()==e?(this.edges.splice(n,1),this.emit("edgeDestroy",t)):t.getDestinationNode()==e&&t.changeDestinationNode(null);var r=this.nodes.indexOf(e);this.nodes.splice(r,1),0==r&&this.emit("newInitial",this.getStartNode(),e),this.emit("nodeDestroy",e),this.markDirty()}},{key:"getEdgeIndexByID",value:function(e){for(var t=this.edges.length,n=0;n<t;++n){if(this.edges[n].getGraphElementID()==e)return n}return-1}},{key:"newEdge",value:function(e,t,n){var r=new Pi(this,e,t,n);return this.edges.push(r),this.emit("edgeCreate",r),this.markDirty(),r}},{key:"formatEdge",value:function(e){var t=e.getSourceNode(),n=e.getDestinationNode(),r=e.getEdgeLabel().split(Ti),o=!0,i=!1,a=void 0;try{for(var l,u=this.edges[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(c!==e&&(c.getSourceNode()===t&&c.getDestinationNode()===n)){var f=c.getEdgeLabel();if(r.length>0){var p=f.split(Ti).concat(r);c.setEdgeLabel(p.join(Ti))}return c}}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}if(!e.isSelfLoop()){var h=!1,y=s.a.PARALLEL_EDGE_HEIGHT,v=Math.PI/2,d=!0,m=!1,b=void 0;try{for(var g,w=this.edges[Symbol.iterator]();!(d=(g=w.next()).done);d=!0){var E=g.value;if(!(E.isQuadratic()&&Math.abs(E.getQuadratic().length)>=2*y)&&(E.getDestinationNode()===t&&E.getSourceNode()===n)){e.setQuadratic(v,y),E.setQuadratic(v,y),h=!0;break}}}catch(e){m=!0,b=e}finally{try{d||null==w.return||w.return()}finally{if(m)throw b}}if(!h){var S=t.x,_=t.y,O=n.x,k=n.y,C=(O-S)*(O-S)+(k-_)*(k-_),x=!1,N=0,P=0;S>O?P=k-(N=(_-k)/(S-O))*O:S<O?P=_-(N=(k-_)/(O-S))*S:x=!0;var j=!0,T=!1,M=void 0;try{for(var D,I=this.nodes[Symbol.iterator]();!(j=(D=I.next()).done);j=!0){var L=D.value;if(L!==t&&L!==n){var A=L.x,R=L.y;if(!((S-A)*(S-A)+(_-R)*(_-R)>C||(O-A)*(O-A)+(k-R)*(k-R)>C)){if((x?Math.abs(S-A):Math.abs(P+N*A-R)/Math.sqrt(1+N*N))<s.a.NODE_RADIUS){h=!0;break}}}}}catch(e){T=!0,M=e}finally{try{j||null==I.return||I.return()}finally{if(T)throw M}}h&&e.setQuadratic(-Math.PI/2,s.a.NODE_RADIUS+10)}}return e}},{key:"deleteEdge",value:function(e){this.edges.splice(this.edges.indexOf(e),1),this.emit("edgeDestroy",e),this.markDirty()}},{key:"deleteAll",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.nodes[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this.emit("nodeDestroy",i)}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}this.nodes.length=0;var a=!0,l=!1,u=void 0;try{for(var s,c=this.edges[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var f=s.value;this.emit("edgeDestroy",f)}}catch(e){l=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(l)throw u}}this.edges.length=0,this.markDirty()}},{key:"isEmpty",value:function(){return this.nodes.length<=0}},{key:"setStartNode",value:function(e){if(!(this.nodes.length<=1)){this.nodes.splice(this.nodes.indexOf(e),1);var t=this.nodes[0];this.nodes.unshift(e),this.emit("newInitial",e,t),this.markDirty()}}},{key:"getStartNode",value:function(){return this.nodes.length>0?this.nodes[0]:null}},{key:"getBoundingRect",value:function(){if(this.nodes.length<=0)return{minX:0,minY:0,maxX:1,maxY:1,width:1,height:1};var e=Number.MAX_VALUE,t=Number.MAX_VALUE,n=Number.MIN_VALUE,r=Number.MIN_VALUE;this.nodes.forEach(function(o){var i=o.x,a=o.y;e=Math.min(e,i),n=Math.max(n,i),t=Math.min(t,a),r=Math.max(r,a)}),e-=s.a.NODE_RADIUS,t-=s.a.NODE_RADIUS,n+=s.a.NODE_RADIUS,r+=s.a.NODE_RADIUS;var o=Number.MAX_VALUE,i=Number.MAX_VALUE,a=Number.MIN_VALUE,l=Number.MIN_VALUE;this.edges.forEach(function(e){var t=e.getStartPoint(),n=e.getEndPoint(),r=e.getCenterPoint(),u=t.x,s=t.y,c=n.x,f=n.y,p=r.x,h=r.y;o=Math.min(o,u,c,p),a=Math.max(a,u,c,p),i=Math.min(i,s,f,h),l=Math.max(l,s,f,h)});var u={minX:Math.min(e,o),minY:Math.min(t,i),maxX:Math.max(n,a),maxY:Math.max(r,l),width:0,height:0};return u.width=u.maxX-u.minX,u.height=u.maxY-u.minY,u}},{key:"copyGraph",value:function(e){this.deleteAll(),this.nodes=this.nodes.concat(e.nodes),this.edges=this.edges.concat(e.edges);var t=!0,n=!1,r=void 0;try{for(var o,i=e.nodes[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.graph=this}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}var a=!0,l=!1,u=void 0;try{for(var s,c=e.edges[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){s.value.graph=this}}catch(e){l=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(l)throw u}}this.markDirty()}},{key:"copyMachine",value:function(e){var t;this.deleteAll();var n,r,o,i,a=!0,l=!1,u=void 0;try{for(var s,c=e.getStates()[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var f=s.value;t=this.newNode(0,0,f),e.isFinalState(f)&&(t.accept=!0)}}catch(e){l=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(l)throw u}}var p=!0,h=!1,y=void 0;try{for(var v,d=e.getTransitions()[Symbol.iterator]();!(p=(v=d.next()).done);p=!0){var m=v.value;r=this.getNodeByLabel(m[0]),i=m[1],o=this.getNodeByLabel(m[2]),(n=this.newEdge(r,o,i))!=this.formatEdge(n)&&this.deleteEdge(n)}}catch(e){h=!0,y=e}finally{try{p||null==d.return||d.return()}finally{if(h)throw y}}var b=e.getStartState();this.setStartNode(this.getNodeByLabel(b)),Yo.applyLayout(this),this.markDirty()}},{key:"markDirty",value:function(){this.emit("markDirty",this)}},{key:"toDFA",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];throw new Error("DEPRECATED!")}},{key:"toNFA",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];throw new Error("DEPRECATED!")}},{key:"_toNFA",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];throw new Error("DEPRECATED!")}}])&&ji(t.prototype,n),r&&ji(t,r),e}();Ho.mixin(Mi);var Di=Mi;function Ii(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Li=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.graph=t,this.prefix=s.a.STR_STATE_LABEL,this.shouldAutoLabel=!1}var t,n,r;return t=e,(n=[{key:"sortDefaultNodeLabels",value:function(){var e=this.graph.getStartNode();if(e){var t=!e.hasCustomLabel(),n=[],r=[],o=!0,i=!1,a=void 0;try{for(var l,u=this.graph.nodes[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var s=l.value;s.hasCustomLabel()?r.push(s.getNodeLabel()):n.push(s)}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}for(var c=t?0:1,f=0;f<n.length;f++){for(var p=n[f],h=null;r.includes(h=this.getDefaultNodeLabelByIndex(c++)););p.setNodeLabel(h)}}}},{key:"getNextDefaultNodeLabel",value:function(){for(var e=0,t=this.getDefaultNodeLabelByIndex(e);!this.isUniqueNodeLabel(t);)++e,t=this.getDefaultNodeLabelByIndex(e);return t}},{key:"getDefaultNodeLabelByIndex",value:function(e){return this.prefix+e}},{key:"isUniqueNodeLabel",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.graph.nodes[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){if(o.value.getNodeLabel()==e)return!1}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return!0}}])&&Ii(t.prototype,n),r&&Ii(t,r),e}();function Ai(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ri=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.graph=t,this.graphController=null,this.labeler=new Li(t),this.onGraphNodeLabelChange=this.onGraphNodeLabelChange.bind(this)}var t,n,r;return t=e,(n=[{key:"initialize",value:function(e){this.graphController=e.graphController,this.setAutoRenameNodes(!0)}},{key:"destroy",value:function(){}},{key:"onGraphNodeLabelChange",value:function(e,t,n,r,o){this.labeler.sortDefaultNodeLabels()}},{key:"setAutoRenameNodes",value:function(e){var t=this.labeler.shouldAutoLabel;this.labeler.shouldAutoLabel=e,t!=e&&e?this.graphController.on("userDeleteNodes",this.onGraphNodeLabelChange):this.graphController.removeEventListener("userDeleteNodes",this.onGraphNodeLabelChange)}},{key:"shouldAutoRenameNodes",value:function(){return this.labeler.shouldAutoLabel}},{key:"getLabeler",value:function(){return this.labeler}}])&&Ai(t.prototype,n),r&&Ai(t,r),e}();function Bi(e){return(Bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gi(e){return(Gi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ui(e,t){return(Ui=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Vi=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=Gi(t).call(this,e))||"object"!==Bi(o)&&"function"!=typeof o?zi(r):o).targetIndex=0,n.targetLabel="";var i=e.message.value,a=!0,l=!1,u=void 0;try{for(var s,c=i[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var f=s.value;n.targetLabel.length>0&&(n.targetLabel+=", "),n.targetLabel+=f.getNodeLabel()}}catch(e){l=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(l)throw u}}return n.onClick=n.onClick.bind(zi(zi(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ui(e,t)}(t,o.a.Component),n=t,(r=[{key:"onClick",value:function(e){var t=this.props.graphController,n=this.props.machineController,r=e.target.value,o=this.props.message;switch(r){case"locate":var i=o.value[this.targetIndex++];this.targetIndex>=o.value.length&&(this.targetIndex=0),t.focusOnNode(i);break;case"deleteall":var a=o.value,l=!0,u=!1,s=void 0;try{for(var c,f=a[Symbol.iterator]();!(l=(c=f.next()).done);l=!0){var p=c.value;t.getGraph().deleteNode(p)}}catch(e){u=!0,s=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw s}}n.getMachineBuilder().labeler.sortDefaultNodeLabels(),o.close();break;default:throw new Error("Unknown button value for message")}}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("p",null,I18N.toString("message.warning.unreachable")+": "+this.targetLabel),o.a.createElement("button",{value:"locate",onClick:this.onClick},I18N.toString("message.action.locate")),o.a.createElement("button",{value:"deleteall",onClick:this.onClick},I18N.toString("message.action.deleteall")))}}])&&Fi(n.prototype,r),i&&Fi(n,i),t}();function Hi(e){return(Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yi(e){return(Yi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qi(e,t){return(Qi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ki(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Wi=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=Yi(t).call(this,e))||"object"!==Hi(o)&&"function"!=typeof o?Ki(r):o).targetIndex=0,n.targetLabel="";var i=e.message.value.targets,a=!0,l=!1,u=void 0;try{for(var s,c=i[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var f=s.value;n.targetLabel.length>0&&(n.targetLabel+=", "),n.targetLabel+=f.getNodeLabel()}}catch(e){l=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(l)throw u}}return n.onClick=n.onClick.bind(Ki(Ki(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qi(e,t)}(t,o.a.Component),n=t,(r=[{key:"onClick",value:function(e){var t=this.props.graphController,n=(this.props.machineController,e.target.value),r=this.props.message;switch(n){case"locate":var o=r.value.targets,i=o.length;if(i>0&&this.targetIndex<i){var a=o[this.targetIndex++];this.targetIndex>=i&&(this.targetIndex=0),t.focusOnNode(a)}break;default:throw new Error("Unknown button value for message")}}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("p",null,I18N.toString("message.error.missing")+": "+this.targetLabel),o.a.createElement("button",{value:"locate",onClick:this.onClick},I18N.toString("message.action.locate")))}}])&&Xi(n.prototype,r),i&&Xi(n,i),t}();function Ji(e){return(Ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zi(e){return(Zi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $i(e,t){return($i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ea(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ta=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=Zi(t).call(this,e))||"object"!==Ji(o)&&"function"!=typeof o?ea(r):o).targetIndex=0,n.targetLabel="";var i=e.message.value.targets,a=!0,l=!1,u=void 0;try{for(var s,c=i[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var f=s.value;n.targetLabel.length>0&&(n.targetLabel+=", "),n.targetLabel+="("+f.getSourceNode().getNodeLabel()+", "+f.getDestinationNode().getNodeLabel()+") "+Oe+" "+f.getEdgeLabel()}}catch(e){l=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(l)throw u}}return n.onClick=n.onClick.bind(ea(ea(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$i(e,t)}(t,o.a.Component),n=t,(r=[{key:"onClick",value:function(e){var t=this.props.graphController,n=(this.props.machineController,e.target.value),r=this.props.message;switch(n){case"locate":var o=r.value.targets,i=o.length;if(i>0&&this.targetIndex<i){var a=o[this.targetIndex++];this.targetIndex>=i&&(this.targetIndex=0),t.focusOnEdge(a)}break;case"deleteall":var l=r.value.targets,u=!0,s=!1,c=void 0;try{for(var f,p=l[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var h=f.value;t.getGraph().deleteEdge(h)}}catch(e){s=!0,c=e}finally{try{u||null==p.return||p.return()}finally{if(s)throw c}}r.close();break;default:throw new Error("Unknown button value for message")}}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("p",null,this.props.message.value.text+": "+this.targetLabel),o.a.createElement("button",{value:"locate",onClick:this.onClick},I18N.toString("message.action.locate")),o.a.createElement("button",{value:"deleteall",onClick:this.onClick},I18N.toString("message.action.deleteall")))}}])&&qi(n.prototype,r),i&&qi(n,i),t}();function na(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ra=s.a.EDGE_SYMBOL_SEPARATOR,oa=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.machineBuilder=t,this.graph=n,this.errorNodes=[],this.errorEdges=[],this.warningNodes=[],this.warningEdges=[]}var t,n,r;return t=e,(n=[{key:"clear",value:function(){this.errorNodes.length=0,this.errorEdges.length=0,this.warningNodes.length=0,this.warningEdges.length=0}},{key:"checkErrors",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("DFA"!=this.machineBuilder.getMachineType())throw new Error("Invalid machine type to check for DFA errors");var r=this.machineBuilder.getMachine(),o=this.graph,i=r.getAlphabet(),a=this.errorNodes,l=this.errorEdges,u=this.warningNodes,c=this.warningEdges;this.clear();var f=new Map,p=(o.getStartNode(),[]),h=[],y=[],v=!0,d=!1,m=void 0;try{for(var b,g=o.edges[Symbol.iterator]();!(v=(b=g.next()).done);v=!0){var w=b.value;if(w.isPlaceholder())p.push(w),-1==l.indexOf(w)&&l.push(w);else{var E=w.getSourceNode(),S=(w.getDestinationNode(),w.getEdgeLabel().split(ra)),_=!0,O=!1,k=void 0;try{for(var C,x=S[Symbol.iterator]();!(_=(C=x.next()).done);_=!0){var N=C.value;if("ε"==N)h.push(w),-1==l.indexOf(w)&&l.push(w);else if(f.has(E)){var P=f.get(E);P.includes(N)?(y.push(w),-1==l.indexOf(w)&&l.push(w)):P.push(N)}else f.set(E,[N])}}catch(e){O=!0,k=e}finally{try{_||null==x.return||x.return()}finally{if(O)throw k}}}}}catch(e){d=!0,m=e}finally{try{v||null==g.return||g.return()}finally{if(d)throw m}}var j=[],T=!0,M=!1,D=void 0;try{for(var I,L=o.nodes[Symbol.iterator]();!(T=(I=L.next()).done);T=!0){var A=I.value,R=f.get(A);(!R&&0!=i.length||R&&R.length<i.length)&&(j.push(A),-1==a.indexOf(A)&&a.push(A))}}catch(e){M=!0,D=e}finally{try{T||null==L.return||L.return()}finally{if(M)throw D}}var B=!(0==a.length&&0==l.length&&0==u.length&&0==c.length);if(e){var F=s.a.MACHINE_ERRORS_MESSAGE_TAG;if(_o.clearMessages(F),B){var G={graphController:t,machineController:n},U=getUnreachableNodes();U.length>0&&_o.addMessage(U,"warning",F,Vi,G,!1),p.length>0&&_o.addMessage({text:I18N.toString("message.error.incomplete"),targets:p},"error",F,ta,G,!1),h.length>0&&_o.addMessage({text:I18N.toString("message.error.empty"),targets:h},"error",F,ta,G,!1),y.length>0&&_o.addMessage({text:I18N.toString("message.error.dupe"),targets:y},"error",F,ta,G,!1),j.length>0&&_o.addMessage({targets:j},"error",F,Wi,G,!1)}else _o.addMessage(I18N.toString("message.error.none"),"success",F,null,null,!1)}return B}},{key:"getUnreachableNodes",value:function(){var e=this.graph,t=this.machineBuilder.getMachine(),n=e.nodes.slice(),r=[];for(r.push(n[0]),n.splice(0,1);r.length>0;){var o=r.pop(),i=n.indexOf(o);if(i>=0){n.splice(i,1);var a=t.getOutgoingTransitions(o),l=!0,u=!1,s=void 0;try{for(var c,f=a[Symbol.iterator]();!(l=(c=f.next()).done);l=!0){var p=c.value;r.push(p)}}catch(e){u=!0,s=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw s}}}}return n}}])&&na(t.prototype,n),r&&na(t,r),e}();function ia(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var aa=s.a.EDGE_SYMBOL_SEPARATOR,la=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.machineBuilder=t,this.graph=n,this.errorNodes=[],this.errorEdges=[],this.warningNodes=[],this.warningEdges=[]}var t,n,r;return t=e,(n=[{key:"clear",value:function(){this.errorNodes.length=0,this.errorEdges.length=0,this.warningNodes.length=0,this.warningEdges.length=0}},{key:"checkErrors",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this.machineBuilder.getMachine(),r=this.graph,o=(n.getAlphabet(),this.errorNodes),i=this.errorEdges,a=this.warningNodes,l=this.warningEdges;this.clear();new Map;var u=r.nodes.slice(),c=r.getStartNode();u.splice(u.indexOf(c),1);var f=[],p=!0,h=!1,y=void 0;try{for(var v,d=r.edges[Symbol.iterator]();!(p=(v=d.next()).done);p=!0){var m=v.value;if(m.isPlaceholder())f.push(m),-1==i.indexOf(m)&&i.push(m);else{m.getSourceNode();var b=m.getDestinationNode(),g=m.getEdgeLabel().split(aa),w=!0,E=!1,S=void 0;try{for(var _,O=g[Symbol.iterator]();!(w=(_=O.next()).done);w=!0){_.value;u.includes(b)&&u.splice(u.indexOf(b),1)}}catch(e){E=!0,S=e}finally{try{w||null==O.return||O.return()}finally{if(E)throw S}}}}}catch(e){h=!0,y=e}finally{try{p||null==d.return||d.return()}finally{if(h)throw y}}var k=!0,C=!1,x=void 0;try{for(var N,P=u[Symbol.iterator]();!(k=(N=P.next()).done);k=!0){var j=N.value;-1==a.indexOf(j)&&a.push(j)}}catch(e){C=!0,x=e}finally{try{k||null==P.return||P.return()}finally{if(C)throw x}}var T=!(0==o.length&&0==i.length&&0==a.length&&0==l.length),M=s.a.MACHINE_ERRORS_MESSAGE_TAG;if(_o.clearMessages(M),T){var D={graphController:e,machineController:t};u.length>0&&_o.addMessage(u,"warning",M,Vi,D,!1),f.length>0&&_o.addMessage({text:I18N.toString("message.error.incomplete"),targets:f},"error",M,ta,D,!1)}else _o.addMessage(I18N.toString("message.error.none"),"success",M,null,null,!1);return T}},{key:"getUnreachableNodes",value:function(){var e=this.graph,t=e.nodes.slice(),n=!0,r=!1,o=void 0;try{for(var i,a=e.edges[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value,u=l.label.split(","),s=!0,c=!1,f=void 0;try{for(var p,h=u[Symbol.iterator]();!(s=(p=h.next()).done);s=!0){p.value,l.from;var y=l.to;t.includes(y)&&t.splice(t.indexOf(y),1)}}catch(e){c=!0,f=e}finally{try{s||null==h.return||h.return()}finally{if(c)throw f}}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}}])&&ia(t.prototype,n),r&&ia(t,r),e}();function ua(e){return(ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ca(e,t,n){return(ca="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fa(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function fa(e){return(fa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pa(e,t){return(pa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ha(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ya=s.a.EDGE_SYMBOL_SEPARATOR;function va(e,t){if(e.nodes.length<=0)return t;var n=!0,r=!1,o=void 0;try{for(var i,a=e.nodes[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value;try{var u=l.getNodeLabel();t.newState(u),l.accept&&t.setFinalState(u,!0)}catch(e){throw e}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}var s=!0,c=!1,f=void 0;try{for(var p,h=e.edges[Symbol.iterator]();!(s=(p=h.next()).done);s=!0){var y=p.value;if(!y.isPlaceholder()){var v=y.getSourceNode(),d=y.getDestinationNode();if(v instanceof li&&d instanceof li){var m=y.getEdgeLabel().split(ya),b=!0,g=!1,w=void 0;try{for(var E,S=m[Symbol.iterator]();!(b=(E=S.next()).done);b=!0){var _=E.value;try{t.newTransition(v.getNodeLabel(),d.getNodeLabel(),_)}catch(e){throw e}}}catch(e){g=!0,w=e}finally{try{b||null==S.return||S.return()}finally{if(g)throw w}}}}}}catch(e){c=!0,f=e}finally{try{s||null==h.return||h.return()}finally{if(c)throw f}}var O=e.getStartNode().getNodeLabel();return t.setStartState(O),t}var da=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=fa(t).call(this,e))||"object"!==ua(o)&&"function"!=typeof o?ha(r):o)._machine=new je,n._machineType="DFA",n._machineValidDFA=!1,n._alphabet=[],n._symbols=[],n._timer=null,n._errorTimer=null,n.machineErrorChecker=new oa(ha(ha(n)),e),n.tester=null,n.graphController=null,n.machineController=null,n.onGraphChange=n.onGraphChange.bind(ha(ha(n))),n.onDelayedGraphChange=n.onDelayedGraphChange.bind(ha(ha(n))),n.onDelayedErrorCheck=n.onDelayedErrorCheck.bind(ha(ha(n))),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pa(e,t)}(t,Ri),n=t,(r=[{key:"initialize",value:function(e){ca(fa(t.prototype),"initialize",this).call(this,e),this.tester=e.testingManager,this.graphController=e.graphController,this.machineController=e.machineController,this.graph.on("nodeCreate",this.onGraphChange),this.graph.on("nodeDestroy",this.onGraphChange),this.graph.on("nodeLabel",this.onGraphChange),this.graph.on("edgeCreate",this.onGraphChange),this.graph.on("edgeDestroy",this.onGraphChange),this.graph.on("edgeLabel",this.onGraphChange),this.graph.on("edgeDestination",this.onGraphChange),this.graph.on("toggleAccept",this.onGraphChange),this.graph.on("newInitial",this.onGraphChange),this.graph.on("markDirty",this.onGraphChange),this.onGraphChange()}},{key:"destroy",value:function(){this.onGraphChange(),this.graph.removeEventListener("nodeCreate",this.onGraphChange),this.graph.removeEventListener("nodeDestroy",this.onGraphChange),this.graph.removeEventListener("nodeLabel",this.onGraphChange),this.graph.removeEventListener("edgeCreate",this.onGraphChange),this.graph.removeEventListener("edgeDestroy",this.onGraphChange),this.graph.removeEventListener("edgeLabel",this.onGraphChange),this.graph.removeEventListener("edgeDestination",this.onGraphChange),this.graph.removeEventListener("toggleAccept",this.onGraphChange),this.graph.removeEventListener("newInitial",this.onGraphChange),this.graph.removeEventListener("markDirty",this.onGraphChange),ca(fa(t.prototype),"destroy",this).call(this)}},{key:"onGraphChange",value:function(e){this.tester&&(this._timer&&(clearTimeout(this._timer),this._timer=null),this._errorTimer&&(clearTimeout(this._errorTimer),this._errorTimer=null),this._timer=setTimeout(this.onDelayedGraphChange,s.a.GRAPH_IMMEDIATE_INTERVAL),this._errorTimer=setTimeout(this.onDelayedErrorCheck,this.tester.isImmediateErrorCheck?2*s.a.GRAPH_IMMEDIATE_INTERVAL:s.a.ERROR_CHECK_INTERVAL))}},{key:"onDelayedGraphChange",value:function(){this._machine.clear();this.toNFA(this._machine);var e=!0,t=!1,n=void 0;try{for(var r,o=this._symbols[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;this._machine.newSymbol(i)}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}this._machineValidDFA=this._machine.isValidDFA()}},{key:"onDelayedErrorCheck",value:function(){this.tester.shouldCheckError&&this.machineErrorChecker.checkErrors(!0,this.graphController,this.machineController)}},{key:"formatAlphabetString",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.split(ya),r=new Set,o="",i=0,a=n.length,l=0;l<a;++l)if(1!==(i=(o=n[l].trim()).length)){if(i>1){var u=!0,s=!1,c=void 0;try{for(var f,p=o.split("")[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var h=f.value;h=h.trim(),r.has(h)||r.add(h)}}catch(e){s=!0,c=e}finally{try{u||null==p.return||p.return()}finally{if(s)throw c}}}}else r.add(o);return 0===r.size?t?null:"ε":Array.from(r).join(ya)}},{key:"setMachineType",value:function(e){if(this._machineType!=e){if(this._machineType=e,"DFA"==e)this.machineErrorChecker=new oa(this,this.graph);else{if("NFA"!=e)throw new Error("Cannot find error checker for machine type '"+e+"'");this.machineErrorChecker=new la(this,this.graph)}this.onGraphChange()}}},{key:"getMachineType",value:function(){return this._machineType}},{key:"addCustomSymbol",value:function(e){this._symbols.push(e),this.onGraphChange()}},{key:"removeCustomSymbol",value:function(e){this._symbols.splice(this._symbols.indexOf(e),1),this.onGraphChange()}},{key:"renameCustomSymbol",value:function(e,t){var n=this._symbols.indexOf(e);if(n<=0)throw new Error("Trying to rename unknown symbol '"+e+"'");this._symbols[n]=t,this.onGraphChange()}},{key:"isCustomSymbol",value:function(e){return this._symbols.includes(e)}},{key:"getAlphabet",value:function(){var e=this.getMachine();return this._alphabet.length=0,e.getAlphabet(this._alphabet),this._alphabet}},{key:"isValidMachine",value:function(){return"DFA"!=this._machineType||this._machineValidDFA}},{key:"toDFA",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||new Bn;if(!(e instanceof Bn))throw new Error("Trying to parse graph mismatched machine type.");return va(this.graph,e),e}},{key:"toNFA",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||new je;if(!(e instanceof je))throw new Error("Trying to parse graph mismatched machine type.");return va(this.graph,e),e}},{key:"getMachine",value:function(){return this._machine}}])&&sa(n.prototype,r),o&&sa(n,o),t}();function ma(e){return(ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ba(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ga(e,t){return!t||"object"!==ma(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wa(e,t,n){return(wa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ea(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ea(e){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sa(e,t){return(Sa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _a=[bo,at,Ao],Oa=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ga(this,Ea(t).call(this)))._graph=new Di,e._machineBuilder=new da(e._graph),e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sa(e,t)}(t,u),n=t,(r=[{key:"initialize",value:function(e){wa(Ea(t.prototype),"initialize",this).call(this,e),this._machineBuilder.initialize(e)}},{key:"destroy",value:function(e){this._machineBuilder.destroy(),wa(Ea(t.prototype),"destroy",this).call(this,e)}},{key:"getGraph",value:function(){return this._graph}},{key:"getMachineBuilder",value:function(){return this._machineBuilder}},{key:"getLabelFormatter",value:function(){return this._machineBuilder.formatAlphabetString.bind(this._machineBuilder)}},{key:"getModuleInfoPanel",value:function(){return zo}},{key:"getModulePanels",value:function(){return _a}},{key:"getModuleName",value:function(){return"fsa"}}])&&ba(n.prototype,r),o&&ba(n,o),t}();function ka(e,t,n){var r=[],o=t.getAlphabet(),i=xa(e);n.hasState(i)||r.push(Ca(n,t,e));var a=[],l=null,u=!0,s=!1,c=void 0;try{for(var f,p=o[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var h=f.value,y=!0,v=!1,d=void 0;try{for(var m,b=e[Symbol.iterator]();!(y=(m=b.next()).done);y=!0){var g=m.value;t.doTerminalTransition(g,h,a)}}catch(e){v=!0,d=e}finally{try{y||null==b.return||b.return()}finally{if(v)throw d}}a.length>0&&(l=xa(a),n.hasState(l)||(l=Ca(n,t,a),r.push(l)),n.newTransition(i,l,h)),a.length=0}}catch(e){s=!0,c=e}finally{try{u||null==p.return||p.return()}finally{if(s)throw c}}return r}function Ca(e,t,n){var r=e.newState(xa(n)),o=!0,i=!1,a=void 0;try{for(var l,u=n[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var s=l.value;if(t.isFinalState(s)){e.setFinalState(r);break}}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}return r}function xa(e){return e.sort(),"{"+e.join(",")+"}"}function Na(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._module=null,this.machineName=null,this.graphController=null,this.registerEvent("userChangeMachine"),this.registerEvent("userConvertMachine"),this.registerEvent("userPreConvertMachine"),this.registerEvent("userPostConvertMachine"),this.registerEvent("userRenameMachine"),this.registerEvent("userCreateSymbol"),this.registerEvent("userDeleteSymbol"),this.registerEvent("userPreDeleteSymbol"),this.registerEvent("userPostDeleteSymbol"),this.registerEvent("userRenameSymbol"),this.registerEvent("userPreRenameSymbol"),this.registerEvent("userPostRenameSymbol")}var t,n,r;return t=e,(n=[{key:"setModule",value:function(e){this._module=e}},{key:"initialize",value:function(e){this.graphController=e.graphController}},{key:"destroy",value:function(){}},{key:"getLabelFormatter",value:function(){return this._module.getLabelFormatter()}},{key:"getMachineBuilder",value:function(){return this._module.getMachineBuilder()}},{key:"getMachineType",value:function(){return this.getMachineBuilder().getMachineType()}},{key:"setMachineType",value:function(e){this.getMachineBuilder().setMachineType(e)}},{key:"getMachineName",value:function(){return this.machineName||I18N.toString("file.untitled")}},{key:"setMachineName",value:function(e){!e||e.length<=0?this.machineName=null:this.machineName=e;var t=this.getMachineName(),n=document.getElementById("window-title"),r=n.innerHTML,o=r.indexOf("-");n.innerHTML=-1!==o?t+" - "+r.substring(o+1).trim():t+" - "+r}},{key:"renameMachine",value:function(e){var t=this.machineName;this.setMachineName(e),this.emit("userRenameMachine",this.getMachineBuilder(),e,t)}},{key:"changeMachineTo",value:function(e){var t=this.getMachineBuilder().getMachineType();t!=e&&(this.setMachineType(e),this.emit("userChangeMachine",this.getMachineBuilder(),e,t))}},{key:"convertMachineTo",value:function(e){var t=this.getMachineType();if(t!==e)if("DFA"==e&&"NFA"==t){this.emit("userPreConvertMachine",this.getMachineBuilder(),e,t);var n=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||new Bn,n=(e.getAlphabet(),e.getStartState()),r=e.doClosureTransition(n),o=(Ca(t,e,r),e.getPowerSet()),i=!0,a=!1,l=void 0;try{for(var u,s=o[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;console.log("Adding to DFA: "+xa(c)),0!=c.length&&ka(c,e,t)}}catch(e){a=!0,l=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw l}}var f=t.newState("{}"),p=t.getAlphabet(),h=!0,y=!1,v=void 0;try{for(var d,m=t.getStates()[Symbol.iterator]();!(h=(d=m.next()).done);h=!0){var b=d.value,g=!0,w=!1,E=void 0;try{for(var S,_=p[Symbol.iterator]();!(g=(S=_.next()).done);g=!0){var O=S.value;t.doTransition(b,O)||t.newTransition(b,f,O)}}catch(e){w=!0,E=e}finally{try{g||null==_.return||_.return()}finally{if(w)throw E}}}}catch(e){y=!0,v=e}finally{try{h||null==m.return||m.return()}finally{if(y)throw v}}return t}(this.getMachineBuilder().getMachine(),new Bn);this.graphController.getGraph().copyMachine(n),this.setMachineType(e),this.emit("userConvertMachine",this.getMachineBuilder(),e,t),this.emit("userPostConvertMachine",this.getMachineBuilder(),e,t)}else{if("NFA"!=e||"DFA"!=t)throw new Error("Conversion scheme between '"+t+"' to '"+e+"' is not supported");this.changeMachineTo(e)}}},{key:"getAlphabet",value:function(){return this.getMachineBuilder().getAlphabet()}},{key:"createSymbol",value:function(e){this.getMachineBuilder().addCustomSymbol(e),this.emit("userCreateSymbol",this.getMachineBuilder(),e)}},{key:"deleteSymbol",value:function(e){var t=null,n=null,r=null,o=[];this.emit("userPreDeleteSymbol",this.getMachineBuilder(),e);for(var i=this.graphController.getGraph(),a=i.edges.length-1;a>=0;--a)(n=(t=i.edges[a]).getEdgeLabel().indexOf(e))>=0&&((r=t.getEdgeLabel().substring(0,n)+t.getEdgeLabel().substring(n+1)).length>0?t.setEdgeLabel(r):(t.setEdgeLabel(""),i.deleteEdge(t)),o.push(t));o.length<=0&&this.getMachineBuilder().removeCustomSymbol(e),this.emit("userDeleteSymbol",this.getMachineBuilder(),e,o),this.emit("userPostDeleteSymbol",this.getMachineBuilder(),e,o)}},{key:"renameSymbol",value:function(e,t){var n=null,r=[];this.emit("userPreRenameSymbol",this.getMachineBuilder(),t,e);for(var o=this.graphController.getGraph(),i=o.edges.length,a=0;a<i;++a){var l=(n=o.edges[a]).getEdgeLabel().replace(e,t);l!=n.getEdgeLabel()&&r.push(n),n.setEdgeLabel(l)}r.length<=0&&this.getMachineBuilder().renameCustomSymbol(e,t),this.emit("userRenameSymbol",this.getMachineBuilder(),t,e,r),this.emit("userPostRenameSymbol",this.getMachineBuilder(),t,e,r)}},{key:"getCustomSymbols",value:function(){return this.getMachineBuilder()._symbols}},{key:"isCustomSymbol",value:function(e){return this.getMachineBuilder().isCustomSymbol(e)}}])&&Na(t.prototype,n),r&&Na(t,r),e}();Ho.mixin(Pa);var ja=Pa;function Ta(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ma=s.a.EDGE_SYMBOL_SEPARATOR,Da=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"parseJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.nodeCount,r=e.edgeCount;if(n<0)throw new Error("Invalid graph data: negative number of nodes.");if(r<0)throw new Error("Invalid graph data: negative number of edges.");t&&t.deleteAll();for(var o=t||new Di(new Array(n),new Array(r)),i=0;i<n;++i){var a=e.nodes[i],l=new li(o,a.x||0,a.y||0,a.label||"q?");l.setGraphElementID(a.id),l.accept=a.accept,a.customLabel&&l.setCustomLabel(l.getNodeLabel()),o.nodes[i]=l}for(var u=0;u<r;++u){var s=e.edges[u];if(s.from>=n||s.from<0)throw new Error("Invalid edge from data: node index '"+s.from+"' out of bounds.");var c=new Pi(o,o.nodes[s.from],s.to<0?null:o.nodes[s.to],s.label||"0");c.setGraphElementID(s.id),c.setQuadratic(s.quad.radians,s.quad.length),o.edges[u]=c}return o}},{key:"parseXML",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.getElementsByTagName("state"),r=e.getElementsByTagName("transition"),o=n.length,i=r.length;if(o<0)throw new Error("Invalid graph data: negative number of nodes.");if(i<0)throw new Error("Invalid graph data: negative number of edges.");t&&t.deleteAll();for(var a,l=t||new Di(new Array(o),[]),u=new Map,c=0;c<o;++c){var f=n[c],p=(f.attributes[1].nodeValue,f.attributes[0].nodeValue),h=parseFloat(f.childNodes[1].childNodes[0].nodeValue),y=parseFloat(f.childNodes[3].childNodes[0].nodeValue),v=f.getElementsByTagName("final"),d=f.getElementsByTagName("initial");d&&d.length>0&&(a=p);var m=new li(l,h,y,s.a.STR_STATE_LABEL+p);m.accept=null!=v&&v.length>0,d&&d.length>0&&(l.nodes[0]?(l.nodes[c]=l.nodes[0],u.set(n[0].attributes[0].nodeValue,c),l.nodes[0]=m,u.set(p,0)):(l.nodes[0]=m,u.set(p,0))),l.nodes[c]=m,u.set(p,c)}for(var b=l.getBoundingRect(),g=b.width,w=b.height,E=0;E<l.nodes.length;E++)l.nodes[E].x-=b.minX+g/2,l.nodes[E].y-=b.minY+w/2;for(var S=0;S<i;++S){var _=r[S],O=_.childNodes[1].childNodes[0].nodeValue,k=_.childNodes[3].childNodes[0].nodeValue,C=_.childNodes[5];C=C.childNodes[0]?C.childNodes[0].nodeValue:EMPTY;var x=u.get(O),N=u.get(k);if(!(l.nodes[x]||a==O&&l.nodes[0]||0==O&&l.nodes[a]))throw new Error("Invalid edge from data: node index '"+_.from+"' out of bounds.");var P=l.newEdge(l.nodes[x],k<0?null:l.nodes[N],C||"0");P!=l.formatEdge(P)&&l.deleteEdge(P)}return l}},{key:"toJSON",value:function(e){for(var t=e.nodes.length,n=e.edges.length,r={nodeCount:t,nodes:new Array(t),edgeCount:n,edges:new Array(n)},o=0;o<t;++o){var i=e.nodes[o];r.nodes[o]={id:i.getGraphElementID(),x:i.x,y:i.y,label:i.getNodeLabel(),accept:i.accept,customLabel:i.hasCustomLabel()}}for(var a=0;a<n;++a){var l=e.edges[a],u=l.getQuadratic();r.edges[a]={id:l.getGraphElementID(),from:e.nodes.indexOf(l.getSourceNode()),to:e.nodes.indexOf(l.getDestinationNode()),quad:{radians:u.radians,length:u.length},label:l.getEdgeLabel()}}return r}},{key:"toXML",value:function(e){var t='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\x3c!--Created with flap.js '+Ba+"--\x3e<structure></structure>",n=(new DOMParser).parseFromString(t,"application/xml"),r=n.getElementsByTagName("structure")[0],o=n.createElement("type");o.innerHTML="fa",r.appendChild(o);var i,a,l,u,s,c,f,p,h,y=n.createElement("automaton");r.appendChild(y);for(var v=0;v<e.nodes.length;++v)i=e.nodes[v],(a=n.createElement("state")).id=""+v,a.setAttribute("name",i.getNodeLabel()),y.appendChild(a),(l=n.createElement("x")).innerHTML=i.x,a.appendChild(l),(u=n.createElement("y")).innerHTML=i.y,a.appendChild(u),0==v&&a.appendChild(n.createElement("initial")),i.accept&&a.appendChild(n.createElement("final"));var d=!0,m=!1,b=void 0;try{for(var g,w=e.edges[Symbol.iterator]();!(d=(g=w.next()).done);d=!0){var E=g.value;h=E.getEdgeLabel().split(Ma);var S=!0,_=!1,O=void 0;try{for(var k,C=h[Symbol.iterator]();!(S=(k=C.next()).done);S=!0){var x=k.value;s=n.createElement("transition"),y.appendChild(s),(c=n.createElement("from")).innerHTML=e.nodes.indexOf(E.getSourceNode()),s.appendChild(c),(f=n.createElement("to")).innerHTML=e.nodes.indexOf(E.getDestinationNode()),s.appendChild(f),(p=n.createElement("read")).innerHTML=x,s.appendChild(p)}}catch(e){_=!0,O=e}finally{try{S||null==C.return||C.return()}finally{if(_)throw O}}}}catch(e){m=!0,b=e}finally{try{d||null==w.return||w.return()}finally{if(m)throw b}}return n}}],(n=null)&&Ta(t.prototype,n),r&&Ta(t,r),e}();function Ia(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var La=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.major=t,this.minor=n,this.patch=r}var t,n,r;return t=e,r=[{key:"stringify",value:function(e){return e.major+"."+e.minor+"."+e.patch}},{key:"parse",value:function(t){if("string"!=typeof t)throw new Error("Invalid argument type to parse as SemanticVersion");var n,r,o,i=t.split(".");if(3!=i.length)throw new Error("Invalid format for SemanticVersion");try{n=Number.parseInt(i[0]),r=Number.parseInt(i[1]),o=Number.parseInt(i[2])}catch(e){throw e}return new e(n,r,o)}}],(n=[{key:"canSupportVersion",value:function(e){return this.major==e.major&&(this.minor<e.minor||this.minor==e.minor&&this.patch<=e.patch)}}])&&Ia(t.prototype,n),r&&Ia(t,r),e}();function Aa(e){return(Aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ra=new La(0,2,0),Ba=La.stringify(Ra);function Fa(e,t){var n=e.getGraph(),r=t.getMachineBuilder();if(n.isEmpty())return{};var o={};return o.metadata={version:Ba},o.graphData=Da.toJSON(n),o.machineData={name:t.getMachineName(),type:t.getMachineType(),symbols:t.getCustomSymbols(),statePrefix:r.getLabeler().prefix},o}function Ga(e,t,n){var r=t.getGraph(),o=n.getMachineBuilder();try{var i=e.metadata;if("object"==Aa(i)){var a=La.parse(i.version);if(!Ra.canSupportVersion(a))return void _o.addErrorMessage("ERROR: Unable to load invalid JSON file - invalid version.","errorUpload")}var l=e.graphData,u=Da.parseJSON(l);r.copyGraph(u);var s=e.machineData,c=s.name;c&&n.setMachineName(c);var f=s.type;f&&n.setMachineType(f);var p=s.symbols;if(p){o._symbols.length=0;var h=!0,y=!1,v=void 0;try{for(var d,m=p[Symbol.iterator]();!(h=(d=m.next()).done);h=!0){var b=d.value;o._symbols.push(b)}}catch(e){y=!0,v=e}finally{try{h||null==m.return||m.return()}finally{if(y)throw v}}}var g=s.statePrefix;g&&(o.getLabeler().prefix=g)}catch(e){_o.addErrorMessage("ERROR: Unable to load invalid JSON file.","errorUpload"),console.error(e)}}function Ua(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var za=["application/json",".jff",".xml"],Va=[".json",".jff",".xml"],Ha=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.graphController=t,this.machineController=null}var t,n,r;return t=e,(n=[{key:"setMachineController",value:function(e){this.machineController=e}},{key:"getValidFileTypes",value:function(){return za}},{key:"uploadFileGraph",value:function(e){var t=this;return new Promise(function(n,r){e||r("Invalid file data : null");var o=e.name,i=o.lastIndexOf(".");i<0&&r("Invalid filename : missing file extension");var a=o.substring(i);if(Va.includes(a)){var l=new FileReader;l.onload=function(o){var i=o.target.result,u=e.name.substring(0,e.name.lastIndexOf(".")),s=t.graphController.getGraph();t.graphController.emit("userPreImportGraph",s);try{if(".json"===a)Ga(JSON.parse(i),t.graphController,t.machineController);else if(".jff"===a||".xml"===a){var c=(new DOMParser).parseFromString(i,"text/xml"),f=Da.parseXML(c);s.copyGraph(f)}t.graphController.emit("userImportGraph",s),t.machineController&&t.machineController.setMachineName(u),n({file:i,name:u,graph:s})}catch(e){l.abort(),r(e)}finally{t.graphController.emit("userPostImportGraph",s)}},l.onerror=function(e){r(e.target.error.code)},l.readAsText(e)}else r("Invalid filename : unknown file extension '"+a+"'")})}}])&&Ua(t.prototype,n),r&&Ua(t,r),e}();function Xa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}s.a.EDGE_SYMBOL_SEPARATOR;var Ya=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._module=null,this.inputController=null,this.machineController=null,this.labelEditor=null,this.tester=null,this.uploader=new Ha(this),this.prevQuad={radians:0,length:0,x:0,y:0},this.prevEdgeTo=null,this.prevX=0,this.prevY=0,this.registerEvent("userCreateNode"),this.registerEvent("userPreCreateNode"),this.registerEvent("userPostCreateNode"),this.registerEvent("userToggleNode"),this.registerEvent("userDeleteNodes"),this.registerEvent("userPreDeleteNodes"),this.registerEvent("userPostDeleteNodes"),this.registerEvent("userDeleteEdge"),this.registerEvent("userPreDeleteEdge"),this.registerEvent("userPostDeleteEdge"),this.registerEvent("userCreateEdge"),this.registerEvent("userPostCreateEdge"),this.registerEvent("userSwapNodes"),this.registerEvent("userRenameNode"),this.registerEvent("userChangeLayout"),this.registerEvent("userPreChangeLayout"),this.registerEvent("userPostChangeLayout"),this.registerEvent("userImportGraph"),this.registerEvent("userPreImportGraph"),this.registerEvent("userPostImportGraph"),this.registerEvent("nodeMove"),this.registerEvent("nodeMoveAll"),this.registerEvent("nodeInitial"),this.registerEvent("edgeDestination"),this.registerEvent("edgeMove"),this.registerEvent("edgeLabel"),this.registerEvent("tryCreateWhileTrash")}var t,n,r;return t=e,(n=[{key:"setModule",value:function(e){this._module=e}},{key:"initialize",value:function(e){this.labelEditor=e.viewport.labelEditor,this.tester=e.testingManager,this.inputController=e.inputController,this.machineController=e.machineController,this.uploader.setMachineController(this.machineController)}},{key:"destroy",value:function(){}},{key:"getGraph",value:function(){return this._module.getGraph()}},{key:"getLabelEditor",value:function(){return this.labelEditor}},{key:"getUploader",value:function(){return this.uploader}},{key:"applyAutoLayout",value:function(){this.emit("userPreChangeLayout",this.getGraph()),Yo.applyLayout(this.getGraph()),this.emit("userChangeLayout",this.getGraph()),this.emit("userPostChangeLayout",this.getGraph())}},{key:"renameNode",value:function(e,t){var n=e.getNodeLabel(),r=e.hasCustomLabel();e.setCustomLabel(t),this.emit("userRenameNode",this.getGraph(),e,t,n,r)}},{key:"swapNodeByIndex",value:function(e,t){var n=this.getGraph().nodes[e],r=this.getGraph().nodes[t];this.getGraph().nodes[t]=n,this.getGraph().nodes[e]=r,this.emit("userSwapNodes",this.getGraph(),n,r)}},{key:"createNode",value:function(e,t){var n=this.machineController.getMachineBuilder().getLabeler().getNextDefaultNodeLabel();void 0===e&&(e=Math.random()*s.a.SPAWN_RADIUS*2-s.a.SPAWN_RADIUS),void 0===t&&(t=Math.random()*s.a.SPAWN_RADIUS*2-s.a.SPAWN_RADIUS),this.emit("userPreCreateNode",this.getGraph(),n,e,t);var r=this.getGraph().newNode(e,t,n);return r.x=e,r.y=t,this.emit("userCreateNode",this.getGraph(),r),this.emit("userPostCreateNode",this.getGraph(),r),r}},{key:"toggleNode",value:function(e){var t=e.accept,n=!e.accept;e.accept=n,this.emit("userToggleNode",this.getGraph(),e,t)}},{key:"deleteSelectedNodes",value:function(e){var t=this.inputController.getPicker(),n=t.getSelection(this.getGraph()).slice();this.emit("userPreDeleteNodes",this.getGraph(),e,n,this.prevX,this.prevY);var r=!0,o=!1,i=void 0;try{for(var a,l=n[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;this.getGraph().deleteNode(u)}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}t.clearSelection(),this.emit("userDeleteNodes",this.getGraph(),e,n,this.prevX,this.prevY),this.emit("userPostDeleteNodes",this.getGraph(),e,n,this.prevX,this.prevY)}},{key:"deleteTargetNode",value:function(e){this.emit("userPreDeleteNodes",this.getGraph(),e,[e],this.prevX,this.prevY),this.getGraph().deleteNode(e),this.emit("userDeleteNodes",this.getGraph(),e,[e],this.prevX,this.prevY),this.emit("userPostDeleteNodes",this.getGraph(),e,[e],this.prevX,this.prevY)}},{key:"deleteTargetEdge",value:function(e){this.emit("userPreDeleteEdge",this.getGraph(),e,this.prevEdgeTo,this.prevQuad),this.getGraph().deleteEdge(e),this.emit("userDeleteEdge",this.getGraph(),e,this.prevEdgeTo,this.prevQuad),this.emit("userPostDeleteEdge",this.getGraph(),e,this.prevEdgeTo,this.prevQuad)}},{key:"moveNodeTo",value:function(e,t,n,r){var o=!0,i=!1,a=void 0;try{for(var l,u=this.getGraph().nodes[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(t!==c){var f=n-c.x,p=r-c.y,h=Math.atan2(p,f),y=2*s.a.NODE_RADIUS,v=c.x+Math.cos(h)*y-n,d=c.y+Math.sin(h)*y-r;f*f+p*p<4*s.a.NODE_RADIUS_SQU&&(n+=v,r+=d)}}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}t.x=n,t.y=r}},{key:"moveMultipleNodesTo",value:function(e,t,n,r){var o=e.getInputEventPosition(),i=n-o.x,a=r-o.y,l=!0,u=!1,s=void 0;try{for(var c,f=t[Symbol.iterator]();!(l=(c=f.next()).done);l=!0){var p=c.value;p.x+=i,p.y+=a}}catch(e){u=!0,s=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw s}}e.changeInputEventPosition(n,r)}},{key:"moveEdgeTo",value:function(e,t,n,r){t.setQuadraticByCoords(n,r)}},{key:"moveEndpointTo",value:function(e,t,n,r){var o=this.inputController.getPicker().getNodeAt(this.getGraph(),n,r)||e;if(t.changeDestinationNode(o),t.isSelfLoop()){var i=t.getSourceNode(),a=i.x-n,l=i.y-r,u=Math.atan2(l,a)+Math.PI;t.setQuadratic(u)}else t.setQuadratic(this.prevQuad.radians,this.prevQuad.length)}},{key:"openLabelEditor",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=o||e.getEdgeLabel();this.labelEditor.openEditor(e,o,i,function(){var t=e.getEdgeLabel();l.length>0&&t!=l&&r.emit("edgeLabel",e,t,l),a&&a()})}},{key:"focusOnNode",value:function(e){this.inputController.getViewport().setOffset(-e.x,-e.y)}},{key:"focusOnEdge",value:function(e){var t=e.getCenterPoint();this.inputController.getViewport().setOffset(-t.x,-t.y)}},{key:"focusOnNodes",value:function(e){var t=e.length,n=0,r=0,o=!0,i=!1,a=void 0;try{for(var l,u=e[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var s=l.value;n+=s.x,r+=s.y}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}this.inputController.getViewport().setOffset(-n/t,-r/t)}}])&&Xa(t.prototype,n),r&&Xa(t,r),e}();Ho.mixin(Ya);var Qa=Ya;function Ka(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Wa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._active=!1,this._x=0,this._y=0,this._inputpos={x:0,y:0}}var t,n,r;return t=e,(n=[{key:"setPosition",value:function(e,t){this._x=e,this._y=t}},{key:"beginInput",value:function(){this._active=!0,this._inputpos.x=this._x,this._inputpos.y=this._y}},{key:"getInputEventPosition",value:function(){return this._inputpos}},{key:"changeInputEventPosition",value:function(e,t){this._inputpos.x=e,this._inputpos.y=t}},{key:"endInput",value:function(){this._active=!1}},{key:"isActive",value:function(){return this._active}},{key:"getDistanceSquToInitial",value:function(){var e=this._inputpos,t=e.x-this._x,n=e.y-this._y;return t*t+n*n}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}}])&&Ka(t.prototype,n),r&&Ka(t,r),e}();function Ja(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._controller=null,this._element=null,this._viewport=null,this._cursor={_mousemove:null,_mouseup:null,_touchmove:null,_touchend:null,_timer:null},this._pointer=new Wa,this._dragging=!1,this._altinput=!1,this._holdInputDelay=s.a.LONG_TAP_TICKS,this._dblInputDelay=s.a.DOUBLE_TAP_TICKS,this._scrollSensitivity=s.a.SCROLL_SENSITIVITY,this._minTapRadius=16*s.a.CURSOR_RADIUS_SQU,this._draggingRadiusSqu=s.a.CURSOR_RADIUS_SQU+s.a.DRAGGING_BUFFER_SQU,this._prevEmptyInput=!1,this._prevEmptyTime=0,this._prevEmptyX=0,this._prevEmptyY=0,this.onContextMenu=this.onContextMenu.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onWheel=this.onWheel.bind(this),this.onMouseDownThenMove=this.onMouseDownThenMove.bind(this),this.onMouseDownThenUp=this.onMouseDownThenUp.bind(this),this.onTouchStartThenMove=this.onTouchStartThenMove.bind(this),this.onTouchStartThenEnd=this.onTouchStartThenEnd.bind(this),this.onDelayedInputDown=this.onDelayedInputDown.bind(this)}var t,n,r;return t=e,(n=[{key:"setController",value:function(e){return this._controller=e,this}},{key:"initialize",value:function(e,t){if(!(e instanceof SVGElement))throw new Error("Invalid SVG element for InputAdapter");if(!t)throw new Error("Missing viewport for InputAdapter");if(t.getElement()!=e)throw new Error("Mismatched viewport for passed-in element");if(this._element)throw new Error("Trying to initialize an InputAdapter already initialized");this._element=e,this._viewport=t,this._element.addEventListener("mousedown",this.onMouseDown),this._element.addEventListener("mousemove",this.onMouseMove),this._element.addEventListener("touchstart",this.onTouchStart),this._element.addEventListener("touchmove",this.onTouchMove),this._element.addEventListener("contextmenu",this.onContextMenu),this._element.addEventListener("wheel",this.onWheel)}},{key:"destroy",value:function(){if(!this._element)throw new Error("Trying to destroy an InputAdapter that is not yet initialized");this._element.removeEventListener("mousedown",this.onMouseDown),this._element.removeEventListener("mousemove",this.onMouseMove),this._element.removeEventListener("touchstart",this.onTouchStart),this._element.removeEventListener("contextmenu",this.onContextMenu),this._element.removeEventListener("wheel",this.onWheel),this._element=null}},{key:"onMouseDown",value:function(e){if(!this._controller)return!1;e.stopPropagation(),e.preventDefault();var t=this._cursor;document.activeElement.blur(),this._element.focus(),t._mousemove&&(document.removeEventListener("mousemove",t._mousemove),t._mousemove=null),t._mouseup&&(document.removeEventListener("mouseup",t._mouseup),t._mouseup=null);var n=e.ctrlKey?2:e.button;return this.onInputDown(e.clientX,e.clientY,n)&&(t._mousemove=this.onMouseDownThenMove,t._mouseup=this.onMouseDownThenUp,document.addEventListener("mousemove",t._mousemove),document.addEventListener("mouseup",t._mouseup)),!1}},{key:"onMouseMove",value:function(e){if(!this._controller)return!1;var t=this._viewport.transformScreenToView(e.clientX,e.clientY);this._pointer.setPosition(t.x,t.y)}},{key:"onMouseDownThenMove",value:function(e){return!!this._controller&&(e.stopPropagation(),e.preventDefault(),this.onInputMove(e.clientX,e.clientY),!1)}},{key:"onMouseDownThenUp",value:function(e){if(!this._controller)return!1;e.stopPropagation(),e.preventDefault();var t=this._cursor;return t._mousemove&&(document.removeEventListener("mousemove",t._mousemove),t._mousemove=null),t._mouseup&&(document.removeEventListener("mouseup",t._mouseup),t._mouseup=null),this.onInputUp(e.clientX,e.clientY),!1}},{key:"onTouchStart",value:function(e){if(!this._controller)return!1;if(1==e.changedTouches.length){e.stopPropagation(),e.preventDefault();var t=this._cursor;document.activeElement.blur(),this._element.focus(),t._touchmove&&(document.removeEventListener("touchmove",t._touchmove),t._touchmove=null),t._touchend&&(document.removeEventListener("touchend",t._touchend),t._touchend=null);var n=e.changedTouches[0];return this.onInputDown(n.clientX,n.clientY,0)&&(t._touchmove=this.onTouchStartThenMove,t._touchend=this.onTouchStartThenEnd,document.addEventListener("touchmove",t._touchmove),document.addEventListener("touchend",t._touchend)),!1}}},{key:"onTouchStartThenEnd",value:function(e){if(!this._controller)return!1;e.stopPropagation(),e.preventDefault();var t=this._cursor;t._touchmove&&(document.removeEventListener("touchmove",t._touchmove),t._touchmove=null),t._touchend&&(document.removeEventListener("touchend",t._touchend),t._touchend=null);var n=e.changedTouches[0];return this.onInputUp(n.clientX,n.clientY),!1}},{key:"onTouchStartThenMove",value:function(e){if(!this._controller)return!1;e.stopPropagation(),e.preventDefault();var t=e.changedTouches[0];return this.onInputMove(t.clientX,t.clientY),!1}},{key:"onContextMenu",value:function(e){return!!this._controller&&(e.stopPropagation(),e.preventDefault(),!1)}},{key:"onWheel",value:function(e){if(!this._controller)return!1;e.stopPropagation(),e.preventDefault();var t=this._controller,n=this._pointer,r=e.deltaY*this._scrollSensitivity,o=this._viewport.getScale(),i=o+r;return t.onZoomChange(n,i,o)&&this._viewport.setScale(i),!1}},{key:"onInputDown",value:function(e,t,n){if(!this._controller)throw new Error("Missing controller for input adapter");var r=this._cursor,o=this._controller,i=this._pointer,a=this._viewport.transformScreenToView(e,t);return i.setPosition(a.x,a.y),this._dragging=!1,this._altinput=2==n,!o.onPreInputEvent(i)&&(i.beginInput(),r._timer=setTimeout(this.onDelayedInputDown,this._holdInputDelay),!0)}},{key:"onDelayedInputDown",value:function(){if(!this._controller)throw new Error("Missing controller for input adapter");this._dragging||(this._altinput=!0)}},{key:"onInputMove",value:function(e,t){if(!this._controller)throw new Error("Missing controller for input adapter");var n=this._controller,r=this._pointer,o=this._viewport.transformScreenToView(e,t);r.setPosition(o.x,o.y),this._dragging?n.onDragMove(r):r.getDistanceSquToInitial()>this._draggingRadiusSqu&&(this._dragging=!0,n.onDragStart(r)||(this._dragging=!1,this.cancelInputEvent()))}},{key:"onInputUp",value:function(e,t){if(!this._controller)throw new Error("Missing controller for input adapter");var n=this._cursor,r=n._timer;r&&(clearTimeout(r),n._timer=null);var o=this._controller,i=this._pointer,a=this._viewport.transformScreenToView(e,t);if(i.setPosition(a.x,a.y),this._dragging)o.onDragStop(i);else if(this._altinput)o.onAltInputEvent(i);else if(!o.onInputEvent(i)){var l=e-this._prevEmptyX,u=t-this._prevEmptyY,s=l*l+u*u,c=Date.now()-this._prevEmptyTime;this._prevEmptyInput&&s<this._minTapRadius&&c<this._dblInputDelay?(o.onDblInputEvent(i),this._prevEmptyInput=!1):(this._prevEmptyInput=!0,this._prevEmptyTime=Date.now(),this._prevEmptyX=e,this._prevEmptyY=t)}i.endInput(),o.onPostInputEvent(i)}},{key:"cancelInputEvent",value:function(){var e=this._controller,t=this._pointer,n=this._cursor;n._mousemove&&(document.removeEventListener("mousemove",n._mousemove),n._mousemove=null),n._mouseup&&(document.removeEventListener("mouseup",n._mouseup),n._mouseup=null);var r=n._timer;r&&(clearTimeout(r),n._timer=null),t.endInput(),e.onPostInputEvent(t)}},{key:"getActiveElement",value:function(){return this._element}},{key:"getActiveViewport",value:function(){return this._viewport}},{key:"getPointer",value:function(){return this._pointer}},{key:"isUsingTouch",value:function(){return this._cursor._touchmove||this._cursor._touchend}},{key:"isAltInput",value:function(){return this._altinput}},{key:"isDragging",value:function(){return this._dragging}}])&&Ja(t.prototype,n),r&&Ja(t,r),e}();function Za(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._element=null,this._offsetX=0,this._offsetY=0,this._nextOffsetX=0,this._nextOffsetY=0,this._offsetDamping=.1,this._scaleFactor=1,this._minScale=1,this._maxScale=1}var t,n,r;return t=e,(n=[{key:"setElement",value:function(e){return this._element=e,this}},{key:"setMinScale",value:function(e){return this._minScale=e,this._scaleFactor<this._minScale&&(this._scaleFactor=this._minScale),this}},{key:"setMaxScale",value:function(e){return this._maxScale=e,this._scaleFactor>this._maxScale&&(this._scaleFactor=this._maxScale),this}},{key:"setOffsetDamping",value:function(e){return this._offsetDamping=e,this}},{key:"update",value:function(){var e=this._nextOffsetX-this._offsetX;this._offsetX+=e*this._offsetDamping;var t=this._nextOffsetY-this._offsetY;this._offsetY+=t*this._offsetDamping}},{key:"transformScreenToView",value:function(e,t){if(!this._element)return{x:e-this._offsetX,y:t-this._offsetY};var n=this._element.getScreenCTM();return{x:(e-n.e)/n.a-this._offsetX,y:(t-n.f)/n.d-this._offsetY}}},{key:"setOffset",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?(this._nextOffsetX=this._offsetX=e,this._nextOffsetY=this._offsetY=t):(this._nextOffsetX=e,this._nextOffsetY=t)}},{key:"addOffset",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?(this._offsetX+=e,this._offsetY+=t,this._nextOffsetX=this._offsetX,this._nextOffsetY=this._offsetY):(this._nextOffsetX+=e,this._nextOffsetY+=t)}},{key:"setScale",value:function(e){this._scaleFactor=Math.min(this._maxScale,Math.max(this._minScale,e))}},{key:"addScale",value:function(e){this._scaleFactor+=e,this._scaleFactor>this._maxScale?this._scaleFactor=this._maxScale:this._scaleFactor<this._minScale&&(this._scaleFactor=this._minScale)}},{key:"getOffsetX",value:function(){return this._offsetX}},{key:"getOffsetY",value:function(){return this._offsetY}},{key:"getOffsetDamping",value:function(){return this._offsetDamping}},{key:"getScale",value:function(){return this._scaleFactor}},{key:"getMinScale",value:function(){return this._minScale}},{key:"getMaxScale",value:function(){return this._maxScale}},{key:"getElement",value:function(){return this._element}}])&&Za(t.prototype,n),r&&Za(t,r),e}();function el(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var tl=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selectionBox={fromX:0,fromY:0,toX:0,toY:0,visible:!1},this.targets=[],this.target=null,this.targetType="",this.initialTarget=null,this.initialTargetType=""}var t,n,r;return t=e,(n=[{key:"setInitialTarget",value:function(e,t){this.initialTarget=e,this.initialTargetType=t}},{key:"updateTarget",value:function(e,t,n){return(this.target=this.getNodeByInitialMarkerAt(e,t,n))?this.targetType="initial":(this.target=this.getEdgeByEndPointAt(e,t,n))?this.targetType="endpoint":(this.target=this.getNodeAt(e,t,n))?this.targetType="node":(this.target=this.getEdgeAt(e,t,n))?this.targetType="edge":(this.target=null,this.targetType="none"),this.target}},{key:"clearTarget",value:function(){this.target=null,this.targetType="none"}},{key:"hasTarget",value:function(){return null!=this.target}},{key:"getNodeAt",value:function(e,t,n){var r=!0,o=!1,i=void 0;try{for(var a,l=e.nodes[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value,c=t-u.x,f=n-u.y;if(c*c+f*f<s.a.NODE_RADIUS_SQU)return u}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return null}},{key:"getNodeByInitialMarkerAt",value:function(e,t,n){var r=e.getStartNode();if(!r)return null;var o=t-(r.x+s.a.INITIAL_MARKER_OFFSET_X),i=n-r.y;return o*o+i*i<s.a.EDGE_RADIUS_SQU?r:null}},{key:"getEdgeAt",value:function(e,t,n){var r={x:0,y:0},o=!0,i=!1,a=void 0;try{for(var l,u=e.edges[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;c.getCenterPoint(r);var f=t-r.x,p=n-r.y;if(f*f+p*p<s.a.EDGE_RADIUS_SQU)return c}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}return null}},{key:"getEdgeByEndPointAt",value:function(e,t,n){var r={x:0,y:0},o=!0,i=!1,a=void 0;try{for(var l,u=e.edges[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;c.getEndPoint(r);var f=t-r.x,p=n-r.y;if(f*f+p*p<s.a.ENDPOINT_RADIUS_SQU)return c}}catch(e){i=!0,a=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw a}}return null}},{key:"getSelectionBox",value:function(){return this.selectionBox}},{key:"getSelection",value:function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){var t=this.selectionBox,n=Math.max(t.toX,t.fromX),r=Math.max(t.toY,t.fromY),o=Math.min(t.toX,t.fromX),i=Math.min(t.toY,t.fromY);this.clearSelection(),function(e,t,n,r,o,i){var a=Math.min(t,r),l=Math.min(n,o),u=Math.max(t,r),s=Math.max(n,o),c=!0,f=!1,p=void 0;try{for(var h,y=e.nodes[Symbol.iterator]();!(c=(h=y.next()).done);c=!0){var v=h.value;v.x>=a&&v.x<u&&v.y>=l&&v.y<s&&i.push(v)}}catch(e){f=!0,p=e}finally{try{c||null==y.return||y.return()}finally{if(f)throw p}}}(e,o,i,n,r,this.targets)}return this.targets}},{key:"hasSelection",value:function(){return this.targets.length>0}},{key:"clearSelection",value:function(){this.targets.length=0}},{key:"isTargetInSelection",value:function(e){return this.targets.includes(e||this.target)}},{key:"isTarget",value:function(e){return this.target==e}},{key:"beginSelection",value:function(e,t,n){var r=this.selectionBox;r.fromX=r.toX=t,r.fromY=r.toY=n,this.clearSelection(),r.visible=!0}},{key:"updateSelection",value:function(e,t,n){var r=this.selectionBox;r.toX=t,r.toY=n,this.getSelection(e,!0)}},{key:"endSelection",value:function(e,t,n){var r=this.selectionBox;r.toX=t,r.toY=n,this.getSelection(e,!0),r.visible=!1}},{key:"isSelecting",value:function(){return this.selectionBox.visible}}])&&el(t.prototype,n),r&&el(t,r),e}();function nl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}s.a.EDGE_SYMBOL_SEPARATOR;var rl=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._module=null,this._viewport=(new $a).setMinScale(s.a.MIN_SCALE).setMaxScale(s.a.MAX_SCALE).setOffsetDamping(s.a.SMOOTH_OFFSET_DAMPING),this._inputAdapter=(new qa).setController(this),this._picker=new tl,this._graphController=null,this.prevPointerX=0,this.prevPointerY=0,this.isNewEdge=!1,this.ghostInitialMarker=null,this.shouldDestroyPointlessEdges=s.a.DEFAULT_SHOULD_DESTROY_POINTLESS_EDGE,this._swapMouseScheme=!0,//!navigator.platform.startsWith("Mac");
this._trashMode=!1}var t,n,r;return t=e,(n=[{key:"setModule",value:function(e){this._module=e}},{key:"initialize",value:function(e){var t=e.workspace.ref;this._viewport.setElement(t),this._graphController=e.graphController,this._inputAdapter.initialize(t,this._viewport)}},{key:"destroy",value:function(){this._inputAdapter.destroy()}},{key:"update",value:function(){this._viewport.update();var e=this._graphController.getGraph(),t=this._inputAdapter.getPointer(),n=this._picker,r=t.x,o=t.y;r==this.prevPointerX&&o==this.prevPointerY||(this.prevPointerX=r,this.prevPointerY=o,n.updateTarget(e,r,o),n.hasTarget()?document.body.style.cursor="pointer":document.body.style.cursor="auto")}},{key:"onPreInputEvent",value:function(e){var t=this._graphController,n=t.getGraph(),r=this.getPicker();r.updateTarget(n,e.x,e.y),r.setInitialTarget(r.target,r.targetType);var o=r.initialTarget,i=r.initialTargetType;return r.hasSelection()&&("node"==i&&r.isTargetInSelection(o)||r.clearSelection()),!!t.tester.getStepByStepMode()}},{key:"onInputEvent",value:function(e){var t=this._graphController,n=e.x,r=e.y,o=t.getGraph(),i=this.getPicker();i.updateTarget(o,n,r);var a=i.initialTarget,l=i.initialTargetType;return this.isTrashMode()?"node"===l?(t.prevX=a.x,t.prevY=a.y,i.hasSelection()?t.deleteSelectedNodes(a):t.deleteTargetNode(a),!0):("edge"===l||"endpoint"===l)&&(t.deleteTargetEdge(a),!0):"node"===l?(t.toggleNode(a),!0):"edge"===l&&(t.openLabelEditor(a,n,r),!0)}},{key:"onAltInputEvent",value:function(e){return this.onInputEvent(e)}},{key:"onDblInputEvent",value:function(e){var t=this._graphController,n=e.x,r=e.y;return this.isTrashMode()?(t.emit("tryCreateWhileTrash"),!0):(t.createNode(n,r),!0)}},{key:"onDragStart",value:function(e){var t=this._graphController,n=t.getGraph(),r=this.getPicker(),o=e.x,i=e.y,a=r.initialTarget,l=r.initialTargetType;this.getViewport();if(this.isMoveMode()){if(this.isTrashMode())return t.emit("tryCreateWhileTrash"),!1;if(this.isNewEdge=!1,"edge"===l&&a.isPlaceholder())return!1;if("node"===l){if(!(a instanceof li))throw new Error("Invalid target "+a+" for type '"+l+"'. Must be an instance of Node.");return t.prevX=a.x,t.prevY=a.y,!0}if("edge"===l){if(!(a instanceof Pi))throw new Error("Invalid target "+a+" for type '"+l+"'. Must be an instance of Edge.");if(a.isPlaceholder())return!1;var u=a.getQuadratic();return t.prevQuad.radians=u.radians,t.prevQuad.length=u.length,!0}if("initial"===l)return this.ghostInitialMarker=e,!0;if("none"===l)return t.prevX=o,t.prevY=i,!0}else{if("node"===l){if(this.isTrashMode())return t.emit("tryCreateWhileTrash"),!1;var c=n.newEdge(a,e,s.a.STR_TRANSITION_DEFAULT_LABEL);r.setInitialTarget(c,"endpoint"),this.isNewEdge=!0;var f=c.getQuadratic();return t.prevQuad.radians=f.radians,t.prevQuad.length=f.length,!0}if("edge"==l)return!1;if("none"===l)return r.beginSelection(n,o,i),!0}if("endpoint"===l){if(!(a instanceof Pi))throw new Error("Invalid target "+a+" for type '"+l+"'. Must be an instance of Edge.");var p=a.getQuadratic();return t.prevQuad.radians=p.radians,t.prevQuad.length=p.length,t.prevEdgeTo=a.getDestinationNode(),this.isNewEdge=!this.isMoveMode(),!0}return!1}},{key:"onDragMove",value:function(e){var t=this._graphController,n=t.getGraph(),r=this.getPicker(),o=e.x,i=e.y,a=r.initialTarget,l=r.initialTargetType;if(this.isMoveMode()){if("node"===l)return r.hasSelection()?t.moveMultipleNodesTo(e,r.getSelection(n),o,i):t.moveNodeTo(e,a,o,i),!0;if("edge"===l)return t.moveEdgeTo(e,a,o,i),!0;if("endpoint"===l)return t.moveEndpointTo(e,a,o,i),!0;if("initial"===l){var u=r.getNodeAt(n,o,i)||e;return this.ghostInitialMarker=u,!0}if("none"===l){var s=o-t.prevX,c=i-t.prevY;return this.getViewport().addOffset(s,c,!0),!0}throw new Error("Unknown target type '"+l+"'.")}return this.isNewEdge?(t.moveEndpointTo(e,a,o,i),!0):r.isSelecting()?(r.updateSelection(n,o,i),!0):void 0}},{key:"onDragStop",value:function(e){var t=this._graphController,n=t.getGraph(),r=this.getPicker(),o=e.x,i=e.y;r.updateTarget(n,o,i);var a=r.initialTarget,l=r.initialTargetType;if(this.isMoveMode()||this.isNewEdge){if("node"===l){if(this.isTrashMode())return r.hasSelection()?t.deleteSelectedNodes(a):t.deleteTargetNode(a),!0;if(r.hasSelection()){var u=o-t.prevX,s=i-t.prevY;t.emit("nodeMoveAll",r.getSelection(n),u,s)}else t.emit("nodeMove",a,o,i,t.prevX,t.prevY);return!0}if("edge"===l)return this.isTrashMode()?t.deleteTargetEdge(a):t.emit("edgeMove",a,a.getQuadratic(),t.prevQuad),!0;if(this.isNewEdge||"endpoint"===l){if(this.isTrashMode())return t.deleteTargetEdge(a),!0;if(a.getDestinationNode()instanceof li){var c=n.formatEdge(a);return c!==a?(t.openLabelEditor(c,o,i,c.getEdgeLabel(),!1),n.deleteEdge(a),!0):(this.isNewEdge?t.openLabelEditor(a,o,i,null,!0,function(){t.emit("userPostCreateEdge",n,a)}):t.openLabelEditor(a,o,i),this.isNewEdge?(this.isNewEdge=!1,t.emit("userCreateEdge",n,a)):null!==t.prevEdgeTo&&t.emit("edgeDestination",a,a.getDestinationNode(),t.prevEdgeTo,t.prevQuad),!0)}return this.shouldDestroyPointlessEdges?(n.deleteEdge(a),!0):(a.changeDestinationNode(null),a.getEdgeLabel().length<=0&&t.openLabelEditor(a,o,i),!0)}if("initial"===l){if(this.ghostInitialMarker instanceof li){var f=n.getStartNode();n.setStartNode(this.ghostInitialMarker),t.emit("nodeInitial",this.ghostInitialMarker,f)}return this.ghostInitialMarker=null,!0}if("none"===l)return!0;throw new Error("Unknown target type '"+l+"'.")}return!!r.isSelecting()&&(r.endSelection(n,o,i),!0)}},{key:"onPostInputEvent",value:function(e){var t=this._graphController.getGraph(),n=this.getPicker();n.clearTarget(),n.updateTarget(t,e.x,e.y)}},{key:"onZoomChange",value:function(e,t,n){return!0}},{key:"getViewport",value:function(){return this._viewport}},{key:"setTrashMode",value:function(e){this._trashMode=e}},{key:"isTrashMode",value:function(){return this._trashMode}},{key:"setInputScheme",value:function(e){this._swapMouseScheme=!e}},{key:"getInputScheme",value:function(){return this._swapMouseScheme}},{key:"isMoveMode",value:function(){var e=this._inputAdapter.isAltInput();return this._swapMouseScheme?!e:e}},{key:"isDragging",value:function(){return this._inputAdapter.isDragging()}},{key:"isActionMode",value:function(e){return this._inputAdapter.getPointer().isActive()?e.isNewEdge||!this.isMoveMode():!this._swapMouseScheme}},{key:"getPicker",value:function(){return this._picker}},{key:"getAdapter",value:function(){return this._inputAdapter}}])&&nl(t.prototype,n),r&&nl(t,r),e}();function ol(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var il=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.workspace=null,this.toolbar=null,this.events=null,this.graphController=null,this.machineController=null,this.onKeyDown=this.onKeyDown.bind(this)}var t,n,r;return t=e,(n=[{key:"initialize",value:function(e){this.workspace=e.workspace,this.toolbar=e.toolbar,this.events=e.eventManager,this.graphController=e.graphController,this.machineController=e.machineController,window.addEventListener("keydown",this.onKeyDown)}},{key:"destroy",value:function(){window.removeEventListener("keydown",this.onKeyDown)}},{key:"onKeyDown",value:function(e){if(83==event.which&&(event.metaKey||event.ctrlKey)){var t=JSON.stringify(Fa(this.graphController,this.machineController)),n=this.machineController.getMachineName();Tn.downloadText(n+".json",t),e.preventDefault(),e.stopPropagation()}else if(90==event.which&&(event.metaKey||event.ctrlKey))event.shiftKey?this.events.getLogger().redo():this.events.getLogger().undo(),e.preventDefault(),e.stopPropagation();else if(80==event.which&&(event.metaKey||event.ctrlKey)){var r=this.workspace.ref.viewBox.baseVal,o=r.width,i=r.height,a=this.workspace.getSVGForExport(o,i);Tn.downloadSVG(this.machineController.getMachineName(),"png",a,o,i),e.preventDefault(),e.stopPropagation()}}}])&&ol(t.prototype,n),r&&ol(t,r),e}();function al(e){return(al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ll(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ul=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._handlers=new Set,this._intervalID=null,this._intervalMillis=1e3,this._init=!1,this.onIntervalUpdate=this.onIntervalUpdate.bind(this)}var t,n,r;return t=e,(n=[{key:"setAutoSaveInterval",value:function(e){if(!e||e<=0)throw new Error("AutoSave interval must be greater than 0");this._intervalMillis=e}},{key:"registerHandler",value:function(e){if(this._handlers.has(e))throw new Error("Cannot register handler, since it is already registered");this._handlers.add(e)}},{key:"unregisterHandler",value:function(e){if(!this._handlers.has(e))throw new Error("Cannot remove handler, since it is not yet registered");this._handlers.delete(e)}},{key:"initialize",value:function(){if(this._init)throw new Error("Cannot initialize LocalSave, since it is already initialized");this.doesSupportLocalStorage()&&(this._intervalID=setInterval(this.onIntervalUpdate,this._intervalMillis),this._init=!0)}},{key:"terminate",value:function(){if(!this._init)throw new Error("Cannot terminate LocalSave, since it is not yet initialized");clearInterval(this._intervalID),this._handlers.clear(),this._init=!1}},{key:"onIntervalUpdate",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this._handlers[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;try{i.onAutoSave()}catch(e){console.error(e)}}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}},{key:"setStringToStorage",value:function(e,t){this.doesSupportLocalStorage()&&(t.length>0?localStorage.setItem(e,t):localStorage.removeItem(e))}},{key:"getStringFromStorage",value:function(e){return this.doesSupportLocalStorage()&&localStorage.getItem(e)||""}},{key:"loadFromStorage",value:function(e){if(!this.doesSupportLocalStorage())return null;try{var t=localStorage.getItem(e);return t&&t.length>0?JSON.parse(t):null}catch(e){return console.error(e),{}}}},{key:"saveToStorage",value:function(e,t){var n;if(this.doesSupportLocalStorage()&&(void 0!==document.hidden?(n="hidden","visibilitychange"):void 0!==document.msHidden?(n="msHidden","msvisibilitychange"):void 0!==document.webkitHidden&&(n="webkitHidden","webkitvisibilitychange"),!document[n]))try{if("object"==al(t)){var r=t;if(r)for(var o in r=!1,t)if(t.hasOwnProperty(o)){r=!0;break}r?localStorage.setItem(e,JSON.stringify(t)):localStorage.removeItem(e)}else if("string"==typeof t){t.length<=0?localStorage.setItem(e,t):localStorage.removeItem(e)}}catch(e){console.error(e)}}},{key:"existsInStorage",value:function(e){return!!this.doesSupportLocalStorage()&&null!=localStorage.getItem(e)}},{key:"clearStorage",value:function(){this.doesSupportLocalStorage()&&localStorage.clear()}},{key:"doesSupportLocalStorage",value:function(){return"undefined"!=typeof Storage}}])&&ll(t.prototype,n),r&&ll(t,r),e}());n(63);function sl(e){return(sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fl(e){return(fl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pl(e,t){return(pl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var yl=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=fl(t).call(this,e))||"object"!==sl(o)&&"function"!=typeof o?hl(r):o).onUploadFileChange=n.onUploadFileChange.bind(hl(hl(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pl(e,t)}(t,o.a.Component),n=t,(r=[{key:"onUploadFileChange",value:function(e){var t=e.target.files;t.length>0&&(this.props.graphController.getUploader().uploadFileGraph(t[0]),e.target.value="")}},{key:"render",value:function(){var e=this.props.id+"-input";return o.a.createElement("button",{className:"icon-button button-upload "+this.props.className,id:this.props.id,title:this.props.title,style:this.props.style,disabled:this.props.disabled,onClick:this.props.onClick},o.a.createElement("input",{id:e,type:"file",name:"import",style:{display:"none"},onChange:this.onUploadFileChange,accept:this.props.graphController.getUploader().getValidFileTypes().join(",")}),o.a.createElement("label",{htmlFor:e},this.props.children))}}])&&cl(n.prototype,r),i&&cl(n,i),t}();function vl(e){return(vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ml(e){return(ml=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bl(e,t){return(bl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var wl=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=ml(t).call(this,e))||"object"!==vl(o)&&"function"!=typeof o?gl(r):o).onClick=n.onClick.bind(gl(gl(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bl(e,t)}(t,o.a.Component),n=t,(r=[{key:"onClick",value:function(e){_o.hasMessages()?(_o.addMessage(I18N.toString("message.help.3")),_o.addMessage(I18N.toString("message.help.1"))):_o.addMessage(I18N.toString("message.help.2"));window.open("https://github.com/flapjs/FLAPJS-WebApp/blob/master/HELP.md","_blank");this.props.onClick&&this.props.onClick(e)}},{key:"render",value:function(){return o.a.createElement("button",{className:"icon-button button-help "+this.props.className,id:this.props.id,title:this.props.title,style:this.props.style,disabled:this.props.disabled,onClick:this.onClick},this.props.children)}}])&&dl(n.prototype,r),i&&dl(n,i),t}();function El(e){return(El="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _l(e){return(_l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ol(e,t){return(Ol=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Cl=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=_l(t).call(this,e))||"object"!==El(o)&&"function"!=typeof o?kl(r):o).state={value:null},n.onKeyDown=n.onKeyDown.bind(kl(kl(n))),n.onChange=n.onChange.bind(kl(kl(n))),n.onFocus=n.onFocus.bind(kl(kl(n))),n.onBlur=n.onBlur.bind(kl(kl(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ol(e,t)}(t,o.a.Component),n=t,(r=[{key:"onChange",value:function(e){this.setState({value:e.target.value})}},{key:"onKeyDown",value:function(e){if("Escape"===e.key){var t=e.target;return this.setState({value:null},function(){return t.blur()}),!1}if("Enter"===e.key)return e.target.blur(),!1}},{key:"onFocus",value:function(e){this.setState({value:this.props.value})}},{key:"onBlur",value:function(e){this.state.value&&this.props.onSubmit&&this.props.onSubmit({value:this.state.value}),this.setState({value:null})}},{key:"render",value:function(){return o.a.createElement("input",{type:"text",className:this.props.className,id:this.props.id,value:null!=this.state.value?this.state.value:this.props.value,onChange:this.onChange,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur})}}])&&Sl(n.prototype,r),i&&Sl(n,i),t}();function xl(e){return(xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pl(e,t){return!t||"object"!==xl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jl(e){return(jl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tl(e,t){return(Tl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ml=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Pl(this,jl(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tl(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"pagenew-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 2zm-3-7V3.5L18.5 9H13z"}))}}])&&Nl(n.prototype,r),i&&Nl(n,i),t}();function Dl(e){return(Dl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Il(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ll(e,t){return!t||"object"!==Dl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Al(e){return(Al=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rl(e,t){return(Rl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Bl=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ll(this,Al(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rl(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"help-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"}))}}])&&Il(n.prototype,r),i&&Il(n,i),t}();function Fl(e){return(Fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ul(e,t){return!t||"object"!==Fl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zl(e){return(zl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vl(e,t){return(Vl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Hl=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ul(this,zl(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vl(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"language-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"}))}}])&&Gl(n.prototype,r),i&&Gl(n,i),t}();function Xl(e){return(Xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ql(e,t){return!t||"object"!==Xl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kl(e){return(Kl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wl(e,t){return(Wl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Jl=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ql(this,Kl(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wl(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"offline-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),o.a.createElement("path",{d:"M12 2.02c-5.51 0-9.98 4.47-9.98 9.98s4.47 9.98 9.98 9.98 9.98-4.47 9.98-9.98S17.51 2.02 12 2.02zM11.48 20v-6.26H8L13 4v6.26h3.35L11.48 20z"}))}}])&&Yl(n.prototype,r),i&&Yl(n,i),t}();function ql(e){return(ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $l(e,t){return!t||"object"!==ql(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eu(e){return(eu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tu(e,t){return(tu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nu=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),$l(this,eu(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tu(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"bugreport-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M20 8h-2.81c-.45-.78-1.07-1.45-1.82-1.96L17 4.41 15.59 3l-2.17 2.17C12.96 5.06 12.49 5 12 5s-.96.06-1.41.17L8.41 3 7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20V8zm-4 4v3c0 .22-.03.47-.07.7l-.1.65-.37.65c-.72 1.24-2.04 2-3.46 2s-2.74-.77-3.46-2l-.37-.64-.1-.65C8.03 15.48 8 15.23 8 15v-4c0-.23.03-.48.07-.7l.1-.65.37-.65c.3-.52.72-.97 1.21-1.31l.57-.39.74-.18c.31-.08.63-.12.94-.12.32 0 .63.04.95.12l.68.16.61.42c.5.34.91.78 1.21 1.31l.38.65.1.65c.04.22.07.47.07.69v1zm-6 2h4v2h-4zm0-4h4v2h-4z"}))}}])&&Zl(n.prototype,r),i&&Zl(n,i),t}();n(65),n(67);function ru(e){return(ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ou(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iu(e){return(iu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function au(e,t){return(au=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var uu=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=iu(t).call(this,e))||"object"!==ru(o)&&"function"!=typeof o?lu(r):o).onClick=n.onClick.bind(lu(lu(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&au(e,t)}(t,o.a.Component),n=t,(r=[{key:"onClick",value:function(e){var t=this.props.app;t.state.isFullscreen?t.setState({isFullscreen:!1}):t.state.isOpen?t.closeDrawer():t.openDrawer()}},{key:"render",value:function(){var e=this.props.app.state.isOpen;return o.a.createElement("div",{className:"drawer-expand"+(e?" open":""),onClick:this.onClick},o.a.createElement("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("path",{d:"M5 3.737l12.395 8.263-12.395 8.263v-16.526zm-2-3.737v24l18-12-18-12z"})))}}])&&ou(n.prototype,r),i&&ou(n,i),t}();n(17),n(70);function su(e){return(su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fu(e,t){return!t||"object"!==su(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pu(e){return(pu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hu(e,t){return(hu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yu=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),fu(this,pu(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hu(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"png-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 56 56"},o.a.createElement("g",null,o.a.createElement("path",{fill:"#E9E9E0",d:"M36.985,0H7.963C7.155,0,6.5,0.655,6.5,1.926V55c0,0.345,0.655,1,1.463,1h40.074 c0.808,0,1.463-0.655,1.463-1V12.978c0-0.696-0.093-0.92-0.257-1.085L37.607,0.257C37.442,0.093,37.218,0,36.985,0z"}),o.a.createElement("path",{fill:"#659C35",d:"M48.037,56H7.963C7.155,56,6.5,55.345,6.5,54.537V39h43v15.537C49.5,55.345,48.845,56,48.037,56z"}),o.a.createElement("polygon",{fill:"#D9D7CA",points:"37.5,0.151 37.5,12 49.349,12 \t"}),o.a.createElement("g",null,o.a.createElement("path",{fill:"#FFFFFF",d:"M17.385,53h-1.641V42.924h2.898c0.428,0,0.852,0.068,1.271,0.205 c0.419,0.137,0.795,0.342,1.128,0.615c0.333,0.273,0.602,0.604,0.807,0.991s0.308,0.822,0.308,1.306 c0,0.511-0.087,0.973-0.26,1.388c-0.173,0.415-0.415,0.764-0.725,1.046c-0.31,0.282-0.684,0.501-1.121,0.656 s-0.921,0.232-1.449,0.232h-1.217V53z M17.385,44.168v3.992h1.504c0.2,0,0.398-0.034,0.595-0.103 c0.196-0.068,0.376-0.18,0.54-0.335c0.164-0.155,0.296-0.371,0.396-0.649c0.1-0.278,0.15-0.622,0.15-1.032 c0-0.164-0.023-0.354-0.068-0.567c-0.046-0.214-0.139-0.419-0.28-0.615c-0.142-0.196-0.34-0.36-0.595-0.492 c-0.255-0.132-0.593-0.198-1.012-0.198H17.385z"}),o.a.createElement("path",{fill:"#FFFFFF",d:"M31.316,42.924V53h-1.668l-3.951-6.945V53h-1.668V42.924h1.668l3.951,6.945v-6.945H31.316z"}),o.a.createElement("path",{fill:"#FFFFFF",d:"M41.16,47.805v3.896c-0.21,0.265-0.444,0.48-0.704,0.649s-0.533,0.308-0.82,0.417 S39.052,52.954,38.747,53c-0.306,0.046-0.608,0.068-0.909,0.068c-0.602,0-1.155-0.109-1.661-0.328s-0.948-0.542-1.326-0.971 c-0.378-0.429-0.675-0.966-0.889-1.613c-0.214-0.647-0.321-1.395-0.321-2.242s0.107-1.593,0.321-2.235 c0.214-0.643,0.51-1.178,0.889-1.606c0.378-0.429,0.822-0.754,1.333-0.978c0.51-0.224,1.062-0.335,1.654-0.335 c0.547,0,1.057,0.091,1.531,0.273c0.474,0.183,0.897,0.456,1.271,0.82l-1.135,1.012c-0.219-0.265-0.47-0.456-0.752-0.574 c-0.283-0.118-0.574-0.178-0.875-0.178c-0.337,0-0.659,0.063-0.964,0.191c-0.306,0.128-0.579,0.344-0.82,0.649 c-0.242,0.306-0.431,0.699-0.567,1.183s-0.21,1.075-0.219,1.777c0.009,0.684,0.08,1.276,0.212,1.777 c0.132,0.501,0.314,0.911,0.547,1.23s0.497,0.556,0.793,0.711c0.296,0.155,0.608,0.232,0.937,0.232c0.1,0,0.234-0.007,0.403-0.021 c0.168-0.014,0.337-0.036,0.506-0.068c0.168-0.032,0.33-0.075,0.485-0.13c0.155-0.055,0.269-0.132,0.342-0.232v-2.488h-1.709 v-1.121H41.16z"})),o.a.createElement("circle",{fill:"#F3D55B",cx:"18.931",cy:"14.431",r:"4.569"}),o.a.createElement("polygon",{fill:"#88C057",points:"6.5,39 17.5,39 49.5,39 49.5,28 39.5,18.5 29,30 23.517,24.517 \t"})))}}])&&cu(n.prototype,r),i&&cu(n,i),t}();function vu(e){return(vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function du(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mu(e,t){return!t||"object"!==vu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bu(e){return(bu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gu(e,t){return(gu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wu=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),mu(this,bu(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gu(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"jpg-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 56 56"},o.a.createElement("g",null,o.a.createElement("path",{fill:"#E9E9E0",d:"M36.985,0H7.963C7.155,0,6.5,0.655,6.5,1.926V55c0,0.345,0.655,1,1.463,1h40.074 c0.808,0,1.463-0.655,1.463-1V12.978c0-0.696-0.093-0.92-0.257-1.085L37.607,0.257C37.442,0.093,37.218,0,36.985,0z"}),o.a.createElement("polygon",{fill:"#D9D7CA",points:"37.5,0.151 37.5,12 49.349,12 \t"}),o.a.createElement("circle",{fill:"#F3D55B",cx:"18.931",cy:"14.431",r:"4.569"}),o.a.createElement("polygon",{fill:"#26B99A",points:"6.5,39 17.5,39 49.5,39 49.5,28 39.5,18.5 29,30 23.517,24.517 \t"}),o.a.createElement("path",{fill:"#14A085",d:"M48.037,56H7.963C7.155,56,6.5,55.345,6.5,54.537V39h43v15.537C49.5,55.345,48.845,56,48.037,56z"}),o.a.createElement("g",null,o.a.createElement("path",{fill:"#FFFFFF",d:"M21.426,42.65v7.848c0,0.474-0.087,0.873-0.26,1.196c-0.173,0.323-0.406,0.583-0.697,0.779 c-0.292,0.196-0.627,0.333-1.005,0.41C19.085,52.961,18.696,53,18.295,53c-0.201,0-0.436-0.021-0.704-0.062 c-0.269-0.041-0.547-0.104-0.834-0.191s-0.563-0.185-0.827-0.294c-0.265-0.109-0.488-0.232-0.67-0.369l0.697-1.107 c0.091,0.063,0.221,0.13,0.39,0.198c0.168,0.068,0.353,0.132,0.554,0.191c0.2,0.06,0.41,0.111,0.629,0.157 s0.424,0.068,0.615,0.068c0.483,0,0.868-0.094,1.155-0.28s0.439-0.504,0.458-0.95V42.65H21.426z"}),o.a.createElement("path",{fill:"#FFFFFF",d:"M25.514,52.932h-1.641V42.855h2.898c0.428,0,0.852,0.068,1.271,0.205 c0.419,0.137,0.795,0.342,1.128,0.615c0.333,0.273,0.602,0.604,0.807,0.991s0.308,0.822,0.308,1.306 c0,0.511-0.087,0.973-0.26,1.388c-0.173,0.415-0.415,0.764-0.725,1.046c-0.31,0.282-0.684,0.501-1.121,0.656 s-0.921,0.232-1.449,0.232h-1.217V52.932z M25.514,44.1v3.992h1.504c0.2,0,0.398-0.034,0.595-0.103 c0.196-0.068,0.376-0.18,0.54-0.335s0.296-0.371,0.396-0.649c0.1-0.278,0.15-0.622,0.15-1.032c0-0.164-0.023-0.354-0.068-0.567 c-0.046-0.214-0.139-0.419-0.28-0.615c-0.142-0.196-0.34-0.36-0.595-0.492C27.5,44.166,27.163,44.1,26.744,44.1H25.514z"}),o.a.createElement("path",{fill:"#FFFFFF",d:"M39.5,47.736v3.896c-0.21,0.265-0.444,0.48-0.704,0.649s-0.533,0.308-0.82,0.417 s-0.583,0.187-0.889,0.232C36.781,52.978,36.479,53,36.178,53c-0.602,0-1.155-0.109-1.661-0.328s-0.948-0.542-1.326-0.971 c-0.378-0.429-0.675-0.966-0.889-1.613c-0.214-0.647-0.321-1.395-0.321-2.242s0.107-1.593,0.321-2.235 c0.214-0.643,0.51-1.178,0.889-1.606c0.378-0.429,0.822-0.754,1.333-0.978c0.51-0.224,1.062-0.335,1.654-0.335 c0.547,0,1.057,0.091,1.531,0.273c0.474,0.183,0.897,0.456,1.271,0.82l-1.135,1.012c-0.219-0.265-0.47-0.456-0.752-0.574 c-0.283-0.118-0.574-0.178-0.875-0.178c-0.337,0-0.659,0.063-0.964,0.191c-0.306,0.128-0.579,0.344-0.82,0.649 c-0.242,0.306-0.431,0.699-0.567,1.183s-0.21,1.075-0.219,1.777c0.009,0.684,0.08,1.276,0.212,1.777 c0.132,0.501,0.314,0.911,0.547,1.23s0.497,0.556,0.793,0.711c0.296,0.155,0.608,0.232,0.937,0.232c0.1,0,0.234-0.007,0.403-0.021 c0.168-0.014,0.337-0.036,0.506-0.068c0.168-0.032,0.33-0.075,0.485-0.13c0.155-0.055,0.269-0.132,0.342-0.232v-2.488h-1.709 v-1.121H39.5z"}))))}}])&&du(n.prototype,r),i&&du(n,i),t}();function Eu(e){return(Eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Su(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _u(e,t){return!t||"object"!==Eu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ou(e){return(Ou=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ku(e,t){return(ku=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Cu=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_u(this,Ou(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ku(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"json-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 56 56"},o.a.createElement("g",null,o.a.createElement("path",{fill:"#E9E9E0",d:"M36.985,0H7.963C7.155,0,6.5,0.655,6.5,1.926V55c0,0.345,0.655,1,1.463,1h40.074 c0.808,0,1.463-0.655,1.463-1V12.978c0-0.696-0.093-0.92-0.257-1.085L37.607,0.257C37.442,0.093,37.218,0,36.985,0z"}),o.a.createElement("polygon",{fill:"#D9D7CA",points:"37.5,0.151 37.5,12 49.349,12 \t"}),o.a.createElement("path",{fill:"#9777A8",d:"M48.037,56H7.963C7.155,56,6.5,55.345,6.5,54.537V39h43v15.537C49.5,55.345,48.845,56,48.037,56z"}),o.a.createElement("g",null,o.a.createElement("path",{fill:"#FFFFFF",d:"M17.021,42.719v7.848c0,0.474-0.087,0.873-0.26,1.196s-0.405,0.583-0.697,0.779 s-0.627,0.333-1.005,0.41c-0.378,0.077-0.768,0.116-1.169,0.116c-0.2,0-0.436-0.021-0.704-0.062s-0.547-0.104-0.834-0.191 s-0.563-0.185-0.827-0.294s-0.487-0.232-0.67-0.369l0.697-1.107c0.091,0.063,0.221,0.13,0.39,0.198s0.354,0.132,0.554,0.191 s0.41,0.111,0.629,0.157s0.424,0.068,0.615,0.068c0.483,0,0.868-0.094,1.155-0.28s0.439-0.504,0.458-0.95v-7.711H17.021z"}),o.a.createElement("path",{fill:"#FFFFFF",d:"M25.184,50.238c0,0.364-0.075,0.718-0.226,1.06s-0.362,0.643-0.636,0.902s-0.61,0.467-1.012,0.622 s-0.856,0.232-1.367,0.232c-0.219,0-0.444-0.012-0.677-0.034s-0.467-0.062-0.704-0.116c-0.237-0.055-0.463-0.13-0.677-0.226 s-0.398-0.212-0.554-0.349l0.287-1.176c0.128,0.073,0.289,0.144,0.485,0.212s0.398,0.132,0.608,0.191s0.419,0.107,0.629,0.144 s0.405,0.055,0.588,0.055c0.556,0,0.982-0.13,1.278-0.39s0.444-0.645,0.444-1.155c0-0.31-0.104-0.574-0.314-0.793 s-0.472-0.417-0.786-0.595s-0.654-0.355-1.019-0.533s-0.706-0.388-1.025-0.629s-0.583-0.526-0.793-0.854s-0.314-0.738-0.314-1.23 c0-0.446,0.082-0.843,0.246-1.189s0.385-0.641,0.663-0.882s0.602-0.426,0.971-0.554s0.759-0.191,1.169-0.191 c0.419,0,0.843,0.039,1.271,0.116s0.774,0.203,1.039,0.376c-0.055,0.118-0.118,0.248-0.191,0.39s-0.142,0.273-0.205,0.396 s-0.118,0.226-0.164,0.308s-0.073,0.128-0.082,0.137c-0.055-0.027-0.116-0.063-0.185-0.109s-0.166-0.091-0.294-0.137 s-0.296-0.077-0.506-0.096s-0.479-0.014-0.807,0.014c-0.183,0.019-0.355,0.07-0.52,0.157s-0.31,0.193-0.438,0.321 s-0.228,0.271-0.301,0.431s-0.109,0.313-0.109,0.458c0,0.364,0.104,0.658,0.314,0.882s0.47,0.419,0.779,0.588 s0.647,0.333,1.012,0.492s0.704,0.354,1.019,0.581s0.576,0.513,0.786,0.854S25.184,49.7,25.184,50.238z"}),o.a.createElement("path",{fill:"#FFFFFF",d:"M35.082,47.914c0,0.848-0.107,1.595-0.321,2.242s-0.511,1.185-0.889,1.613s-0.82,0.752-1.326,0.971 s-1.06,0.328-1.661,0.328s-1.155-0.109-1.661-0.328s-0.948-0.542-1.326-0.971s-0.675-0.966-0.889-1.613s-0.321-1.395-0.321-2.242 s0.107-1.593,0.321-2.235s0.511-1.178,0.889-1.606s0.82-0.754,1.326-0.978s1.06-0.335,1.661-0.335s1.155,0.111,1.661,0.335 s0.948,0.549,1.326,0.978s0.675,0.964,0.889,1.606S35.082,47.066,35.082,47.914z M30.844,51.729c0.337,0,0.658-0.066,0.964-0.198 s0.579-0.349,0.82-0.649s0.431-0.695,0.567-1.183s0.21-1.082,0.219-1.784c-0.009-0.684-0.08-1.265-0.212-1.743 s-0.314-0.873-0.547-1.183s-0.497-0.533-0.793-0.67s-0.608-0.205-0.937-0.205c-0.337,0-0.658,0.063-0.964,0.191 s-0.579,0.344-0.82,0.649s-0.431,0.699-0.567,1.183c-0.137,0.483-0.21,1.075-0.219,1.777c0.009,0.684,0.08,1.267,0.212,1.75 s0.314,0.877,0.547,1.183s0.497,0.528,0.793,0.67S30.516,51.729,30.844,51.729z"}),o.a.createElement("path",{fill:"#FFFFFF",d:"M44.68,42.924V53h-1.668l-3.951-6.945V53h-1.668V42.924h1.668l3.951,6.945v-6.945H44.68z"})),o.a.createElement("g",null,o.a.createElement("path",{fill:"#9777A8",d:"M19.5,19v-4c0-0.551,0.448-1,1-1c0.553,0,1-0.448,1-1s-0.447-1-1-1c-1.654,0-3,1.346-3,3v4 c0,1.103-0.897,2-2,2c-0.553,0-1,0.448-1,1s0.447,1,1,1c1.103,0,2,0.897,2,2v4c0,1.654,1.346,3,3,3c0.553,0,1-0.448,1-1 s-0.447-1-1-1c-0.552,0-1-0.449-1-1v-4c0-1.2-0.542-2.266-1.382-3C18.958,21.266,19.5,20.2,19.5,19z"}),o.a.createElement("circle",{fill:"#9777A8",cx:"27.5",cy:"18.5",r:"1.5"}),o.a.createElement("path",{fill:"#9777A8",d:"M39.5,21c-1.103,0-2-0.897-2-2v-4c0-1.654-1.346-3-3-3c-0.553,0-1,0.448-1,1s0.447,1,1,1 c0.552,0,1,0.449,1,1v4c0,1.2,0.542,2.266,1.382,3c-0.84,0.734-1.382,1.8-1.382,3v4c0,0.551-0.448,1-1,1c-0.553,0-1,0.448-1,1 s0.447,1,1,1c1.654,0,3-1.346,3-3v-4c0-1.103,0.897-2,2-2c0.553,0,1-0.448,1-1S40.053,21,39.5,21z"}),o.a.createElement("path",{fill:"#9777A8",d:"M27.5,24c-0.553,0-1,0.448-1,1v3c0,0.552,0.447,1,1,1s1-0.448,1-1v-3 C28.5,24.448,28.053,24,27.5,24z"}))))}}])&&Su(n.prototype,r),i&&Su(n,i),t}();function xu(e){return(xu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pu(e,t){return!t||"object"!==xu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ju(e){return(ju=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tu(e,t){return(Tu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mu=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Pu(this,ju(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tu(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("svg",{className:"xml-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 56 56"},o.a.createElement("g",null,o.a.createElement("path",{fill:"#E9E9E0",d:"M36.985,0H7.963C7.155,0,6.5,0.655,6.5,1.926V55c0,0.345,0.655,1,1.463,1h40.074 c0.808,0,1.463-0.655,1.463-1V12.978c0-0.696-0.093-0.92-0.257-1.085L37.607,0.257C37.442,0.093,37.218,0,36.985,0z"}),o.a.createElement("polygon",{fill:"#D9D7CA",points:"37.5,0.151 37.5,12 49.349,12 \t"}),o.a.createElement("path",{fill:"#F29C1F",d:"M48.037,56H7.963C7.155,56,6.5,55.345,6.5,54.537V39h43v15.537C49.5,55.345,48.845,56,48.037,56z"}),o.a.createElement("g",null,o.a.createElement("path",{fill:"#FFFFFF",d:"M19.379,48.105L21.936,53h-1.9l-1.6-3.801h-0.137L16.576,53h-1.9l2.557-4.895l-2.721-5.182h1.873 l1.777,4.102h0.137l1.928-4.102H22.1L19.379,48.105z"}),o.a.createElement("path",{fill:"#FFFFFF",d:"M31.998,42.924h1.668V53h-1.668v-6.932l-2.256,5.605h-1.449l-2.27-5.605V53h-1.668V42.924h1.668 l2.994,6.891L31.998,42.924z"}),o.a.createElement("path",{fill:"#FFFFFF",d:"M37.863,42.924v8.832h4.635V53h-6.303V42.924H37.863z"})),o.a.createElement("path",{fill:"#F29C1F",d:"M15.5,24c-0.256,0-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.023,0-1.414l6-6 c0.391-0.391,1.023-0.391,1.414,0s0.391,1.023,0,1.414l-6,6C16.012,23.902,15.756,24,15.5,24z"}),o.a.createElement("path",{fill:"#F29C1F",d:"M21.5,30c-0.256,0-0.512-0.098-0.707-0.293l-6-6c-0.391-0.391-0.391-1.023,0-1.414 s1.023-0.391,1.414,0l6,6c0.391,0.391,0.391,1.023,0,1.414C22.012,29.902,21.756,30,21.5,30z"}),o.a.createElement("path",{fill:"#F29C1F",d:"M33.5,30c-0.256,0-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.023,0-1.414l6-6 c0.391-0.391,1.023-0.391,1.414,0s0.391,1.023,0,1.414l-6,6C34.012,29.902,33.756,30,33.5,30z"}),o.a.createElement("path",{fill:"#F29C1F",d:"M39.5,24c-0.256,0-0.512-0.098-0.707-0.293l-6-6c-0.391-0.391-0.391-1.023,0-1.414 s1.023-0.391,1.414,0l6,6c0.391,0.391,0.391,1.023,0,1.414C40.012,23.902,39.756,24,39.5,24z"}),o.a.createElement("path",{fill:"#F29C1F",d:"M24.5,32c-0.11,0-0.223-0.019-0.333-0.058c-0.521-0.184-0.794-0.755-0.61-1.276l6-17 c0.185-0.521,0.753-0.795,1.276-0.61c0.521,0.184,0.794,0.755,0.61,1.276l-6,17C25.298,31.744,24.912,32,24.5,32z"})))}}])&&Nu(n.prototype,r),i&&Nu(n,i),t}();function Du(e){return(Du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Iu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lu(e){return(Lu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Au(e,t){return(Au=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ru(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Bu=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=Lu(t).call(this,e))||"object"!==Du(o)&&"function"!=typeof o?Ru(r):o).container=null,n.onExportXML=n.onExportXML.bind(Ru(Ru(n))),n.onExportJSON=n.onExportJSON.bind(Ru(Ru(n))),n.onExportPNG=n.onExportPNG.bind(Ru(Ru(n))),n.onExportJPG=n.onExportJPG.bind(Ru(Ru(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Au(e,t)}(t,o.a.Component),n=t,(r=[{key:"onExportJSON",value:function(e){var t=JSON.stringify(Fa(this.props.graphController,this.props.machineController)),n=this.props.machineController.getMachineName();Tn.downloadText(n+".json",t)}},{key:"onExportXML",value:function(e){var t=this.props.machineController.getMachineName(),n=this.props.graphController.getGraph(),r=(new XMLSerializer).serializeToString(Da.toXML(n));Tn.downloadText(t+".jff",r)}},{key:"onExportPNG",value:function(e){var t=this.props.machineController.getMachineName(),n=this.props.app.workspace,r=n.ref.viewBox.baseVal,o=r.width,i=r.height,a=n.getSVGForExport(o,i);Tn.downloadSVG(t,"png",a,o,i)}},{key:"onExportJPG",value:function(e){var t=this.props.machineController.getMachineName(),n=this.props.app.workspace,r=n.ref.viewBox.baseVal,o=r.width,i=r.height,a=n.getSVGForExport(o,i);Tn.downloadSVG(t,"jpg",a,o,i)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"panel-container",id:"exporting",ref:function(t){return e.container=t},style:this.props.style},o.a.createElement("div",{className:"panel-title"},o.a.createElement("h1",null,I18N.toString("component.exporting.title"))),o.a.createElement("div",{className:"panel-content"},o.a.createElement(F,{className:"export-button",id:"export-json",title:I18N.toString("file.export.machine.hint"),onClick:this.onExportJSON},o.a.createElement(Cu,null),o.a.createElement("label",null,I18N.toString("file.export.machine"))),o.a.createElement(F,{className:"export-button",id:"export-png",title:I18N.toString("file.export.png.hint"),onClick:this.onExportPNG},o.a.createElement(yu,null),o.a.createElement("label",null,I18N.toString("file.export.png"))),o.a.createElement(F,{className:"export-button",id:"export-jpg",title:I18N.toString("file.export.jpg.hint"),onClick:this.onExportJPG},o.a.createElement(wu,null),o.a.createElement("label",null,I18N.toString("file.export.jpg"))),o.a.createElement(F,{className:"export-button",id:"export-xml",title:I18N.toString("file.export.jff.hint"),onClick:this.onExportXML},o.a.createElement(Mu,null),o.a.createElement("label",null,I18N.toString("file.export.jff"))),o.a.createElement("hr",null),o.a.createElement("div",{className:"export-email"})),o.a.createElement("div",{className:"panel-bottom"}))}}])&&Iu(n.prototype,r),i&&Iu(n,i),t}();Bu.UNLOCALIZED_NAME="component.exporting.title";var Fu=Bu;n(72);function Gu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Uu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"HEXtoRGB",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.startsWith("#")&&(e=e.slice(1));var n=e.substring(0,2),r=e.substring(2,4),o=e.substring(4,6);return t[0]=parseInt(n,16),t[1]=parseInt(r,16),t[2]=parseInt(o,16),t}},{key:"RGBtoHEX",value:function(e,t,n){return"#"+(n|t<<8|e<<16|1<<24).toString(16).slice(1)}},{key:"RGBtoHSV",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];e/=255,t/=255,n/=255;var o=Math.max(e,t,n),i=Math.min(e,t,n),a=o-i,l=0,u=0==o?0:a/o,s=o;if(o==i)l=0;else{switch(o){case e:l=(t-n)/a+(t<n?6:0);break;case t:l=(n-e)/a+2;break;case n:l=(e-t)/a+4}l/=6}return r[0]=l,r[1]=u,r[2]=s,r}},{key:"HSVtoRGB",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=0,i=0,a=0,l=Math.floor(6*e),u=6*e-l,s=n*(1-t),c=n*(1-u*t),f=n*(1-(1-u)*t);switch(l%6){case 0:o=n,i=f,a=s;break;case 1:o=c,i=n,a=s;break;case 2:o=s,i=n,a=f;break;case 3:o=s,i=c,a=n;break;case 4:o=f,i=s,a=n;break;case 5:o=n,i=s,a=c}return r[0]=255*o,r[1]=255*i,r[2]=255*a,r}}],(n=null)&&Gu(t.prototype,n),r&&Gu(t,r),e}();function zu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hu(e,t,n){return t&&Vu(e.prototype,t),n&&Vu(e,n),e}var Xu=function(){function e(t,n,r,o,i){zu(this,e),this.element=t,this.prop=n,this.type=r,this.group=o,this._callback=i,this._value=null,this._defaultValue=null}return Hu(e,[{key:"updateStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e||(e=window.getComputedStyle(this.element));var n=e.getPropertyValue(this.prop);if(!n)throw new Error("Cannot find style option with prop name '"+this.prop+"' for element");this._value=n.trim(),this._defaultValue=this._value,t&&this._callback&&this._callback(this,n)}},{key:"resetStyle",value:function(){this.setStyle(this._defaultValue)}},{key:"setStyle",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._value=e,this.element.style.setProperty(this.prop,e),t&&this._callback&&this._callback.call(null,this,e)}},{key:"getStyle",value:function(){return this._value}},{key:"isDefaultStyle",value:function(){return this._value==this._defaultValue}}]),e}(),Yu=function(){function e(){zu(this,e),this._options=new Map,this._groups=new Map,this._init=!1}return Hu(e,[{key:"registerStyleOption",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"default",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(this._options.has(t))throw new Error("Style option with prop name '"+t+"' already registered");var i,a=new Xu(e,t,n,r,o);if(this._options.set(t,a),this._groups.has(r)){if(-1!=(i=this._groups.get(r)).indexOf(t))return}else i=[],this._groups.set(r,i);i.push(t)}},{key:"unregisterStyleOption",value:function(e){if(this._options.has(e)){var t=this._options.get(e);this._options.delete(e);var n=t.group;if(this._groups.has(n)){var r=this._groups.get(n),o=r.indexOf(e);o>=0&&r.splice(o,1)}}}},{key:"initialize",value:function(){if(this._init)throw new Error("Already initialized");var e,t={},n=!0,r=!1,o=void 0;try{for(var i,a=this._options.values()[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value,u=l.element;(e=t[u])||(e=window.getComputedStyle(u),t[u]=e),l.updateStyle(e,!1)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}this._init=!0}},{key:"terminate",value:function(){if(!this._init)throw new Error("Not yet initialized");this._options.clear(),this._groups.clear(),this._init=!1}},{key:"getOptionByProp",value:function(e){return this._options.get(e)}},{key:"getPropsByGroup",value:function(e){return this._groups.get(e)||[]}},{key:"getOptions",value:function(){return this._options.values()}},{key:"isEmpty",value:function(){return this._options.size<=0}}]),e}();function Qu(e){return(Qu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ku(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wu(e){return(Wu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ju(e,t){return(Ju=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Zu=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=Wu(t).call(this,e))||"object"!==Qu(o)&&"function"!=typeof o?qu(r):o).onChange=n.onChange.bind(qu(qu(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ju(e,t)}(t,o.a.Component),n=t,(r=[{key:"onChange",value:function(e){var t=e.target.value,n=this.props.value,r=this.props.onChange;n.setStyle(t),r&&r(n)}},{key:"render",value:function(){var e=this.props.title,t=this.props.value,n=t.prop,r=t.type,i="styleopt-"+n;return o.a.createElement("span",{id:this.props.id,className:this.props.className,style:this.props.style},o.a.createElement("input",{id:i,type:r,value:t.getStyle(),onChange:this.onChange,disabled:this.props.disabled}),o.a.createElement("label",{htmlFor:i},e))}}])&&Ku(n.prototype,r),i&&Ku(n,i),t}();n(74);function $u(e){return($u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function es(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ts(e,t){return!t||"object"!==$u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ns(e){return(ns=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rs(e,t){return(rs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var os=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ts(this,ns(t).call(this,e))).dropdown=o.a.createRef(),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rs(e,t)}(t,o.a.Component),n=t,(r=[{key:"isOpen",value:function(){return!!this.dropdown.state&&this.dropdown.state.open}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"option-group "+this.props.className},o.a.createElement("div",{className:"option-header",onClick:function(t){return e.dropdown.onClick(t)}},o.a.createElement("label",null,this.props.title),o.a.createElement("label",null,"(",this.props.label,")"),o.a.createElement(E,{id:"collapse",ref:function(t){return e.dropdown=t},defaultValue:this.props.defaultValue,style:{pointerEvents:"none"}},o.a.createElement(x,null))),o.a.createElement("div",{className:"option-content",style:{display:this.isOpen()?"block":"none"}},this.props.children))}}])&&es(n.prototype,r),i&&es(n,i),t}();n(76);function is(e){return(is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function as(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ls(e,t){return!t||"object"!==is(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function us(e){return(us=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ss(e,t){return(ss=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cs=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ls(this,us(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ss(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){return o.a.createElement("div",{className:"option-container option-hotkey "+this.props.className},o.a.createElement("label",null,this.props.label),o.a.createElement("span",null,this.props.keyName))}}])&&as(n.prototype,r),i&&as(n,i),t}();function fs(e){return(fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ps(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hs(e){return(hs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ys(e,t){return(ys=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ds="skipWelcome",ms=function(e){function t(e){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(i=hs(t).call(this,e))||"object"!==fs(i)&&"function"!=typeof i?vs(r):i).container=o.a.createRef(),n.styleOpts=new Yu,n.state={theme:"default",customTheme:!1,skipWelcome:"true"==ul.getStringFromStorage(ds)},n.onChangeTheme=n.onChangeTheme.bind(vs(vs(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ys(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=document.getElementById("root"),t=this.styleOpts,n=function(e,n){var r=[];Uu.HEXtoRGB(n,r),Uu.RGBtoHSV.apply(Uu,r.concat([r])),r[2]=1-r[2],Uu.HSVtoRGB.apply(Uu,r.concat([r]));var o=Uu.RGBtoHEX.apply(Uu,r);t.getOptionByProp(e.prop+"-invert").setStyle(o)},r=function(e,n){var r=[];Uu.HEXtoRGB(n,r),Uu.RGBtoHSV.apply(Uu,r.concat([r])),r[2]*=.8,Uu.HSVtoRGB.apply(Uu,r.concat([r]));var o=Uu.RGBtoHEX.apply(Uu,r);t.getOptionByProp(e.prop+"-dark").setStyle(o)};t.registerStyleOption(e,"--color-toolbar-main","color","toolbar",r),t.registerStyleOption(e,"--color-toolbar-main-dark","color","hidden"),t.registerStyleOption(e,"--color-toolbar-accent","color","toolbar",r),t.registerStyleOption(e,"--color-toolbar-accent-dark","color","hidden"),t.registerStyleOption(e,"--color-toolbar-text","color","toolbar",n),t.registerStyleOption(e,"--color-toolbar-text-invert","color","hidden"),t.registerStyleOption(e,"--color-drawer-main","color","drawer",r),t.registerStyleOption(e,"--color-drawer-main-dark","color","hidden"),t.registerStyleOption(e,"--color-drawer-accent","color","drawer"),t.registerStyleOption(e,"--color-drawer-text","color","drawer",function(){(function(e,n){var r=[];Uu.HEXtoRGB(n,r),Uu.RGBtoHSV.apply(Uu,r.concat([r])),r[2]*=.61,Uu.HSVtoRGB.apply(Uu,r.concat([r]));var o=Uu.RGBtoHEX.apply(Uu,r);t.getOptionByProp(e.prop+"-subtle").setStyle(o)}).apply(void 0,arguments),function(e,n){var r=[];Uu.HEXtoRGB(n,r),Uu.RGBtoHSV.apply(Uu,r.concat([r])),r[2]*=.74,Uu.HSVtoRGB.apply(Uu,r.concat([r]));var o=Uu.RGBtoHEX.apply(Uu,r);t.getOptionByProp(e.prop+"-ghost").setStyle(o)}.apply(void 0,arguments),n.apply(void 0,arguments),function(e,n){var r=[];Uu.HEXtoRGB(n,r),Uu.RGBtoHSV.apply(Uu,r.concat([r])),r[2]*=.87,Uu.HSVtoRGB.apply(Uu,r.concat([r]));var o=Uu.RGBtoHEX.apply(Uu,r);t.getOptionByProp(e.prop+"-back").setStyle(o)}.apply(void 0,arguments)}),t.registerStyleOption(e,"--color-drawer-text-subtle","color","hidden"),t.registerStyleOption(e,"--color-drawer-text-ghost","color","hidden"),t.registerStyleOption(e,"--color-drawer-text-invert","color","hidden"),t.registerStyleOption(e,"--color-drawer-text-back","color","hidden"),t.registerStyleOption(e,"--color-drawer-error","color","drawer"),t.registerStyleOption(e,"--color-testing-success","color","testing"),t.registerStyleOption(e,"--color-testing-failure","color","testing"),t.registerStyleOption(e,"--color-testing-working","color","testing"),t.registerStyleOption(e,"--color-testing-text","color","testing"),t.registerStyleOption(e,"--color-notification-text","color","notification"),t.registerStyleOption(e,"--color-notification-info","color","notification",r),t.registerStyleOption(e,"--color-notification-info-dark","color","hidden"),t.registerStyleOption(e,"--color-notification-error","color","notification",r),t.registerStyleOption(e,"--color-notification-error-dark","color","hidden"),t.registerStyleOption(e,"--color-notification-warning","color","notification",r),t.registerStyleOption(e,"--color-notification-warning-dark","color","hidden"),t.registerStyleOption(e,"--color-graph-node","color","workspace"),t.registerStyleOption(e,"--color-workspace-text","color","workspace"),t.registerStyleOption(e,"--color-workspace-main","color","workspace"),t.registerStyleOption(e,"--color-labeleditor-text","color","labeleditor"),t.registerStyleOption(e,"--color-labeleditor-main","color","labeleditor"),t.registerStyleOption(e,"--color-viewport-error","color","viewport"),t.registerStyleOption(e,"--color-viewport-testing","color","viewport"),t.registerStyleOption(e,"--color-viewport-warning","color","viewport"),t.registerStyleOption(e,"--color-highlight-select","color","viewport"),t.initialize(),ul.registerHandler(this),this.onLoadSave()}},{key:"componentWillUnmount",value:function(){registry.terminate(),ul.unregisterHandler(this)}},{key:"onLoadSave",value:function(){var e=this.styleOpts,t=ul.loadFromStorage("prefs-color");for(var n in t){var r=e.getOptionByProp(n);r&&r.setStyle(t[n])}}},{key:"onAutoSave",value:function(){var e=this.styleOpts,t={},n=!0,r=!1,o=void 0;try{for(var i,a=e.getOptions()[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value;l.isDefaultStyle()||(t[l.prop]=l.getStyle())}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}ul.saveToStorage("prefs-color",t)}},{key:"onChangeTheme",value:function(e){var t=this.state.theme,n=e.target.value;if(console.log(t,n),t!==n){if("default"===n){var r=!0,o=!1,i=void 0;try{for(var a,l=this.styleOpts.getOptions()[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){a.value.resetStyle()}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}}this.setState({theme:n})}}},{key:"render",value:function(){var e=this,t=(document.getElementById("root"),this.styleOpts);return o.a.createElement("div",{className:"panel-container",id:"option",ref:function(t){return e.container=t},style:this.props.style},o.a.createElement("div",{className:"panel-title"},o.a.createElement("h1",null,I18N.toString("component.options.title"))),o.a.createElement("div",{className:"panel-content"},o.a.createElement(os,{title:I18N.toString("component.workspace.title"),label:I18N.toString("options.category.shortcuts")},o.a.createElement(cs,{label:I18N.toString("action.toolbar.savemachine"),keyName:"Ctrl + S"}),o.a.createElement(cs,{label:I18N.toString("action.toolbar.undo.label"),keyName:"Ctrl + Z"}),o.a.createElement(cs,{label:I18N.toString("action.toolbar.redo.label"),keyName:"Ctrl + Shift + Z"}),o.a.createElement(cs,{label:I18N.toString("action.toolbar.saveimage"),keyName:"Ctrl + P"})),o.a.createElement(os,{title:I18N.toString("component.testing.title"),label:I18N.toString("options.category.shortcuts")},o.a.createElement(cs,{label:"Add test input",keyName:"Enter"}),o.a.createElement(cs,{label:"Run test input",keyName:"Shift + Enter"})),o.a.createElement(os,{title:I18N.toString("component.labeleditor.title"),label:I18N.toString("options.category.shortcuts")},o.a.createElement(cs,{label:I18N.toString("action.workspace.submit.label"),keyName:"Enter"}),o.a.createElement(cs,{label:I18N.toString("action.workspace.cancel.label"),keyName:"Escape"})),o.a.createElement("hr",null),o.a.createElement("div",null,o.a.createElement("div",{id:"options-theme-select-container"},o.a.createElement("label",{htmlFor:"options-theme-select"},"Theme"),o.a.createElement("select",{id:"options-theme-select",className:"panel-select",value:this.state.theme,onChange:this.onChangeTheme,disabled:this.state.customTheme},o.a.createElement("option",{value:"default"},"Default"),o.a.createElement("option",{value:"ucsd",disabled:"true"},"UC San Diego (Coming Soon)"),o.a.createElement("option",{value:"duke",disabled:"true"},"Duke University (Coming Soon)")),!this.state.customTheme&&o.a.createElement("button",{className:"panel-button",onClick:function(){return e.setState({customTheme:!0})}},I18N.toString("action.options.changetheme"))),this.state.customTheme&&o.a.createElement("div",null,o.a.createElement(os,{title:I18N.toString("component.toolbar.title"),label:I18N.toString("options.category.colors")},t.getPropsByGroup("toolbar").map(function(e){return o.a.createElement("div",{key:e},o.a.createElement(Zu,{className:"option-container",value:t.getOptionByProp(e),title:I18N.toString("options."+e)}))})),o.a.createElement(os,{title:I18N.toString("component.drawer.title"),label:I18N.toString("options.category.colors")},t.getPropsByGroup("drawer").map(function(e){return o.a.createElement("div",{key:e},o.a.createElement(Zu,{className:"option-container",value:t.getOptionByProp(e),title:I18N.toString("options."+e)}))})),o.a.createElement(os,{title:I18N.toString("component.testing.title"),label:I18N.toString("options.category.colors")},t.getPropsByGroup("testing").map(function(e){return o.a.createElement("div",{key:e},o.a.createElement(Zu,{className:"option-container",value:t.getOptionByProp(e),title:I18N.toString("options."+e)}))})),o.a.createElement(os,{title:I18N.toString("component.notification.title"),label:I18N.toString("options.category.colors")},t.getPropsByGroup("notification").map(function(e){return o.a.createElement("div",{key:e},o.a.createElement(Zu,{className:"option-container",value:t.getOptionByProp(e),title:I18N.toString("options."+e)}))})),o.a.createElement(os,{title:I18N.toString("component.graph.title"),label:I18N.toString("options.category.colors")},t.getPropsByGroup("workspace").map(function(e){return o.a.createElement("div",{key:e},o.a.createElement(Zu,{className:"option-container",value:t.getOptionByProp(e),title:I18N.toString("options."+e)}))})),o.a.createElement(os,{title:I18N.toString("component.labeleditor.title"),label:I18N.toString("options.category.colors")},t.getPropsByGroup("labeleditor").map(function(e){return o.a.createElement("div",{key:e},o.a.createElement(Zu,{className:"option-container",value:t.getOptionByProp(e),title:I18N.toString("options."+e)}))})),o.a.createElement(os,{title:I18N.toString("options.category.general"),label:I18N.toString("options.category.colors")},t.getPropsByGroup("viewport").map(function(e){return o.a.createElement("div",{key:e},o.a.createElement(Zu,{className:"option-container",value:t.getOptionByProp(e),title:I18N.toString("options."+e)}))})),o.a.createElement("button",{className:"panel-button",onClick:function(t){var n=!0,r=!1,o=void 0;try{for(var i,a=e.styleOpts.getOptions()[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){i.value.resetStyle()}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}e.setState({customTheme:!1})}},I18N.toString("action.options.reset"))),o.a.createElement("hr",null)),o.a.createElement("div",{className:"panel-checkbox"},o.a.createElement("input",{id:"option-skipwelcome",type:"checkbox",checked:this.state.skipWelcome,onChange:function(t){var n=t.target.checked;e.setState({skipWelcome:t.target.checked}),ul.setStringToStorage(ds,n)}}),o.a.createElement("label",{htmlFor:"option-skipwelcome"},I18N.toString("options.skipwelcome")))),o.a.createElement("div",{className:"panel-bottom"}))}}])&&ps(n.prototype,r),i&&ps(n,i),t}();function bs(e){return(bs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ws(e){return(ws=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Es(e,t){return(Es=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ss(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}ms.UNLOCALIZED_NAME="component.options.title";var _s=[Fu,ms],Os=1,ks=50,Cs=300,xs=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=ws(t).call(this,e))||"object"!==bs(o)&&"function"!=typeof o?Ss(r):o).state={tabIndex:Os,dragging:!1},n.onTouchStart=n.onTouchStart.bind(Ss(Ss(n))),n.onMouseDown=n.onMouseDown.bind(Ss(Ss(n))),n.onScroll=n.onScroll.bind(Ss(Ss(n))),n._ontouchmove=null,n._ontouchend=null,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Es(e,t)}(t,o.a.Component),n=t,(r=[{key:"setTab",value:function(e){var t=this.props.app;t.state.isOpen?this.state.tabIndex===e&&t.openDrawer(!t.state.isFullscreen):t.openDrawer(),this.setState(function(t,n){return{tabIndex:e}})}},{key:"onStartDraggingDrawerBorder",value:function(e,t){var n=this.props.app;this.setState({dragging:!0}),n.state.isFullscreen&&n.openDrawer(!1),Ns(n,e,t)}},{key:"onStopDraggingDrawerBorder",value:function(){this.setState({dragging:!1})}},{key:"onTouchStart",value:function(e){e.stopPropagation(),e.preventDefault(),this._ontouchmove&&(document.removeEventListener("touchmove",this._ontouchmove),this._ontouchmove=null),this._ontouchend&&(document.removeEventListener("touchend",this._ontouchend),this._ontouchend=null);var t=this.props.app;if(t.state.isOpen){var n=e.changedTouches[0];this.onStartDraggingDrawerBorder(n.clientX,n.clientY),this._ontouchmove=function(n){e.stopPropagation(),e.preventDefault();var r=n.changedTouches[0];Ns(t,r.clientX,r.clientY)},document.addEventListener(this._ontouchmove),this._ontouchend=function(n){e.stopPropagation(),e.preventDefault();var r=n.changedTouches[0];Ns(t,r.clientX,r.clientY),this.onStopDraggingDrawerBorder(),document.removeEventListener("touchend",this._ontouchend),document.removeEventListener("touchmove",this._ontouchmove)},document.addEventListener("touchend",this._ontouchend),document.addEventListener("touchmove",this._ontouchmove)}else this.setState({dragging:!1})}},{key:"onMouseDown",value:function(e){var t=this;e.stopPropagation(),e.preventDefault();var n=this.props.app;if(n.state.isOpen){this.onStartDraggingDrawerBorder(e.clientX,e.clientY);var r=function(e){e.stopPropagation(),e.preventDefault(),Ns(n,e.clientX,e.clientY)};document.addEventListener("mouseup",function e(o){o.stopPropagation(),o.preventDefault(),Ns(n,o.clientX,o.clientY),t.onStopDraggingDrawerBorder(),document.removeEventListener("mouseup",e),document.removeEventListener("mousemove",r)}),document.addEventListener("mousemove",r)}}},{key:"onScroll",value:function(e){}},{key:"render",value:function(){var e=this,t=this.props.app,n=t.getCurrentModule(),r=this.props.graphController,i=this.props.machineController,a=this.state.tabIndex,l=n?n.getModuleInfoPanel():null;return o.a.createElement("div",{className:"drawer-container",onWheel:this.onScroll},o.a.createElement("div",{className:"drawer-content"},n&&n.getModulePanels().map(function(e,l){var u=l+1;return o.a.createElement(e,{key:n.getModuleName()+":"+u,style:{display:a==u?"block":"none"},app:t,graphController:r,machineController:i})}),0==a&&null!=l&&o.a.createElement(l,{app:t}),_s.map(function(e,n){var l=-(n+1);return o.a.createElement(e,{key:"default:"+l,style:{display:a==l?"block":"none"},app:t,graphController:r,machineController:i})})),o.a.createElement("div",{className:"tab-list"},o.a.createElement(uu,{app:t}),n&&n.getModulePanels().map(function(t,r){var i=r+1;return o.a.createElement("button",{key:n.getModuleName()+":"+i,className:"tab-link"+(a===i?" active":""),onClick:function(t){return e.setTab(i)}},I18N.toString(t.UNLOCALIZED_NAME||"component.untitled.title"))}),_s.map(function(t,n){var r=-(n+1);return o.a.createElement("button",{key:"default:"+r,className:"tab-link"+(a===r?" active":""),onClick:function(t){return e.setTab(r)}},I18N.toString(t.UNLOCALIZED_NAME||"component.untitled.title"))}),o.a.createElement("div",{className:"tab-right"})),o.a.createElement("div",{className:"drawer-border"+(this.state.dragging?" dragging":""),onTouchStart:this.onTouchStart,onMouseDown:this.onMouseDown}))}}])&&gs(n.prototype,r),i&&gs(n,i),t}();function Ns(e,t,n){var r=e.container,o=0;window.matchMedia("(max-width: 420px)").matches?n-e.viewport.ref.getBoundingClientRect().y<ks?e.setState(function(e,t){return{isFullscreen:!0}}):(o=r.offsetHeight-n,e.state.isFullscreen&&e.setState(function(e,t){return{isFullscreen:!1}})):t<ks?e.setState(function(e,t){return{isFullscreen:!0}}):(o=r.offsetWidth-t,e.state.isFullscreen&&e.setState(function(e,t){return{isFullscreen:!1}}));o<Cs&&(o=Cs),r.style.setProperty("--panel-size",o+"px")}xs.EXPORTING_PANEL_TAB_INDEX=-1,xs.OPTIONS_PANEL_TAB_INDEX=-2;var Ps=xs;function js(e){return(js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ts(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ms(e){return(Ms=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ds(e,t){return(Ds=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Is(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ls=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=Ms(t).call(this,e))||"object"!==js(o)&&"function"!=typeof o?Is(r):o).state={langOn:!1},n.onMachineNameChange=n.onMachineNameChange.bind(Is(Is(n))),n.onMachineNameKeyDown=n.onMachineNameKeyDown.bind(Is(Is(n))),n.langOnClick=n.langOnClick.bind(Is(Is(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ds(e,t)}(t,o.a.Component),n=t,(r=[{key:"onMachineNameChange",value:function(e){this.props.machineController.renameMachine(e.value)}},{key:"onMachineNameKeyDown",value:function(){}},{key:"onMachineNameBlur",value:function(){}},{key:"langOnClick",value:function(){this.setState({langOn:!this.state.langOn})}},{key:"render",value:function(){var e=this,t=this.props.graphController,n=this.props.machineController,r=this.props.eventManager,i=this.props.drawer,a=t.getGraph(),l=n.getMachineBuilder(),u=r.getLogger(),s=navigator&&navigator.onLine;return o.a.createElement("div",{className:"toolbar-container"},o.a.createElement("div",{className:"toolbar-title"},o.a.createElement("div",{className:"toolbar-title-name"},o.a.createElement(Cl,{id:"machine-name",value:n.getMachineName(),onSubmit:this.onMachineNameChange}),o.a.createElement("div",{className:"toolbar-title-alt"},o.a.createElement(F,{id:"toolbar-lang",title:I18N.toString("action.toolbar.lang"),onClick:function(){"serviceWorker"in navigator?navigator.serviceWorker.getRegistration("./app.html")?alert(I18N.toString("message.offline.ready")):alert(I18N.toString("message.offline.failed")):alert(I18N.toString("message.offline.nosupport"))},disabled:s},o.a.createElement(Jl,null)))),o.a.createElement("label",{id:"machine-type",onClick:function(){return i.setTab(0)}},l.getMachineType())),o.a.createElement("div",{className:"toolbar-tray"},o.a.createElement(F,{className:"navicon",id:"toolbar-new",title:I18N.toString("action.toolbar.newmachine"),onClick:function(){window.confirm(I18N.toString("alert.graph.clear"))&&(a.deleteAll(),u.clear(),n.setMachineName(null))}},o.a.createElement(Ml,null)),o.a.createElement(yl,{className:"navicon",id:"toolbar-upload",title:I18N.toString("action.toolbar.uploadmachine"),graphController:t},o.a.createElement(Yr,null)),o.a.createElement(F,{className:"navicon",id:"toolbar-undo",title:I18N.toString("action.toolbar.undo"),disabled:!u.canUndo(),onClick:function(){return u.undo()}},o.a.createElement(Xt,null)),o.a.createElement(F,{className:"navicon",id:"toolbar-redo",title:I18N.toString("action.toolbar.redo"),disabled:!u.canRedo(),onClick:function(){return u.redo()}},o.a.createElement(qt,null)),o.a.createElement(F,{className:"navicon",id:"toolbar-save",title:I18N.toString("action.toolbar.save"),onClick:function(){return i.setTab(Ps.EXPORTING_PANEL_TAB_INDEX)},disabled:a.isEmpty()},o.a.createElement(oo,null)),o.a.createElement("div",{className:"toolbar-tray-alt"},o.a.createElement(F,{className:"navicon",id:"toolbar-bug",title:I18N.toString("action.toolbar.bug")},o.a.createElement(nu,null)),o.a.createElement(wl,{className:"navicon",id:"toolbar-help",title:I18N.toString("action.toolbar.help")},o.a.createElement(Bl,null)),o.a.createElement(F,{className:"navicon",id:"toolbar-lang",title:I18N.toString("action.toolbar.lang"),onClick:function(t){document.activeElement.blur(),e.langOnClick()}},o.a.createElement(Hl,null)),o.a.createElement("select",{id:"toolbar-lang-select",style:{maxWidth:this.state.langOn?"10em":"0"},onChange:function(e){I18N.fetchLanguageFile(e.target.value)}},o.a.createElement("option",{value:"en_us"},"English"),o.a.createElement("option",{value:"xx_pirate"},"Pirate Speak")))))}}])&&Ts(n.prototype,r),i&&Ts(n,i),t}();n(78),n(80);function As(e){return(As="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bs(e,t){return!t||"object"!==As(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fs(e){return(Fs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gs(e,t){return(Gs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Us=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Bs(this,Fs(t).call(this,e))).state={active:!1},n.messageTimer=null,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gs(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;this.messageTimer=setTimeout(function(){e.setState({active:!0})},s.a.INIT_WAITTIME)}},{key:"render",value:function(){var e=!!this.state.active&&this.props.visible;return o.a.createElement("text",{y:"-1em",className:"graph-ui subtitle"+(e?" visible":""),textAnchor:"middle"},I18N.toString("message.workspace.empty"))}}])&&Rs(n.prototype,r),i&&Rs(n,i),t}();function zs(e){return(zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hs(e,t){return!t||"object"!==zs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xs(e){return(Xs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ys(e,t){return(Ys=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qs=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Hs(this,Xs(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ys(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.node;return o.a.createElement("g",{className:"graph-node-container"},o.a.createElement("circle",{className:"graph-node",cx:e.x,cy:e.y,r:s.a.NODE_RADIUS,fill:"#FEE781",stroke:"#000000"}),e.accept&&o.a.createElement("circle",{className:"graph-node-inner",cx:e.x,cy:e.y,r:s.a.NODE_RADIUS_INNER,fill:"none",stroke:"#000000"}),"//Label",o.a.createElement("text",{className:"graph-node-label",x:e.x,y:e.y+4,pointerEvents:"none",style:{userSelect:"none",fontSize:1-Math.min(Math.max(e.getNodeLabel().length-2,0)/6,.5)+"em"},textAnchor:"middle"},e.getNodeLabel()))}}])&&Vs(n.prototype,r),i&&Vs(n,i),t}();function Ks(e){return(Ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ws(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Js(e,t){return!t||"object"!==Ks(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qs(e){return(qs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zs(e,t){return(Zs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $s=s.a.EDGE_SYMBOL_SEPARATOR,ec=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Js(this,qs(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zs(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=Math.PI/6,t=0,n=this.props.edge,r=n.getStartPoint(),i=n.getEndPoint(),a=n.getCenterPoint(),l=n.getEdgeLabel(),u=(n.getQuadratic(),n.getQuadraticAsCoords()),c=n.getEdgeDirection(),f=u.y>0,p=null;if(n.isQuadratic()){var h=a.x+u.x,y=a.y+u.y;t=Math.atan2(h-i.x,y-i.y)+Math.PI,p="Q "+h+" "+y+" "+i.x+" "+i.y}else t=Math.atan2(r.x-i.x,r.y-i.y)+Math.PI,p="L "+i.x+" "+i.y;var v=l.split($s),d=a&&a.x||0,m=a&&a.y||0;return o.a.createElement("g",{className:"graph-edge-container"},"//Draw lines",o.a.createElement("path",{className:"graph-edge",id:"edge:"+n.getGraphElementID(),d:"M "+r.x+" "+r.y+" "+p+" M "+(i.x-s.a.ARROW_WIDTH*Math.sin(t-e))+" "+(i.y-s.a.ARROW_WIDTH*Math.cos(t-e))+" L "+i.x+" "+i.y+" L "+(i.x-s.a.ARROW_WIDTH*Math.sin(t+e))+" "+(i.y-s.a.ARROW_WIDTH*Math.cos(t+e)),fill:"none",stroke:"#000000"}),o.a.createElement("g",{transform:"translate("+d+","+m+") rotate("+180*c/Math.PI+")"},v.length>0&&v.map(function(e,t){var n=-15*(t+1);return o.a.createElement("text",{key:e+"."+t,className:"graph-edge-label",transform:"translate(0, "+n+")"+(f?" scale(-1, -1)":""),alignmentBaseline:"central",pointerEvents:"none",style:{userSelect:"none"},textAnchor:"middle"},e)})))}}])&&Ws(n.prototype,r),i&&Ws(n,i),t}();function tc(e){return(tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rc(e,t){return!t||"object"!==tc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oc(e){return(oc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ic(e,t){return(ic=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ac=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),rc(this,oc(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ic(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.node,t=e.x+(e instanceof li?0:-s.a.INITIAL_MARKER_OFFSET_X),n=e.y,r=s.a.NODE_RADIUS,i=2*r;return o.a.createElement("g",{className:"graph-initial-container"},o.a.createElement("path",{className:"graph-initial",d:"M"+(t-r)+" "+n+" L"+(t-i)+" "+(n-r)+" L"+(t-i)+" "+(n+r)+" Z",fill:"none",stroke:"#000000"}))}}])&&nc(n.prototype,r),i&&nc(n,i),t}();function lc(e){return(lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sc(e,t){return!t||"object"!==lc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cc(e){return(cc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fc(e,t){return(fc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pc=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),sc(this,cc(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fc(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.graph,t=this.props.inputController;return o.a.createElement("g",null,e.nodes.map(function(e,t){return o.a.createElement(Qs,{key:e.getGraphElementID()||t,node:e})}),e.edges.map(function(e,t){return o.a.createElement(ec,{key:e.getGraphElementID()||t,edge:e})}),e.getStartNode()&&(null==t.ghostInitialMarker?o.a.createElement(ac,{node:e.getStartNode()}):o.a.createElement(ac,{node:t.ghostInitialMarker})))}}])&&uc(n.prototype,r),i&&uc(n,i),t}();function hc(e){return(hc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vc(e,t){return!t||"object"!==hc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dc(e){return(dc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mc(e,t){return(mc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bc=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),vc(this,dc(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mc(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.visible,t=this.props.fromX||0,n=this.props.fromY||0,r=this.props.toX||t+1,i=this.props.toY||n+1,a=r-t,l=i-n;return o.a.createElement("g",{className:"graph-selection-container"},e&&o.a.createElement("rect",{className:"graph-selection",x:a<0?r:t,y:l<0?i:n,width:a<0?-a:a,height:l<0?-l:l}))}}])&&yc(n.prototype,r),i&&yc(n,i),t}();function gc(e){return(gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ec(e,t){return!t||"object"!==gc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sc(e){return(Sc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _c(e,t){return(_c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Oc=[8,6],kc=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ec(this,Sc(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_c(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.target,t=this.props.type,n=0,r=0,i=s.a.CURSOR_RADIUS;switch(t){case"node":n=e.x||0,r=e.y||0,i=s.a.NODE_RADIUS;break;case"edge":var a=e.getCenterPoint();n=a.x||0,r=a.y||0,i=s.a.EDGE_RADIUS;break;case"endpoint":var l=e.getEndPoint();n=l.x||0,r=l.y||0,i=s.a.ENDPOINT_RADIUS;break;case"initial":n=e.x+s.a.INITIAL_MARKER_OFFSET_X||0,r=e.y||0,i=s.a.EDGE_RADIUS}return o.a.createElement("g",{className:"graph-highlight-container"},o.a.createElement("circle",{className:"graph-highlight "+this.props.className,cx:n,cy:r,r:i+4,strokeDashoffset:this.props.offset||0,strokeDasharray:Oc,strokeWidth:3,fill:"none"}))}}])&&wc(n.prototype,r),i&&wc(n,i),t}();function Cc(e){return(Cc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nc(e,t){return!t||"object"!==Cc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pc(e){return(Pc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jc(e,t){return(jc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Tc=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Nc(this,Pc(t).call(this,e))).ref=o.a.createRef(),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jc(e,t)}(t,o.a.Component),n=t,(r=[{key:"getSVGForExport",value:function(e,t){var n=this.ref,r=this.props.inputController.getViewport(),o=r.getOffsetX(),i=r.getOffsetY(),a=this.props.graphController.getGraph().getBoundingRect(),l=a.minX+o-30,u=a.minY+i-0,s=a.width+60,c=a.height+0,f=n.cloneNode(!0);f.setAttribute("viewBox",l+" "+u+" "+s+" "+c),f.setAttribute("width",e),f.setAttribute("height",t),f.setAttribute("font-size","16px"),f.setAttribute("font-family","monospace");var p=f.getElementsByClassName("graph-ui"),h=!0,y=!1,v=void 0;try{for(var d,m=p[Symbol.iterator]();!(h=(d=m.next()).done);h=!0){d.value.remove()}}catch(e){y=!0,v=e}finally{try{h||null==m.return||m.return()}finally{if(y)throw v}}return f}},{key:"render",value:function(){var e=this,t=this.props.graphController,n=this.props.inputController,r=this.props.machineController,i=this.props.tester,a=t.getGraph(),l=n.getViewport(),u=(r.getMachineBuilder(),n.getPicker()),c=u.getSelectionBox(),f=s.a.DEFAULT_GRAPH_SIZE*Math.max(Number.MIN_VALUE,l.getScale()),p=f/2;return o.a.createElement("svg",{id:"workspace-content",ref:function(t){return e.ref=t},viewBox:0-p+" "+(0-p)+" "+f+" "+f,xmlns:"http://www.w3.org/2000/svg"},o.a.createElement(Us,{visible:a.isEmpty()}),o.a.createElement("g",{id:"workspace-content-elements",transform:"translate("+l.getOffsetX()+" "+l.getOffsetY()+")"},o.a.createElement("line",{className:"graph-ui",x1:"0",y1:"-5",x2:"0",y2:"5",stroke:"rgba(0,0,0,0.04)"}),o.a.createElement("line",{className:"graph-ui",x1:"-5",y1:"0",x2:"5",y2:"0",stroke:"rgba(0,0,0,0.04)"}),o.a.createElement(pc,{graph:a,inputController:n}),o.a.createElement("g",null,u.hasSelection()&&u.getSelection(a).map(function(e,t){return o.a.createElement(kc,{key:e.getGraphElementID(),className:n.isTrashMode()?"highlight-error":"highlight-select",target:e,type:"node"})}),o.a.createElement(bc,{visible:c.visible,fromX:c.fromX,fromY:c.fromY,toX:c.toX,toY:c.toY}),r.getMachineBuilder().machineErrorChecker.warningNodes.map(function(e,t){return o.a.createElement(kc,{key:e.getGraphElementID(),className:"highlight-warning graph-gui",target:e,type:"node",offset:"6"})}),r.getMachineBuilder().machineErrorChecker.warningEdges.map(function(e,t){return o.a.createElement(kc,{key:e.getGraphElementID(),className:"highlight-warning graph-gui",target:e,type:"edge",offset:"6"})}),r.getMachineBuilder().machineErrorChecker.errorNodes.map(function(e,t){return o.a.createElement(kc,{key:e.getGraphElementID(),className:"highlight-error graph-gui",target:e,type:"node",offset:"6"})}),r.getMachineBuilder().machineErrorChecker.errorEdges.map(function(e,t){return o.a.createElement(kc,{key:e.getGraphElementID(),className:"highlight-error graph-gui",target:e,type:"edge",offset:"6"})}),i.testMode.targets.map(function(e,t){return o.a.createElement(kc,{key:e.getGraphElementID(),className:"highlight-test graph-gui",target:e,type:"node",offset:"6"})}),u.hasTarget()&&!u.isTargetInSelection()&&o.a.createElement(kc,{className:n.isTrashMode()?"highlight-error":"highlight-select",target:u.target,type:u.targetType}))))}}])&&xc(n.prototype,r),i&&xc(n,i),t}();function Mc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Dc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.app=null}var t,n,r;return t=e,(n=[{key:"start",value:function(e){ul.existsInStorage("graph")||(_o.addMessage(I18N.toString("message.tutorial.1")),_o.addMessage(I18N.toString("message.intro.2")))}}])&&Mc(t.prototype,n),r&&Mc(t,r),e}();n(82),n(84);function Ic(e){return(Ic="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ac(e){return(Ac=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rc(e,t){return(Rc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Fc=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=Ac(t).call(this,e))||"object"!==Ic(o)&&"function"!=typeof o?Bc(r):o).onExitMessage=n.onExitMessage.bind(Bc(Bc(n))),n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rc(e,t)}(t,o.a.Component),n=t,(r=[{key:"onExitMessage",value:function(e){this.props.value.close()}},{key:"render",value:function(){var e=this.props.value;return o.a.createElement("div",{className:"notification-message-container notification-message-type-"+e.getType()+" "+this.props.className,id:this.props.id,style:this.props.style},this.props.children||e.value.split("\\n").map(function(e){return o.a.createElement("p",{key:e},e)})||e,o.a.createElement("button",{onClick:this.onExitMessage},I18N.toString("message.action.close")))}}])&&Lc(n.prototype,r),i&&Lc(n,i),t}();function Gc(e){return(Gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uc(){return(Uc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function zc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vc(e,t){return!t||"object"!==Gc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hc(e){return(Hc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xc(e,t){return(Xc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yc=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Vc(this,Hc(t).call(this,e))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xc(e,t)}(t,o.a.Component),n=t,(r=[{key:"render",value:function(){var e=this.props.notificationManager;return o.a.createElement("div",{className:"notification-container "+this.props.className,id:this.props.id,style:this.props.style},e.getMessages().map(function(e){var t=e.getID(),n=e.getComponentClass(),r=e.getComponentProps()||{};return o.a.createElement(Fc,{key:t,value:e},n&&o.a.createElement(n,Uc({message:e},r)))}))}}])&&zc(n.prototype,r),i&&zc(n,i),t}();function Qc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Kc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.history=[],this.offsetIndex=0}var t,n,r;return t=e,(n=[{key:"handleEvent",value:function(e){for(;this.offsetIndex>0;)this.history.pop(),--this.offsetIndex;for(this.history.push(e);this.history.length>1e3;)this.history.unshift()}},{key:"clear",value:function(){this.history.length=0,this.offsetIndex=0}},{key:"undo",value:function(){if(this.canUndo()){var e=this.history[this.history.length-this.offsetIndex-1];++this.offsetIndex,e.applyUndo()}}},{key:"redo",value:function(){this.canRedo()&&(--this.offsetIndex,this.history[this.history.length-this.offsetIndex-1].applyRedo())}},{key:"canUndo",value:function(){return this.offsetIndex<this.history.length}},{key:"canRedo",value:function(){return this.offsetIndex>0}}])&&Qc(t.prototype,n),r&&Qc(t,r),e}();function Wc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Jc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"applyUndo",value:function(){}},{key:"applyRedo",value:function(){}}])&&Wc(t.prototype,n),r&&Wc(t,r),e}();function qc(e){return(qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $c(e,t){return!t||"object"!==qc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ef(e){return(ef=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tf(e,t){return(tf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nf=function(e){function t(e,n,r,o,i){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=$c(this,ef(t).call(this))).graph=e,a.edge=n,a.nextDestination=r,a.prevDestination=o;var l=n.getQuadratic();return a.nextQuad={radians:l.radians,length:l.length},a.prevQuad=Object.assign({},i),a}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tf(e,t)}(t,Jc),n=t,(r=[{key:"applyUndo",value:function(){var e=this.prevQuad.radians,t=this.prevQuad.length;this.edge.changeDestinationNode(this.prevDestination),this.edge.isSelfLoop()&&(e=-e),this.edge.setQuadratic(e,t)}},{key:"applyRedo",value:function(){var e=this.nextQuad.radians,t=this.nextQuad.length;this.edge.changeDestinationNode(this.nextDestination),this.edge.setQuadratic(e,t)}}])&&Zc(n.prototype,r),o&&Zc(n,o),t}();function rf(e){return(rf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function of(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function af(e,t){return!t||"object"!==rf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lf(e){return(lf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uf(e,t){return(uf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sf=function(e){function t(e,n,r,o){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=af(this,lf(t).call(this))).graph=e,i.edge=n,i.edgeID=n.getGraphElementID(),i.nextLabel=r,i.prevLabel=o,i}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uf(e,t)}(t,Jc),n=t,(r=[{key:"applyUndo",value:function(){var e=this.graph,t=e.getEdgeIndexByID(this.edgeID);if(t<0)throw new Error("Unable to find target in graph");e.edges[t].setEdgeLabel(this.prevLabel),e.markDirty()}},{key:"applyRedo",value:function(){var e=this.graph,t=e.getEdgeIndexByID(this.edgeID);if(t<0)throw new Error("Unable to find target in graph");e.edges[t].setEdgeLabel(this.nextLabel),e.markDirty()}}])&&of(n.prototype,r),o&&of(n,o),t}();function cf(e){return(cf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ff(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pf(e,t){return!t||"object"!==cf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hf(e){return(hf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yf(e,t){return(yf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vf=function(e){function t(e,n,r,o){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=pf(this,hf(t).call(this))).graph=e,i.edge=n,i.nextQuad=Object.assign({},r),i.prevQuad=Object.assign({},o),i}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yf(e,t)}(t,Jc),n=t,(r=[{key:"applyUndo",value:function(){this.edge.setQuadratic(this.prevQuad.radians,this.prevQuad.length)}},{key:"applyRedo",value:function(){this.edge.setQuadratic(this.nextQuad.radians,this.nextQuad.length)}}])&&ff(n.prototype,r),o&&ff(n,o),t}();function df(e){return(df="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bf(e,t){return!t||"object"!==df(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gf(e){return(gf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wf(e,t){return(wf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ef=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=bf(this,gf(t).call(this))).graph=e,o.nodeID=n.getGraphElementID(),o.prevID=r.getGraphElementID(),o}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wf(e,t)}(t,Jc),n=t,(r=[{key:"applyUndo",value:function(){var e=this.graph,t=e.getNodeIndexByID(this.prevID);if(t<0)throw new Error("Unable to find target in graph");var n=e.nodes[t];this.graph.setStartNode(n)}},{key:"applyRedo",value:function(){var e=this.graph,t=e.getNodeIndexByID(this.nodeID);if(t<0)throw new Error("Unable to find target in graph");var n=e.nodes[t];this.graph.setStartNode(n)}}])&&mf(n.prototype,r),o&&mf(n,o),t}();function Sf(e){return(Sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Of(e,t){return!t||"object"!==Sf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kf(e){return(kf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cf(e,t){return(Cf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xf=function(e){function t(e,n,r,o,i,a){var l;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(l=Of(this,kf(t).call(this))).graph=e,l.nodeID=n.getGraphElementID(),l.nextX=r,l.nextY=o,l.prevX=i,l.prevY=a,l}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cf(e,t)}(t,Jc),n=t,(r=[{key:"applyUndo",value:function(){var e=this.graph,t=e.getNodeIndexByID(this.nodeID);if(t<0)throw new Error("Unable to find target in graph");var n=e.nodes[t];n.x=this.prevX,n.y=this.prevY}},{key:"applyRedo",value:function(){var e=this.graph,t=e.getNodeIndexByID(this.nodeID);if(t<0)throw new Error("Unable to find target in graph");var n=e.nodes[t];n.x=this.nextX,n.y=this.nextY}}])&&_f(n.prototype,r),o&&_f(n,o),t}();function Nf(e){return(Nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jf(e,t){return!t||"object"!==Nf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tf(e){return(Tf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mf(e,t){return(Mf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Df=function(e){function t(e,n,r,o){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=jf(this,Tf(t).call(this))).graph=e,i.nodeIDs=[];var a=!0,l=!1,u=void 0;try{for(var s,c=n[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var f=s.value;i.nodeIDs.push(f.getGraphElementID())}}catch(e){l=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(l)throw u}}return i.dx=r,i.dy=o,i}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mf(e,t)}(t,Jc),n=t,(r=[{key:"applyUndo",value:function(){var e=this.graph,t=-1,n=null,r=!0,o=!1,i=void 0;try{for(var a,l=this.nodeIDs[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;if((t=e.getNodeIndexByID(u))<0)throw new Error("Unable to find target in graph");(n=e.nodes[t]).x-=this.dx,n.y-=this.dy}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}}},{key:"applyRedo",value:function(){var e=this.graph,t=-1,n=null,r=!0,o=!1,i=void 0;try{for(var a,l=this.nodeIDs[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var u=a.value;if((t=e.getNodeIndexByID(u))<0)throw new Error("Unable to find target in graph");(n=e.nodes[t]).x+=this.dx,n.y+=this.dy}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}}}])&&Pf(n.prototype,r),o&&Pf(n,o),t}();function If(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Lf=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventLogger=t,this.controller=n,this.eventName=r,this.postEventName=o||null,this.onEvent=this.onEvent.bind(this),this.controller.on(this.eventName,this.onEvent)}var t,n,r;return t=e,(n=[{key:"destroy",value:function(){this.controller.removeEventListener(this.eventName,this.onEvent)}},{key:"onEvent",value:function(){var e=this,t={};t.applyUndo=this.applyUndo.bind(this,t),t.applyRedo=this.applyRedo.bind(this,t),t.eventData=this.captureEvent.apply(this,arguments),this.postEventName?this.controller.once(this.postEventName,function(){t.postData=e.capturePostEvent.apply(e,arguments),e.eventLogger.handleEvent(t)}):(t.postData=t.eventData,this.eventLogger.handleEvent(t))}},{key:"captureEvent",value:function(){return{}}},{key:"capturePostEvent",value:function(){return{}}},{key:"applyUndo",value:function(e){}},{key:"applyRedo",value:function(e){}}])&&If(t.prototype,n),r&&If(t,r),e}();function Af(e){return(Af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bf(e,t){return!t||"object"!==Af(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ff(e){return(Ff=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gf(e,t){return(Gf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Uf=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Bf(this,Ff(t).call(this,e,n,"userPostCreateNode"))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gf(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e,t){return{node:t,nodeID:t.getGraphElementID(),x:t.x,y:t.y,label:t.getNodeLabel(),isCustom:t.hasCustomLabel()}}},{key:"applyUndo",value:function(e){var t=this.controller.getGraph(),n=t.getNodeIndexByID(e.eventData.nodeID);if(n<0)throw new Error("Unable to find target in graph");t.nodes.splice(n,1),t.markDirty()}},{key:"applyRedo",value:function(e){var t=this.controller.getGraph();if(t.getNodeIndexByID(e.postData.nodeID)<0){var n=e.postData.node;t.nodes.push(n),n.x=e.postData.x,n.y=e.postData.y,n.setNodeID(e.postData.nodeID),e.postData.isCustom?n.setCustomLabel(e.postData.label):n.setNodeLabel(e.postData.label)}t.markDirty()}}])&&Rf(n.prototype,r),o&&Rf(n,o),t}();function zf(e){return(zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hf(e,t){return!t||"object"!==zf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xf(e){return(Xf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yf(e,t){return(Yf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qf=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Hf(this,Xf(t).call(this,e,n,"userToggleNode"))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yf(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e,t,n){return{nodeID:t.getGraphElementID(),prevAccept:n}}},{key:"applyUndo",value:function(e){var t=this.controller.getGraph(),n=t.getNodeIndexByID(e.eventData.nodeID);if(n<0)throw new Error("Unable to find target in graph");t.nodes[n].accept=e.eventData.prevAccept}},{key:"applyRedo",value:function(e){var t=this.controller.getGraph(),n=t.getNodeIndexByID(e.eventData.nodeID);if(n<0)throw new Error("Unable to find target in graph");t.nodes[n].accept=!e.eventData.prevAccept}}])&&Vf(n.prototype,r),o&&Vf(n,o),t}();function Kf(e){return(Kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jf(e,t){return!t||"object"!==Kf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qf(e){return(qf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zf(e,t){return(Zf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $f=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Jf(this,qf(t).call(this,e,n,"userPreDeleteNodes","userPostDeleteNodes"))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zf(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e,t,n,r,o){var i=[],a=!0,l=!1,u=void 0;try{for(var s,c=n[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var f=s.value;i.push(f.getGraphElementID())}}catch(e){l=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(l)throw u}}var p=t.x-r,h=t.y-o;return{graphData:Da.toJSON(e),targets:i,dx:p,dy:h}}},{key:"capturePostEvent",value:function(e,t,n,r,o){return{graphData:Da.toJSON(e)}}},{key:"applyUndo",value:function(e){var t=this.controller.getGraph();Da.parseJSON(e.eventData.graphData,this.controller.getGraph());var n=!0,r=!1,o=void 0;try{for(var i,a=e.eventData.targets[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value,u=t.getNodeIndexByID(l);if(u<0)throw new Error("Unable to find target in graph");t.nodes[u].x-=e.eventData.dx,t.nodes[u].y-=e.eventData.dy}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"applyRedo",value:function(e){Da.parseJSON(e.postData.graphData,this.controller.getGraph())}}])&&Wf(n.prototype,r),o&&Wf(n,o),t}();function ep(e){return(ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function np(e,t){return!t||"object"!==ep(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rp(e){return(rp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function op(e,t){return(op=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ip=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),np(this,rp(t).call(this,e,n,"userSwapNodes"))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&op(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e,t,n){return{nodeID:t.getGraphElementID(),otherID:n.getGraphElementID()}}},{key:"applyUndo",value:function(e){var t=this.controller.getGraph(),n=t.getNodeIndexByID(e.eventData.nodeID);if(n<0)throw new Error("Unable to find target in graph");var r=t.getNodeIndexByID(e.eventData.otherID);if(r<0)throw new Error("Unable to find other target in graph");var o=t.nodes[n];t.nodes[n]=t.nodes[r],t.nodes[r]=o,t.markDirty()}},{key:"applyRedo",value:function(e){var t=this.controller.getGraph(),n=t.getNodeIndexByID(e.eventData.nodeID);if(n<0)throw new Error("Unable to find target in graph");var r=t.getNodeIndexByID(e.eventData.otherID);if(r<0)throw new Error("Unable to find other target in graph");var o=t.nodes[n];t.nodes[n]=t.nodes[r],t.nodes[r]=o,t.markDirty()}}])&&tp(n.prototype,r),o&&tp(n,o),t}();function ap(e){return(ap="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function up(e,t){return!t||"object"!==ap(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sp(e){return(sp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cp(e,t){return(cp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fp=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),up(this,sp(t).call(this,e,n,"userRenameNode"))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cp(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e,t,n,r,o){return{node:t,nodeID:t.getGraphElementID(),nextLabel:n,prevLabel:r,prevCustom:o}}},{key:"applyUndo",value:function(e){var t=this.controller.getGraph(),n=t.getNodeIndexByID(e.eventData.nodeID);if(n<0)throw new Error("Unable to find target in graph");var r=t.nodes[n];e.eventData.prevCustom?r.setCustomLabel(e.eventData.prevLabel):r.setNodeLabel(e.eventData.prevLabel)}},{key:"applyRedo",value:function(e){var t=this.controller.getGraph(),n=t.getNodeIndexByID(e.eventData.nodeID);if(n<0)throw new Error("Unable to find target in graph");t.nodes[n].setCustomLabel(e.eventData.nextLabel)}}])&&lp(n.prototype,r),o&&lp(n,o),t}();function pp(e){return(pp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yp(e,t){return!t||"object"!==pp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vp(e){return(vp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dp(e,t){return(dp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mp=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yp(this,vp(t).call(this,e,n,"userPostCreateEdge"))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dp(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e,t){var n=t.getQuadratic();return{edge:t,edgeID:t.getGraphElementID(),fromID:t.getSourceNode().getGraphElementID(),toID:t.getDestinationNode()?t.getDestinationNode().getGraphElementID():null,label:t.getEdgeLabel(),quad:{radians:n.radians,length:n.length}}}},{key:"applyUndo",value:function(e){var t=this.controller.getGraph(),n=t.getEdgeIndexByID(e.eventData.edgeID);if(n<0)throw new Error("Unable to find target in graph");t.edges.splice(n,1),t.markDirty()}},{key:"applyRedo",value:function(e){var t=this.controller.getGraph();if(t.getEdgeIndexByID(e.postData.edgeID)<0){var n=e.postData.edge;t.edges.push(n);var r=t.getNodeIndexByID(e.postData.fromID);if(!(r>=0))throw new Error("Trying to create a sourceless edge");n.setSourceNode(t.nodes[r]);var o=t.getNodeIndexByID(e.postData.toID);o>=0?n.setDestinationNode(t.nodes[o]):n.setDestinationNode(null),n.setEdgeLabel(e.postData.label),n.setQuadratic(e.postData.quad.radians,e.postData.quad.length)}t.markDirty()}}])&&hp(n.prototype,r),o&&hp(n,o),t}();function bp(e){return(bp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wp(e,t){return!t||"object"!==bp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ep(e){return(Ep=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sp(e,t){return(Sp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _p=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),wp(this,Ep(t).call(this,e,n,"userPreDeleteEdge"))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sp(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e,t,n,r){return{edge:t,edgeID:t.getGraphElementID(),fromID:t.getSourceNode().getGraphElementID(),toID:n?n.getGraphElementID():null,quad:Object.assign({},r)}}},{key:"applyUndo",value:function(e){var t=this.controller.getGraph();if(t.getEdgeIndexByID(e.eventData.edgeID)<0){var n=e.eventData.edge;t.edges.push(n);var r=t.getNodeIndexByID(e.eventData.fromID);if(!(r>=0))throw new Error("Trying to create a sourceless edge");n.setSourceNode(t.nodes[r]);var o=t.getNodeIndexByID(e.eventData.toID);o>=0?n.changeDestinationNode(t.nodes[o]):n.changeDestinationNode(null),n.setQuadratic(e.eventData.quad.radians,e.eventData.quad.length)}t.markDirty()}},{key:"applyRedo",value:function(e){var t=this.controller.getGraph(),n=t.getEdgeIndexByID(e.postData.edgeID);if(n<0)throw new Error("Unable to find target in graph");t.edges.splice(n,1),t.markDirty()}}])&&gp(n.prototype,r),o&&gp(n,o),t}();function Op(e){return(Op="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cp(e,t){return!t||"object"!==Op(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xp(e){return(xp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Np(e,t){return(Np=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pp=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Cp(this,xp(t).call(this,e,n,"userPreImportGraph","userPostImportGraph"))).machineController=r,o}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Np(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e){return{graphName:this.machineController.getMachineName(),graphData:Da.toJSON(e)}}},{key:"capturePostEvent",value:function(e){return{graphName:this.machineController.getMachineName(),graphData:Da.toJSON(e)}}},{key:"applyUndo",value:function(e){Da.parseJSON(e.eventData.graphData,this.controller.getGraph()),this.machineController.setMachineName(e.eventData.graphName)}},{key:"applyRedo",value:function(e){Da.parseJSON(e.postData.graphData,this.controller.getGraph()),this.machineController.setMachineName(e.postData.graphName)}}])&&kp(n.prototype,r),o&&kp(n,o),t}();function jp(e){return(jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mp(e,t){return!t||"object"!==jp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dp(e){return(Dp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ip(e,t){return(Ip=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Lp=function(e){function t(e,n,r,o){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Mp(this,Dp(t).call(this,e,n,r,o))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ip(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e){return{graphData:Da.toJSON(e)}}},{key:"capturePostEvent",value:function(e){return{graphData:Da.toJSON(e)}}},{key:"applyUndo",value:function(e){Da.parseJSON(e.eventData.graphData,this.controller.getGraph())}},{key:"applyRedo",value:function(e){Da.parseJSON(e.postData.graphData,this.controller.getGraph())}}])&&Tp(n.prototype,r),o&&Tp(n,o),t}();function Ap(e){return(Ap="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bp(e,t){return!t||"object"!==Ap(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fp(e){return(Fp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gp(e,t){return(Gp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Up=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Bp(this,Fp(t).call(this,e,n,"userChangeMachine"))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gp(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e,t,n){return{prevType:n,nextType:t}}},{key:"applyUndo",value:function(e){this.controller.setMachineType(e.eventData.prevType)}},{key:"applyRedo",value:function(e){this.controller.setMachineType(e.postData.nextType)}}])&&Rp(n.prototype,r),o&&Rp(n,o),t}();function zp(e){return(zp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hp(e,t){return!t||"object"!==zp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xp(e){return(Xp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yp(e,t){return(Yp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qp=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Hp(this,Xp(t).call(this,e,n,"userPreConvertMachine","userPostConvertMachine"))).graphController=r,o}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yp(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e,t,n){var r=this.graphController.getGraph();return{graphData:Da.toJSON(r),prevType:n}}},{key:"capturePostEvent",value:function(e,t,n){var r=this.graphController.getGraph();return{graphData:Da.toJSON(r),nextType:t}}},{key:"applyUndo",value:function(e){Da.parseJSON(e.eventData.graphData,this.graphController.getGraph()),this.controller.setMachineType(e.eventData.prevType)}},{key:"applyRedo",value:function(e){Da.parseJSON(e.postData.graphData,this.graphController.getGraph()),this.controller.setMachineType(e.postData.nextType)}}])&&Vp(n.prototype,r),o&&Vp(n,o),t}();function Kp(e){return(Kp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jp(e,t){return!t||"object"!==Kp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qp(e){return(qp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zp(e,t){return(Zp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $p=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Jp(this,qp(t).call(this,e,n,"userRenameMachine"))}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zp(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e,t,n){return{prevName:n,nextName:t}}},{key:"applyUndo",value:function(e){this.controller.setMachineName(e.eventData.prevName)}},{key:"applyRedo",value:function(e){this.controller.setMachineName(e.postData.nextName)}}])&&Wp(n.prototype,r),o&&Wp(n,o),t}();function eh(e){return(eh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function th(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nh(e,t){return!t||"object"!==eh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rh(e){return(rh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oh(e,t){return(oh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ih=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=nh(this,rh(t).call(this,e,n,"userPreRenameSymbol","userPostRenameSymbol"))).graphController=r,o}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oh(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e,t,n){var r=this.graphController.getGraph();return{graphData:Da.toJSON(r),symbol:t,prevSymbol:n}}},{key:"capturePostEvent",value:function(e,t,n,r){var o=this.graphController.getGraph(),i=[],a=!0,l=!1,u=void 0;try{for(var s,c=r[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var f=s.value;i.push(f.getGraphElementID())}}catch(e){l=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(l)throw u}}return{graphData:Da.toJSON(o),symbol:t,prevSymbol:n,targets:i}}},{key:"applyUndo",value:function(e){Da.parseJSON(e.eventData.graphData,this.graphController.getGraph())}},{key:"applyRedo",value:function(e){Da.parseJSON(e.postData.graphData,this.graphController.getGraph())}}])&&th(n.prototype,r),o&&th(n,o),t}();function ah(e){return(ah="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uh(e,t){return!t||"object"!==ah(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sh(e){return(sh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ch(e,t){return(ch=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fh=function(e){function t(e,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=uh(this,sh(t).call(this,e,n,"userPreDeleteSymbol","userPostDeleteSymbol"))).graphController=r,o}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ch(e,t)}(t,Lf),n=t,(r=[{key:"captureEvent",value:function(e,t){var n=this.graphController.getGraph();return{graphData:Da.toJSON(n),symbol:t}}},{key:"capturePostEvent",value:function(e,t,n){var r=this.graphController.getGraph(),o=[],i=!0,a=!1,l=void 0;try{for(var u,s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;o.push(c.getGraphElementID())}}catch(e){a=!0,l=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw l}}return{graphData:Da.toJSON(r),symbol:t,targets:o}}},{key:"applyUndo",value:function(e){Da.parseJSON(e.eventData.graphData,this.graphController.getGraph())}},{key:"applyRedo",value:function(e){Da.parseJSON(e.postData.graphData,this.graphController.getGraph())}}])&&lh(n.prototype,r),o&&lh(n,o),t}();function ph(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var hh=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.graphController=null,this.machineController=null,this.eventHandlers=[],this.logger=new Kc}var t,n,r;return t=e,(n=[{key:"initialize",value:function(e){this.graphController=e.graphController,this.machineController=e.machineController;var t=this.graphController.getGraph(),n=this.logger;this.graphController.on("nodeMove",function(e,r,o,i,a){return n.handleEvent(new xf(t,e,r,o,i,a))}),this.graphController.on("nodeMoveAll",function(e,r,o){return n.handleEvent(new Df(t,e,r,o))}),this.graphController.on("nodeInitial",function(e,r){return n.handleEvent(new Ef(t,e,r))}),this.graphController.on("edgeDestination",function(e,r,o,i){return n.handleEvent(new nf(t,e,r,o,i))}),this.graphController.on("edgeMove",function(e,r,o,i,a){return n.handleEvent(new vf(t,e,r,o,i,a))}),this.graphController.on("edgeLabel",function(e,r,o){return n.handleEvent(new sf(t,e,r,o))}),this.eventHandlers.push(new Uf(n,this.graphController)),this.eventHandlers.push(new fp(n,this.graphController)),this.eventHandlers.push(new ip(n,this.graphController)),this.eventHandlers.push(new Qf(n,this.graphController)),this.eventHandlers.push(new $f(n,this.graphController)),this.eventHandlers.push(new mp(n,this.graphController)),this.eventHandlers.push(new _p(n,this.graphController)),this.eventHandlers.push(new Pp(n,this.graphController,this.machineController)),this.eventHandlers.push(new Lp(n,this.graphController,"userPreChangeLayout","userPostChangeLayout")),this.eventHandlers.push(new Up(n,this.machineController)),this.eventHandlers.push(new Qp(n,this.machineController,this.graphController)),this.eventHandlers.push(new $p(n,this.machineController)),this.eventHandlers.push(new ih(n,this.machineController,this.graphController)),this.eventHandlers.push(new fh(n,this.machineController,this.graphController))}},{key:"destroy",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.eventHandlers[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.destroy()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}this.graphController.clearEventListeners()}},{key:"getLogger",value:function(){return this.logger}}])&&ph(t.prototype,n),r&&ph(t,r),e}();function yh(e){return(yh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dh(e){return(dh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mh(e,t){return(mh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var gh=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,(n=!(o=dh(t).call(this,e))||"object"!==yh(o)&&"function"!=typeof o?bh(r):o).container=null,n.workspace=null,n.viewport=null,n.drawer=null,n.toolbar=null,n._module=new Oa,n.testingManager=new Yn,n.inputController=new rl,n.graphController=new Qa,n.machineController=new ja,n.inputController.setModule(n._module),n.graphController.setModule(n._module),n.machineController.setModule(n._module),n.eventManager=new hh,n.hotKeys=new il,n.tutorial=new Dc,n.state={isOpen:!0,isDangerous:!1,isFullscreen:!1,isWaitingForFile:!1},n.onDragOver=n.onDragOver.bind(bh(bh(n))),n.onDragEnter=n.onDragEnter.bind(bh(bh(n))),n.onDragLeave=n.onDragLeave.bind(bh(bh(n))),n.onFileDrop=n.onFileDrop.bind(bh(bh(n))),n._init=!1,n}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mh(e,t)}(t,o.a.Component),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;this._module.initialize(this),this.inputController.initialize(this),this.graphController.initialize(this),this.machineController.initialize(this);this.graphController.on("tryCreateWhileTrash",function(){e.inputController.isTrashMode()&&_o.addMessage(I18N.toString("message.warning.cannotmodify"),"warning","tryCreateWhileTrash")}),this.testingManager.initialize(this),this.eventManager.initialize(this),this.hotKeys.initialize(this);var t=this.workspace.ref;t.addEventListener("drop",this.onFileDrop),t.addEventListener("dragover",this.onDragOver),t.addEventListener("dragenter",this.onDragEnter),t.addEventListener("dragleave",this.onDragLeave),this.tutorial.start(this),ul.initialize(),ul.registerHandler(this),this.onLoadSave(),this._init=!0}},{key:"componentWillUnmount",value:function(){ul.unregisterHandler(this),ul.terminate(),this.hotKeys.destroy(),this.eventManager.destroy(),this.machineController.destroy(),this.graphController.destroy(),this.inputController.destroy(),this._module.destroy(this);var e=this.workspace.ref;e.removeEventListener("drop",this.onFileDrop),e.removeEventListener("dragover",this.onDragOver),e.removeEventListener("dragenter",this.onDragEnter),e.removeEventListener("dragleave",this.onDragLeave),this._init=!1}},{key:"onLoadSave",value:function(){var e=ul.loadFromStorage("graph");e&&Ga(e,this.graphController,this.machineController)}},{key:"onAutoSave",value:function(){var e=Fa(this.graphController,this.machineController);ul.saveToStorage("graph",e)}},{key:"onDragOver",value:function(e){e.preventDefault()}},{key:"onDragEnter",value:function(e){e.preventDefault(),this.setState({isWaitingForFile:!0}),this.viewport.setState(function(e,t){return{prevMode:e.mode,mode:Pn.DANGEROUS}})}},{key:"onDragLeave",value:function(e){e.preventDefault(),this.setState({isWaitingForFile:!1}),this.viewport.setState(function(e,t){return{prevMode:e.mode,mode:e.prevMode}})}},{key:"onFileDrop",value:function(e){if(e.preventDefault(),this.setState({isWaitingForFile:!1}),this.viewport.setState(function(e,t){return{prevMode:e.mode,mode:e.prevMode}}),e.dataTransfer.items){if(e.dataTransfer.items.length>=1){var t=e.dataTransfer.items[0];if("file"===t.kind){var n=t.getAsFile();this.graphController.getUploader().uploadFileGraph(n)}}}else if(e.dataTransfer.files.length>=1){var r=e.dataTransfer.files[0];this.graphController.getUploader().uploadFileGraph(r)}e.dataTransfer.items?e.dataTransfer.items.clear():e.dataTransfer.clearData()}},{key:"openDrawer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;"boolean"==typeof e?this.setState(function(t,n){return{isOpen:!0,isFullscreen:e}}):this.setState(function(e,t){return{isOpen:!0}})}},{key:"closeDrawer",value:function(){this.setState(function(e,t){return{isOpen:!1}})}},{key:"isDrawerOpen",value:function(){return this.state.isOpen}},{key:"shouldHideContent",value:function(){return this.state.isFullscreen&&this.state.isOpen}},{key:"getCurrentModule",value:function(){return this._module}},{key:"render",value:function(){var e=this,t=this.inputController,n=this.graphController,r=this.machineController,i=this.testingManager,a=this.workspace?this.workspace.ref:null;return this._init&&t.update(),o.a.createElement("div",{className:"app-container",ref:function(t){return e.container=t}},o.a.createElement(Ls,{ref:function(t){return e.toolbar=t},eventManager:this.eventManager,drawer:this.drawer,graphController:n,machineController:r}),o.a.createElement(Yc,{notificationManager:_o}),o.a.createElement("div",{className:"workspace-container"},o.a.createElement("div",{className:"workspace-main"+(this.state.isOpen?" open":""),style:{visibility:this.shouldHideContent()?"hidden":"visible",opacity:this.state.isWaitingForFile?"0.1":"1"}},o.a.createElement(Tc,{ref:function(t){return e.workspace=t},tester:i,graphController:n,inputController:t,machineController:r})),o.a.createElement("div",{className:"workspace-viewport"+(this.state.isOpen?" open":""),style:{visibility:this.shouldHideContent()?"hidden":"visible"}},o.a.createElement(Pn,{ref:function(t){return e.viewport=t},tester:i,screen:a,graphController:n,inputController:t,machineController:r})),o.a.createElement("div",{className:"workspace-drawer"+(this.state.isOpen?" open":"")+(this.state.isFullscreen?" fullscreen":"")},o.a.createElement(Ps,{ref:function(t){return e.drawer=t},app:this,toolbar:this.toolbar,graphController:n,machineController:r}))))}}])&&vh(n.prototype,r),i&&vh(n,i),t}();t.default=Object(i.hot)(gh)}}]);
//# sourceMappingURL=sourcemap/content.bundle.js.map